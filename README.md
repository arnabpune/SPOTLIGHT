# About
This folder contains the distributable of executable files for the SPOTLIGHT program. A template input file is given here `input_template.dnvin`

# Requirements
To run SPOTLIGHT, you require the following packages/libraries available
- GLIBC 2.32+ in libc.so.6 (find it by `locate libc.so` and search GLIBC versions with `strings /path/to/so/file|grep GLIBC`)
- OpenMPI 3.1+
- ZeroMQ libraries for C++ (and preferably python)
- libtorch for C++ (specific version, packaged with SPOTLIGHT - **Latest version will NOT work due to deprecated implementations having changes**)
  Add `libtorch/libs` to the LIBRARY\_PATH and LD\_LIBRARY\_PATH variables before running


# Running the programs
Each of the 3 executables here can be directly run from any LINUX/UNIX terminal. Please ensure that libzmq is installed and up-to-date, or that the library (given in the distributable zip file) is in the LIBRARY\_PATH<br/>
The input format varies for each executable. Sample commands to run these programs are given below:

- ./production\_noprotein\_RL *target\_size* *variance* *num\_mols* #The variance for the range of sizes. The target size is picked uniformly randomly from the range target\_size +/- variance
- ./production\_noRL input.dnvin
- ./production\_RL input.dnvin

The programs that require RL require the files `convsave.pt` and `decsave.pt` to be present in one folder behind the current directory (where the file is executed). 
These files are present in `spotlight_data/model`

## Preparing the protein
It is necessary to use a convention similar to the CHARMM27 forcefield protein atom naming in GROMACS.<br/>
If you have GROMACS 2018 or later installed, use the following command:<br/>
    `gmx pdb2gmx -f input_file -o output_file.gro -ff charmm27 -ignh`<br/>
It is necessary to manually remove any capping and the protonated amine (NH3+ atoms) from the N-terminal and acid (COO- atoms) from the C terminal for protein targets. Usually this should be fine as active sites are located far enough from terminal residues.<br/>
If this is not the case, consider manually adding parameters into the respective RTP files in `spotlight_data` manually, or change the terminal atom types to treat them like normal amino-acid atom types without charges (also to be done manually).
**Note:** `protein.gro` referred to anywhere (even in the input DNVin template) will refer to the GRO file for the target protein generated by this protocol.

## Preparing the input file
You may use the input\_template.dnvin file as a template. Many of the available options are explained below. Please leave other options unchanged.
- `Protein`: Path to the protein.gro file as prepared above
- `ProteinFormat`: Input format for protein file. Only "pdb" and "gro" are supported. Using pdb does *not* exempt the requirement of atom names being associated with the CHARMM27 forcefield parameters.
- `Residues`: A comma-separated list of residue numbers
- `RestrainDistance`: Maximum distance of a newly placed heavy atom from the selected residue atoms. Hydrogen atoms from the protein are still considered.
- `ProgramName`: Pick a name for the program. Most files generated by this program will start with or contain this phrase.
- `Sizes`: Range of heavy atom sizes to target. Each size will be processed one after the other. This value can be comma-separated (10,12,14) or a range (20-30)
- `Step`: Increment the target size by *step* each time. Useful for targetting a larger size range quickly (10-20 with step 2 gives 10,12,14,16,18,20)
- `MolCount`: Minimum number of accepted molecules for each size before termination.
- `Oscillations`: Final acceptence of molecules after these many oscillations in the Monte Carlo energy.
- `SeedCount`: Number of seed positions to start with. Usually better to use significantly large numbers (between 250-1000)
- `Strategy_Restrain`: Restrain the molecule? (Yes/No). Setting this to No will disable restraining the ligand growth and can cause trailing parts in the ligand that do not directly interact with the protein. It might still be useful to disable it for cases where the active site is too vague.
- `SourceFolder`: Path to the spotlight\_data folder provided here.
- `Optimize`: Perform a quick gradient descent optimization after each ligand is generated (Yes/No)
