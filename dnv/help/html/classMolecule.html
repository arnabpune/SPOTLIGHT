<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Denovo omega: Molecule Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Denovo omega<span id="projectnumber">&#160;0.0</span>
   </div>
   <div id="projectbrief">A de-novo optimum-binder molecule-design program.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classMolecule-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Molecule Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &quot;<a class="el" href="Molecule_8hpp_source.html">graph/Molecule.hpp</a>&quot;</code></p>
<div class="dynheader">
Inheritance diagram for Molecule:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classMolecule.png" usemap="#Molecule_map" alt=""/>
  <map id="Molecule_map" name="Molecule_map">
<area href="classMolecularFragment.html" alt="MolecularFragment" shape="rect" coords="0,56,156,80"/>
<area href="classProtein.html" alt="Protein" shape="rect" coords="166,56,322,80"/>
<area href="classspecific_1_1SolvatedProtein.html" alt="specific::SolvatedProtein" shape="rect" coords="166,112,322,136"/>
<area href="classspecific_1_1ProteinEnsemble.html" alt="specific::ProteinEnsemble" shape="rect" coords="166,168,322,192"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5744317e0c2c298f7e74873be2f46abc"><td class="memItemLeft" align="right" valign="top"><a id="a5744317e0c2c298f7e74873be2f46abc" name="a5744317e0c2c298f7e74873be2f46abc"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Molecule</b> (<a class="el" href="classAtom.html">Atom</a> *a)</td></tr>
<tr class="memdesc:a5744317e0c2c298f7e74873be2f46abc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a single atom (eg. when starting generation from single atom seed) <br /></td></tr>
<tr class="separator:a5744317e0c2c298f7e74873be2f46abc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa08b915718a7851b753c0cd9acb026f8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#aa08b915718a7851b753c0cd9acb026f8">Molecule</a> (std::vector&lt; <a class="el" href="classAtom.html">Atom</a> * &gt;)</td></tr>
<tr class="memdesc:aa08b915718a7851b753c0cd9acb026f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a molecule by just collecting atoms.  <a href="classMolecule.html#aa08b915718a7851b753c0cd9acb026f8">More...</a><br /></td></tr>
<tr class="separator:aa08b915718a7851b753c0cd9acb026f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5dd0fff02c29ca0e4209822857cf66f"><td class="memItemLeft" align="right" valign="top"><a id="ab5dd0fff02c29ca0e4209822857cf66f" name="ab5dd0fff02c29ca0e4209822857cf66f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Molecule</b> (std::vector&lt; <a class="el" href="classAtom.html">Atom</a> * &gt;, std::vector&lt; std::vector&lt; int &gt; &gt; b)</td></tr>
<tr class="memdesc:ab5dd0fff02c29ca0e4209822857cf66f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a molecule from a set of atoms and some connections. <br /></td></tr>
<tr class="separator:ab5dd0fff02c29ca0e4209822857cf66f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf1c3fa4a6d3c6d6c530ea0b620807c5"><td class="memItemLeft" align="right" valign="top"><a id="acf1c3fa4a6d3c6d6c530ea0b620807c5" name="acf1c3fa4a6d3c6d6c530ea0b620807c5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Molecule</b> (int n)</td></tr>
<tr class="memdesc:acf1c3fa4a6d3c6d6c530ea0b620807c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate space for 'n' atoms in this <a class="el" href="classMolecule.html">Molecule</a> object. <br /></td></tr>
<tr class="separator:acf1c3fa4a6d3c6d6c530ea0b620807c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21ee086bf224ec95f24aae555e94b5b9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a21ee086bf224ec95f24aae555e94b5b9">Molecule</a> (const <a class="el" href="classMolecule.html">Molecule</a> *o)</td></tr>
<tr class="memdesc:a21ee086bf224ec95f24aae555e94b5b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="classMolecule.html">Molecule</a> class copy constructor.  <a href="classMolecule.html#a21ee086bf224ec95f24aae555e94b5b9">More...</a><br /></td></tr>
<tr class="separator:a21ee086bf224ec95f24aae555e94b5b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a041d96213e53bd501f94b46cc36d74f6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a041d96213e53bd501f94b46cc36d74f6">Molecule</a> (std::istream &amp;f, bool eval=false, bool cpt=false, const <a class="el" href="classForceField.html">ForceField</a> *ff=nullptr)</td></tr>
<tr class="memdesc:a041d96213e53bd501f94b46cc36d74f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a molecule from TXT format (see algorithm PDF for details on TXT format)  <a href="classMolecule.html#a041d96213e53bd501f94b46cc36d74f6">More...</a><br /></td></tr>
<tr class="separator:a041d96213e53bd501f94b46cc36d74f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd5df1c615fa93e4c0ce80e6a9dcd900"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#abd5df1c615fa93e4c0ce80e6a9dcd900">Molecule</a> (const char *file, bool eval=false)</td></tr>
<tr class="memdesc:abd5df1c615fa93e4c0ce80e6a9dcd900"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a molecule from TXT format (see algorithm PDF for details on TXT format)  <a href="classMolecule.html#abd5df1c615fa93e4c0ce80e6a9dcd900">More...</a><br /></td></tr>
<tr class="separator:abd5df1c615fa93e4c0ce80e6a9dcd900"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a834ac3e93af40e0f03bf1bb83c1ccb3e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a834ac3e93af40e0f03bf1bb83c1ccb3e">Molecule</a> (const std::string &amp;infile, const <a class="el" href="classForceField.html">ForceField</a> &amp;ff, const std::string &amp;format=&quot;pdb&quot;, bool eval=false, bool warnf=false, char chain='A')</td></tr>
<tr class="memdesc:a834ac3e93af40e0f03bf1bb83c1ccb3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load <a class="el" href="classMolecule.html">Molecule</a> from a standard format (PDB or GRO)  <a href="classMolecule.html#a834ac3e93af40e0f03bf1bb83c1ccb3e">More...</a><br /></td></tr>
<tr class="separator:a834ac3e93af40e0f03bf1bb83c1ccb3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad35a661359739714f8b03295788e4dc4"><td class="memItemLeft" align="right" valign="top"><a id="ad35a661359739714f8b03295788e4dc4" name="ad35a661359739714f8b03295788e4dc4"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Molecule</b> (std::istream &amp;infile, const <a class="el" href="classForceField.html">ForceField</a> &amp;ff, const std::string &amp;format=&quot;pdb&quot;, bool eval=false, bool warnf=false, char chain='A')</td></tr>
<tr class="memdesc:ad35a661359739714f8b03295788e4dc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">An alternative to <a class="el" href="classMolecule.html#a834ac3e93af40e0f03bf1bb83c1ccb3e" title="Load Molecule from a standard format (PDB or GRO)">Molecule::Molecule(const std::string&amp;,const ForceField&amp;,const std::string&amp;,bool,bool,char)</a> where instead of filename, a stream is provided. Useful when multiple molecules are stored in the same file. See Also(loadFromCheckpoint()) <br /></td></tr>
<tr class="separator:ad35a661359739714f8b03295788e4dc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ff980b574a62526abff3d631c83bf94"><td class="memItemLeft" align="right" valign="top"><a id="a1ff980b574a62526abff3d631c83bf94" name="a1ff980b574a62526abff3d631c83bf94"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>~Molecule</b> ()</td></tr>
<tr class="memdesc:a1ff980b574a62526abff3d631c83bf94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default destructor: <b>Deletes its atom data</b> and frees up memory. <br /></td></tr>
<tr class="separator:a1ff980b574a62526abff3d631c83bf94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cdf18b0095a344a34d5ffe80be73d98"><td class="memItemLeft" align="right" valign="top"><a id="a8cdf18b0095a344a34d5ffe80be73d98" name="a8cdf18b0095a344a34d5ffe80be73d98"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>loadMoleculeFromTXT</b> (std::istream &amp;f, bool eval=false, bool cpt=false, const <a class="el" href="classForceField.html">ForceField</a> *ff=nullptr)</td></tr>
<tr class="memdesc:a8cdf18b0095a344a34d5ffe80be73d98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Actual function called in the TXT file loading constructor. See: Molecule::Molecule(std::istream&amp;,bool,bool) <br /></td></tr>
<tr class="separator:a8cdf18b0095a344a34d5ffe80be73d98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6946cbe0d8daa9b2386d85ca7faf0cd1"><td class="memItemLeft" align="right" valign="top"><a id="a6946cbe0d8daa9b2386d85ca7faf0cd1" name="a6946cbe0d8daa9b2386d85ca7faf0cd1"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>getSize</b> () const</td></tr>
<tr class="memdesc:a6946cbe0d8daa9b2386d85ca7faf0cd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the total number of atoms (including hydrogen atoms) in this <a class="el" href="classMolecule.html">Molecule</a>. <br /></td></tr>
<tr class="separator:a6946cbe0d8daa9b2386d85ca7faf0cd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c6228c3225bd9571ba276841caa7c90"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a4c6228c3225bd9571ba276841caa7c90">getEffectiveSize</a> () const</td></tr>
<tr class="memdesc:a4c6228c3225bd9571ba276841caa7c90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the total number of atoms (excluding hydrogen atoms) in this <a class="el" href="classMolecule.html">Molecule</a>.  <a href="classMolecule.html#a4c6228c3225bd9571ba276841caa7c90">More...</a><br /></td></tr>
<tr class="separator:a4c6228c3225bd9571ba276841caa7c90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75dace1f6d0736e85fbe517a0f26e136"><td class="memItemLeft" align="right" valign="top"><a id="a75dace1f6d0736e85fbe517a0f26e136" name="a75dace1f6d0736e85fbe517a0f26e136"></a>
const <a class="el" href="classAtom.html">Atom</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>getAtom</b> (int n) const</td></tr>
<tr class="memdesc:a75dace1f6d0736e85fbe517a0f26e136"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the pointer to the 'n'th atom in this <a class="el" href="classMolecule.html">Molecule</a> (alternate method for a "const" <a class="el" href="classMolecule.html">Molecule</a> object) <br /></td></tr>
<tr class="separator:a75dace1f6d0736e85fbe517a0f26e136"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a3d512a623d6ffdcc21783b651c1dee"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classAtom.html">Atom</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a1a3d512a623d6ffdcc21783b651c1dee">getLastAtom</a> () const</td></tr>
<tr class="memdesc:a1a3d512a623d6ffdcc21783b651c1dee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the last atom in this molecule.  <a href="classMolecule.html#a1a3d512a623d6ffdcc21783b651c1dee">More...</a><br /></td></tr>
<tr class="separator:a1a3d512a623d6ffdcc21783b651c1dee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c5e2e247a65abf29d4bb379d09efb90"><td class="memItemLeft" align="right" valign="top"><a id="a8c5e2e247a65abf29d4bb379d09efb90" name="a8c5e2e247a65abf29d4bb379d09efb90"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>getMass</b> () const</td></tr>
<tr class="memdesc:a8c5e2e247a65abf29d4bb379d09efb90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the mass of this molecule (by adding masses of individual atoms) <br /></td></tr>
<tr class="separator:a8c5e2e247a65abf29d4bb379d09efb90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d42c427c602da77f79246fe39246fb9"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; <a class="el" href="classAtom.html">Atom</a> * &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a7d42c427c602da77f79246fe39246fb9">getAtoms</a> () const</td></tr>
<tr class="memdesc:a7d42c427c602da77f79246fe39246fb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a copy of the list of atoms belonging to this <a class="el" href="classMolecule.html">Molecule</a>.  <a href="classMolecule.html#a7d42c427c602da77f79246fe39246fb9">More...</a><br /></td></tr>
<tr class="separator:a7d42c427c602da77f79246fe39246fb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b87ff96eec588c7296fcda7ee7ed178"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; std::vector&lt; int &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a7b87ff96eec588c7296fcda7ee7ed178">getBonds</a> () const</td></tr>
<tr class="memdesc:a7b87ff96eec588c7296fcda7ee7ed178"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the bonding data of the molecule.  <a href="classMolecule.html#a7b87ff96eec588c7296fcda7ee7ed178">More...</a><br /></td></tr>
<tr class="separator:a7b87ff96eec588c7296fcda7ee7ed178"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcdacd3ae6feb61f05cdc306ed8ab29d"><td class="memItemLeft" align="right" valign="top"><a id="afcdacd3ae6feb61f05cdc306ed8ab29d" name="afcdacd3ae6feb61f05cdc306ed8ab29d"></a>
<a class="el" href="classAtom.html">Atom</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>getAtom</b> (int x)</td></tr>
<tr class="memdesc:afcdacd3ae6feb61f05cdc306ed8ab29d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the pointer to the 'n'th atom in this <a class="el" href="classMolecule.html">Molecule</a>. <br /></td></tr>
<tr class="separator:afcdacd3ae6feb61f05cdc306ed8ab29d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa13276cae00e350b9b28c07cb82ebcec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#aa13276cae00e350b9b28c07cb82ebcec">indexOf</a> (<a class="el" href="classAtom.html">Atom</a> *p) const</td></tr>
<tr class="memdesc:aa13276cae00e350b9b28c07cb82ebcec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the index value of an atom from it's pointer.  <a href="classMolecule.html#aa13276cae00e350b9b28c07cb82ebcec">More...</a><br /></td></tr>
<tr class="separator:aa13276cae00e350b9b28c07cb82ebcec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a008ae56ec47345e906b08db6d2fd2b1c"><td class="memItemLeft" align="right" valign="top"><a id="a008ae56ec47345e906b08db6d2fd2b1c" name="a008ae56ec47345e906b08db6d2fd2b1c"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>binding_energy</b> () const</td></tr>
<tr class="memdesc:a008ae56ec47345e906b08db6d2fd2b1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">a wrapper to get the calculated binding energy for this molecule. See Protein::calculateNonBondingEnergy(Molecule*). <br /></td></tr>
<tr class="separator:a008ae56ec47345e906b08db6d2fd2b1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fbc68980ca26d735d65eaf7c35a49c4"><td class="memItemLeft" align="right" valign="top"><a id="a5fbc68980ca26d735d65eaf7c35a49c4" name="a5fbc68980ca26d735d65eaf7c35a49c4"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>hotspot_binding_energy</b> () const</td></tr>
<tr class="memdesc:a5fbc68980ca26d735d65eaf7c35a49c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">a wrapper to get the calculated binding energy (the contribution of the "hotspot" region) for this molecule. See Protein::calculateNonBondingEnergy(Molecule*). <br /></td></tr>
<tr class="separator:a5fbc68980ca26d735d65eaf7c35a49c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadf1f51e311a11e69385ff51602b86bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#aadf1f51e311a11e69385ff51602b86bc">addAtom</a> (<a class="el" href="classAtom.html">Atom</a> *a)</td></tr>
<tr class="memdesc:aadf1f51e311a11e69385ff51602b86bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a new atom to the <a class="el" href="classMolecule.html">Molecule</a>.  <a href="classMolecule.html#aadf1f51e311a11e69385ff51602b86bc">More...</a><br /></td></tr>
<tr class="separator:aadf1f51e311a11e69385ff51602b86bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab64af9956394c7077c0ebf2db64b9cdf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#ab64af9956394c7077c0ebf2db64b9cdf">calculateBondOrders</a> (<a class="el" href="classForceField.html">ForceField</a> &amp;ff, bool assume_complete=false, bool assign_valence=false)</td></tr>
<tr class="memdesc:ab64af9956394c7077c0ebf2db64b9cdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate bond orders for the bonds of this molecules (experimental)  <a href="classMolecule.html#ab64af9956394c7077c0ebf2db64b9cdf">More...</a><br /></td></tr>
<tr class="separator:ab64af9956394c7077c0ebf2db64b9cdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0590f11faa97d063d7542f91587898c"><td class="memItemLeft" align="right" valign="top"><a id="aa0590f11faa97d063d7542f91587898c" name="aa0590f11faa97d063d7542f91587898c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>calculateBondOrders2</b> (<a class="el" href="classForceField.html">ForceField</a> &amp;ff, bool assume_complete=false, bool assign_valence=false)</td></tr>
<tr class="memdesc:aa0590f11faa97d063d7542f91587898c"><td class="mdescLeft">&#160;</td><td class="mdescRight">An update on the original <a class="el" href="classMolecule.html#ab64af9956394c7077c0ebf2db64b9cdf" title="Calculate bond orders for the bonds of this molecules (experimental)">calculateBondOrders()</a> method. <br /></td></tr>
<tr class="separator:aa0590f11faa97d063d7542f91587898c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfd8b7d4b46f69a9675e2fcac4397d19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#abfd8b7d4b46f69a9675e2fcac4397d19">markCyclizedAtoms</a> ()</td></tr>
<tr class="memdesc:abfd8b7d4b46f69a9675e2fcac4397d19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark the atoms which are cyclized.  <a href="classMolecule.html#abfd8b7d4b46f69a9675e2fcac4397d19">More...</a><br /></td></tr>
<tr class="separator:abfd8b7d4b46f69a9675e2fcac4397d19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8234989a3038abdd2228bf243cb7f668"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a8234989a3038abdd2228bf243cb7f668">calculateNRot</a> (const <a class="el" href="classForceField.html">ForceField</a> *ff=nullptr, bool mod=false)</td></tr>
<tr class="memdesc:a8234989a3038abdd2228bf243cb7f668"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the number of rotatable bonds.  <a href="classMolecule.html#a8234989a3038abdd2228bf243cb7f668">More...</a><br /></td></tr>
<tr class="separator:a8234989a3038abdd2228bf243cb7f668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acae7cca34de5ee4bf83f6627e7501ab8"><td class="memItemLeft" align="right" valign="top"><a id="acae7cca34de5ee4bf83f6627e7501ab8" name="acae7cca34de5ee4bf83f6627e7501ab8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>printStructureTree</b> ()</td></tr>
<tr class="memdesc:acae7cca34de5ee4bf83f6627e7501ab8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print out the adjacency list to standard output. <br /></td></tr>
<tr class="separator:acae7cca34de5ee4bf83f6627e7501ab8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3b73777e17fa7a34d15866fab326cfc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#aa3b73777e17fa7a34d15866fab326cfc">sealAll</a> ()</td></tr>
<tr class="memdesc:aa3b73777e17fa7a34d15866fab326cfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">"Caps" all the atoms of this molecule  <a href="classMolecule.html#aa3b73777e17fa7a34d15866fab326cfc">More...</a><br /></td></tr>
<tr class="separator:aa3b73777e17fa7a34d15866fab326cfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6c1f0207db1069de8e3a49a1881e880"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#ab6c1f0207db1069de8e3a49a1881e880">free</a> (<a class="el" href="classAtom.html">Atom</a> *a, int val=-1)</td></tr>
<tr class="memdesc:ab6c1f0207db1069de8e3a49a1881e880"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manually "frees" a capped or completely valency satisfied atom.  <a href="classMolecule.html#ab6c1f0207db1069de8e3a49a1881e880">More...</a><br /></td></tr>
<tr class="separator:ab6c1f0207db1069de8e3a49a1881e880"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a588965bd448a1cb43f25aed3179ecf96"><td class="memItemLeft" align="right" valign="top"><a id="a588965bd448a1cb43f25aed3179ecf96" name="a588965bd448a1cb43f25aed3179ecf96"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>calculateFreeAtoms</b> ()</td></tr>
<tr class="memdesc:a588965bd448a1cb43f25aed3179ecf96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manually parse the atom-list to add/remove atoms from the "free atoms" list. This is useful only when the <a class="el" href="classMolecule.html">Molecule</a> has been manually constructed (using functions like <a class="el" href="classMolecule.html#aadf1f51e311a11e69385ff51602b86bc" title="Add a new atom to the Molecule.">addAtom()</a>, <a class="el" href="classMolecule.html#a04b3beb3e333664d6421e9f0ee46dd73" title="Join two atoms to make a bond.">makeBond()</a>, and <a class="el" href="classMolecule.html#aebc4ac8f4a68e24dbb0720402798ca4e" title="Add an atom to the molecule by bonding it to a pre-existing atom of the molecule.">bondAtom()</a>) <br /></td></tr>
<tr class="separator:a588965bd448a1cb43f25aed3179ecf96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b92bf02eb26dd75ea36273601e0a3c2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a1b92bf02eb26dd75ea36273601e0a3c2">loadGrid</a> (<a class="el" href="classSystem.html">System</a> &amp;s)</td></tr>
<tr class="separator:a1b92bf02eb26dd75ea36273601e0a3c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef77043ab98f1008a15a1e52d85b827e"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; <a class="el" href="classAtom.html">Atom</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a> (<a class="el" href="classAtom.html">Atom</a> *src) const</td></tr>
<tr class="memdesc:aef77043ab98f1008a15a1e52d85b827e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get all atoms bonded to a given atom.  <a href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">More...</a><br /></td></tr>
<tr class="separator:aef77043ab98f1008a15a1e52d85b827e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab89456b4f7e16d7cbf6025f0389f5d10"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#ab89456b4f7e16d7cbf6025f0389f5d10">startTrials</a> ()</td></tr>
<tr class="memdesc:ab89456b4f7e16d7cbf6025f0389f5d10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start trial mode.  <a href="classMolecule.html#ab89456b4f7e16d7cbf6025f0389f5d10">More...</a><br /></td></tr>
<tr class="separator:ab89456b4f7e16d7cbf6025f0389f5d10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af86a46bfed0f76534eb11a2016371f13"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#af86a46bfed0f76534eb11a2016371f13">rollback</a> (const <a class="el" href="classSystem.html">System</a> &amp;s)</td></tr>
<tr class="memdesc:af86a46bfed0f76534eb11a2016371f13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restore original molecule. All changes from the last call of <a class="el" href="classMolecule.html#ab89456b4f7e16d7cbf6025f0389f5d10" title="Start trial mode.">startTrials()</a> will be deleted.  <a href="classMolecule.html#af86a46bfed0f76534eb11a2016371f13">More...</a><br /></td></tr>
<tr class="separator:af86a46bfed0f76534eb11a2016371f13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac178106e85c4a667d2c7faa57765d0fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#ac178106e85c4a667d2c7faa57765d0fb">miniRollback</a> (const <a class="el" href="classForceField.html">ForceField</a> &amp;ff)</td></tr>
<tr class="separator:ac178106e85c4a667d2c7faa57765d0fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04b2de48ba4c22b9bef6ca8aec90c1f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a04b2de48ba4c22b9bef6ca8aec90c1f9">commit</a> ()</td></tr>
<tr class="memdesc:a04b2de48ba4c22b9bef6ca8aec90c1f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save all changes and end trial mode.  <a href="classMolecule.html#a04b2de48ba4c22b9bef6ca8aec90c1f9">More...</a><br /></td></tr>
<tr class="separator:a04b2de48ba4c22b9bef6ca8aec90c1f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50d2a2068fcda1e9676eb5d8e3aac9f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAtom.html">Atom</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a50d2a2068fcda1e9676eb5d8e3aac9f2">getRandomBondableAtom</a> () const</td></tr>
<tr class="memdesc:a50d2a2068fcda1e9676eb5d8e3aac9f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Randomly select an atom with free valencies.  <a href="classMolecule.html#a50d2a2068fcda1e9676eb5d8e3aac9f2">More...</a><br /></td></tr>
<tr class="separator:a50d2a2068fcda1e9676eb5d8e3aac9f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04b3beb3e333664d6421e9f0ee46dd73"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a04b3beb3e333664d6421e9f0ee46dd73">makeBond</a> (<a class="el" href="classAtom.html">Atom</a> *a1, <a class="el" href="classAtom.html">Atom</a> *a2)</td></tr>
<tr class="memdesc:a04b3beb3e333664d6421e9f0ee46dd73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Join two atoms to make a bond.  <a href="classMolecule.html#a04b3beb3e333664d6421e9f0ee46dd73">More...</a><br /></td></tr>
<tr class="separator:a04b3beb3e333664d6421e9f0ee46dd73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebc4ac8f4a68e24dbb0720402798ca4e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#aebc4ac8f4a68e24dbb0720402798ca4e">bondAtom</a> (<a class="el" href="classAtom.html">Atom</a> *natm, <a class="el" href="classAtom.html">Atom</a> *src)</td></tr>
<tr class="memdesc:aebc4ac8f4a68e24dbb0720402798ca4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an atom to the molecule by bonding it to a pre-existing atom of the molecule.  <a href="classMolecule.html#aebc4ac8f4a68e24dbb0720402798ca4e">More...</a><br /></td></tr>
<tr class="separator:aebc4ac8f4a68e24dbb0720402798ca4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab5fec59c8dddb8cf598eb38f524a94a"><td class="memItemLeft" align="right" valign="top"><a id="aab5fec59c8dddb8cf598eb38f524a94a" name="aab5fec59c8dddb8cf598eb38f524a94a"></a>
std::vector&lt; <a class="el" href="classAtom.html">Atom</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>bondFragment</b> (<a class="el" href="classMolecularFragment.html">MolecularFragment</a> *nfrag, int ind, <a class="el" href="classAtom.html">Atom</a> *src)</td></tr>
<tr class="memdesc:aab5fec59c8dddb8cf598eb38f524a94a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bond a fragment to a given molecule by attaching one point to another atom. Returns a bool value to report success. <br /></td></tr>
<tr class="separator:aab5fec59c8dddb8cf598eb38f524a94a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a973b1a0e85f2a3cf1e5c55dbe24c54e3"><td class="memItemLeft" align="right" valign="top"><a id="a973b1a0e85f2a3cf1e5c55dbe24c54e3" name="a973b1a0e85f2a3cf1e5c55dbe24c54e3"></a>
virtual std::pair&lt; double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>calculateNonBondingEnergy</b> (<a class="el" href="classAtom.html">Atom</a> *dummy, bool write=false)</td></tr>
<tr class="memdesc:a973b1a0e85f2a3cf1e5c55dbe24c54e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">A wrapper to iterate through all the atoms in this molecule, and sum up the non-bonding interaction energy of this new (external) atom with this molecule. See Also: <a class="el" href="namespacechemtools.html#a4d736b938261879ac0c621cd97172a7a" title="A wrapper that uses the stored parameters of Atom objects to calculate non-bonding interaction betwee...">chemtools::getNonbondingPotential()</a> <br /></td></tr>
<tr class="separator:a973b1a0e85f2a3cf1e5c55dbe24c54e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28fd8a15cac9bf3f9df358af8ee07ff0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a28fd8a15cac9bf3f9df358af8ee07ff0">samplegrowimpartial</a> (const <a class="el" href="classSystem.html">System</a> &amp;s, int n, int trials=15)</td></tr>
<tr class="separator:a28fd8a15cac9bf3f9df358af8ee07ff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63283844d6c417b775c29fc9c86eef47"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a63283844d6c417b775c29fc9c86eef47">getHotspotEnergy</a> (const <a class="el" href="classSystem.html">System</a> &amp;s, double v=0)</td></tr>
<tr class="separator:a63283844d6c417b775c29fc9c86eef47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa3f24a1ea27312d39f72d8b4f277058"><td class="memItemLeft" align="right" valign="top"><a id="aaa3f24a1ea27312d39f72d8b4f277058" name="aaa3f24a1ea27312d39f72d8b4f277058"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>attempt</b> (const <a class="el" href="classSystem.html">System</a> &amp;s, <a class="el" href="classAtom.html">Atom</a> *gP, <a class="el" href="classAtom.html">Atom</a> *nat, <a class="el" href="classAtom.html">Atom</a> *&amp;nxt, int trials=10, bool restr=false, int nps=0, int devid=0)</td></tr>
<tr class="memdesc:aaa3f24a1ea27312d39f72d8b4f277058"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempts to add a new atom to a source atom. See flowchart of algorithm in PDF for more details. <br /></td></tr>
<tr class="separator:aaa3f24a1ea27312d39f72d8b4f277058"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0beb758c9101529938d5fdab3ed3f86"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#ab0beb758c9101529938d5fdab3ed3f86">reduce</a> (const <a class="el" href="classSystem.html">System</a> &amp;s, int trials=15, bool forced=false, int devid=0)</td></tr>
<tr class="memdesc:ab0beb758c9101529938d5fdab3ed3f86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Complete all valencies by adding hydrogens.  <a href="classMolecule.html#ab0beb758c9101529938d5fdab3ed3f86">More...</a><br /></td></tr>
<tr class="separator:ab0beb758c9101529938d5fdab3ed3f86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fb016cb3c6871904bd1e856e40f9fd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a6fb016cb3c6871904bd1e856e40f9fd1">samplegrowunrigid</a> (const <a class="el" href="classSystem.html">System</a> &amp;s, int n, int trials=15)</td></tr>
<tr class="separator:a6fb016cb3c6871904bd1e856e40f9fd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c2caa1e42988fec83ed9101383c2f19"><td class="memItemLeft" align="right" valign="top"><a id="a2c2caa1e42988fec83ed9101383c2f19" name="a2c2caa1e42988fec83ed9101383c2f19"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>completeAttempt</b> (ostream &amp;logfile, const <a class="el" href="classSystem.html">System</a> &amp;s, <a class="el" href="classAtom.html">Atom</a> *src, int trials=25, int nupper=90, int level=0, int levellim=LEVELLIMIT, bool restr=false, bool superseed=false, bool reseed=false, bool deseed=false, <a class="el" href="classMolecule.html">Molecule</a> *&amp;common_newroot=NULLMOL, int common_seedlength=0, int devid=0)</td></tr>
<tr class="memdesc:a2c2caa1e42988fec83ed9101383c2f19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to satisfy all atom-type requirements. See algorithm details in the PDF containing the flowchart. <br /></td></tr>
<tr class="separator:a2c2caa1e42988fec83ed9101383c2f19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc8c0ae7c7ce4f851344d9b4b6479602"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#adc8c0ae7c7ce4f851344d9b4b6479602">samplegrow</a> (ostream &amp;logfile, const <a class="el" href="classSystem.html">System</a> &amp;s, int n, int trials=15, int nupper=90, int levellim=LEVELLIMIT, bool restr=false, bool superseed=false, bool reseed=false, bool deseed=false, <a class="el" href="classMolecule.html">Molecule</a> *&amp;common_newroot=NULLMOL, int common_seedlength=0, int devid=0)</td></tr>
<tr class="memdesc:adc8c0ae7c7ce4f851344d9b4b6479602"><td class="mdescLeft">&#160;</td><td class="mdescRight">The internal growth function which guided the molecule growth.  <a href="classMolecule.html#adc8c0ae7c7ce4f851344d9b4b6479602">More...</a><br /></td></tr>
<tr class="separator:adc8c0ae7c7ce4f851344d9b4b6479602"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b91da44d6681118424a20a4a8ea2b24"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a6b91da44d6681118424a20a4a8ea2b24">uniformChargeAdjustments</a> (double tchg=0)</td></tr>
<tr class="memdesc:a6b91da44d6681118424a20a4a8ea2b24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the net charge of the <a class="el" href="classMolecule.html">Molecule</a> by uniformly modifying the charges of all atoms (usually by a small quantity for large enough molecules)  <a href="classMolecule.html#a6b91da44d6681118424a20a4a8ea2b24">More...</a><br /></td></tr>
<tr class="separator:a6b91da44d6681118424a20a4a8ea2b24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69594b093fbb60eabc373d6860f19a87"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a69594b093fbb60eabc373d6860f19a87">getNetCharge</a> (const <a class="el" href="classForceField.html">ForceField</a> &amp;ff) const</td></tr>
<tr class="memdesc:a69594b093fbb60eabc373d6860f19a87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get expected charge of a molecule.  <a href="classMolecule.html#a69594b093fbb60eabc373d6860f19a87">More...</a><br /></td></tr>
<tr class="separator:a69594b093fbb60eabc373d6860f19a87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a728fa63d31ed43876593086571e82cf6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a728fa63d31ed43876593086571e82cf6">describeStructure</a> (std::ostream &amp;outs=std::cout) const</td></tr>
<tr class="memdesc:a728fa63d31ed43876593086571e82cf6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Symbolically describe the structure of the molecule.  <a href="classMolecule.html#a728fa63d31ed43876593086571e82cf6">More...</a><br /></td></tr>
<tr class="separator:a728fa63d31ed43876593086571e82cf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3457de95adc23d040a6545a8b783dd32"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a3457de95adc23d040a6545a8b783dd32">quickLocate</a> (int latind, int startatin, std::vector&lt; int &gt; passed)</td></tr>
<tr class="memdesc:a3457de95adc23d040a6545a8b783dd32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locate the closest path joining the atoms at the two indices without passing through the given list of atoms (Used to find path when cyclization occurs)  <a href="classMolecule.html#a3457de95adc23d040a6545a8b783dd32">More...</a><br /></td></tr>
<tr class="separator:a3457de95adc23d040a6545a8b783dd32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72616aa9d293190a9a0372a735f76966"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a72616aa9d293190a9a0372a735f76966">dumpMol</a> (const std::string &amp;fn, const <a class="el" href="classForceField.html">ForceField</a> *ff=nullptr) const</td></tr>
<tr class="memdesc:a72616aa9d293190a9a0372a735f76966"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write (dump) a molecule to a file (in PDB format)  <a href="classMolecule.html#a72616aa9d293190a9a0372a735f76966">More...</a><br /></td></tr>
<tr class="separator:a72616aa9d293190a9a0372a735f76966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf63c026f43bb010231bc3dbb7c7b7de"><td class="memItemLeft" align="right" valign="top"><a id="abf63c026f43bb010231bc3dbb7c7b7de" name="abf63c026f43bb010231bc3dbb7c7b7de"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>dumpMol</b> (ofstream &amp;f, const <a class="el" href="classForceField.html">ForceField</a> *ff=nullptr) const</td></tr>
<tr class="memdesc:abf63c026f43bb010231bc3dbb7c7b7de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Same as dumpMol(const std::string&amp;,const ForceField*). Uses an output stream instead of filename. <br /></td></tr>
<tr class="separator:abf63c026f43bb010231bc3dbb7c7b7de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeb8483a7acbcab66438a3ec61b53971"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#abeb8483a7acbcab66438a3ec61b53971">dumpMolAsTxt</a> (ostream &amp;f, bool cpt=false) const</td></tr>
<tr class="memdesc:abeb8483a7acbcab66438a3ec61b53971"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump the molecule as a TXT file (See algorithm documentation PDF for details about this format)  <a href="classMolecule.html#abeb8483a7acbcab66438a3ec61b53971">More...</a><br /></td></tr>
<tr class="separator:abeb8483a7acbcab66438a3ec61b53971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3afedbfc21fac19be1d4c5aaa9a9ac63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a3afedbfc21fac19be1d4c5aaa9a9ac63">dumpMolAsTxt</a> (const std::string &amp;f, bool cpt=false) const</td></tr>
<tr class="separator:a3afedbfc21fac19be1d4c5aaa9a9ac63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d59b178a86747eca8237e73170351e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a8d59b178a86747eca8237e73170351e5">dumpMolAsGRO</a> (std::ostream &amp;os, int stI=1, bool head=true, const std::string &amp;header=&quot;DNV GRO molecule output&quot;) const</td></tr>
<tr class="memdesc:a8d59b178a86747eca8237e73170351e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the molecule data in GRO format.  <a href="classMolecule.html#a8d59b178a86747eca8237e73170351e5">More...</a><br /></td></tr>
<tr class="separator:a8d59b178a86747eca8237e73170351e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8c0559dba93cc2a1abef93b13216de1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#af8c0559dba93cc2a1abef93b13216de1">dumpMolAsMol2</a> (std::ostream &amp;os, <a class="el" href="classForceField.html">ForceField</a> *ff=nullptr, bool no_orders=false, bool calculate_orders=false, const std::string &amp;name=&quot;DNV&quot;)</td></tr>
<tr class="memdesc:af8c0559dba93cc2a1abef93b13216de1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump molecule in mol2 format to a stream.  <a href="classMolecule.html#af8c0559dba93cc2a1abef93b13216de1">More...</a><br /></td></tr>
<tr class="separator:af8c0559dba93cc2a1abef93b13216de1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bbf0be79bb0c20c003bbb2160244306"><td class="memItemLeft" align="right" valign="top"><a id="a7bbf0be79bb0c20c003bbb2160244306" name="a7bbf0be79bb0c20c003bbb2160244306"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>getSolvationEnergyEstimate</b> ()</td></tr>
<tr class="memdesc:a7bbf0be79bb0c20c003bbb2160244306"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the net solvation energy estimate for this molecule (first-order linear approximation) <br /></td></tr>
<tr class="separator:a7bbf0be79bb0c20c003bbb2160244306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0839d679a7ed5664c8729ab572ef67d7"><td class="memItemLeft" align="right" valign="top">Eigen::Vector3d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a0839d679a7ed5664c8729ab572ef67d7">getCentreOfGeometry</a> (bool inch=false) const</td></tr>
<tr class="memdesc:a0839d679a7ed5664c8729ab572ef67d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the center of geometry of the molecule.  <a href="classMolecule.html#a0839d679a7ed5664c8729ab572ef67d7">More...</a><br /></td></tr>
<tr class="separator:a0839d679a7ed5664c8729ab572ef67d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4ee33c60073cc39d50f316576275a69"><td class="memItemLeft" align="right" valign="top"><a id="af4ee33c60073cc39d50f316576275a69" name="af4ee33c60073cc39d50f316576275a69"></a>
Eigen::Vector3d&#160;</td><td class="memItemRight" valign="bottom"><b>getCentreOfMass</b> (bool inch=true) const</td></tr>
<tr class="memdesc:af4ee33c60073cc39d50f316576275a69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the center-of-mass for this molecule. Important when handling the system for mechanics. <br /></td></tr>
<tr class="separator:af4ee33c60073cc39d50f316576275a69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b2d6019d07a44478eca43157a0f55e6"><td class="memItemLeft" align="right" valign="top"><a id="a9b2d6019d07a44478eca43157a0f55e6" name="a9b2d6019d07a44478eca43157a0f55e6"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>getMomentOfInertia</b> (bool inch=true) const</td></tr>
<tr class="memdesc:a9b2d6019d07a44478eca43157a0f55e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the moment of inertia for this molecule (used for simulating rigid-body dynamics) <br /></td></tr>
<tr class="separator:a9b2d6019d07a44478eca43157a0f55e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d482b455228629e6ca908ce461a64a7"><td class="memItemLeft" align="right" valign="top">std::pair&lt; Eigen::Vector3d, Eigen::Vector3d &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a3d482b455228629e6ca908ce461a64a7">getContainer</a> () const</td></tr>
<tr class="memdesc:a3d482b455228629e6ca908ce461a64a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a containing "box" co-ordinates which ensures that the molecule is enclosed by it.  <a href="classMolecule.html#a3d482b455228629e6ca908ce461a64a7">More...</a><br /></td></tr>
<tr class="separator:a3d482b455228629e6ca908ce461a64a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eff5649ce64bbe64269a1b7e21016ed"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a5eff5649ce64bbe64269a1b7e21016ed">bestPlaneOfFit</a> (double err=1e-5) const</td></tr>
<tr class="memdesc:a5eff5649ce64bbe64269a1b7e21016ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the bast plane of fit to this molecule - experimental.  <a href="classMolecule.html#a5eff5649ce64bbe64269a1b7e21016ed">More...</a><br /></td></tr>
<tr class="separator:a5eff5649ce64bbe64269a1b7e21016ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbd9a3848f358d7b556201b822a0092d"><td class="memItemLeft" align="right" valign="top"><a id="acbd9a3848f358d7b556201b822a0092d" name="acbd9a3848f358d7b556201b822a0092d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>translateMolecule</b> (const Eigen::Vector3d &amp;v)</td></tr>
<tr class="memdesc:acbd9a3848f358d7b556201b822a0092d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Translate a molecule along a given vector. Length of translation depends on vector length. <br /></td></tr>
<tr class="separator:acbd9a3848f358d7b556201b822a0092d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbbc84419964e42f958f78219a92b556"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#adbbc84419964e42f958f78219a92b556">rotateMolecule</a> (const Eigen::Vector3d &amp;n, Eigen::Vector3d com=Eigen::Vector3d(0, 0, 0))</td></tr>
<tr class="memdesc:adbbc84419964e42f958f78219a92b556"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate the molecule about a given vector by a given angle (in radians). The angle is given by the norm of the vector.  <a href="classMolecule.html#adbbc84419964e42f958f78219a92b556">More...</a><br /></td></tr>
<tr class="separator:adbbc84419964e42f958f78219a92b556"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa6fbeecd0df2fb5a8026895ab57bc60"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#afa6fbeecd0df2fb5a8026895ab57bc60">rotateDihedralTo</a> (<a class="el" href="classAtom.html">Atom</a> *a1, <a class="el" href="classAtom.html">Atom</a> *a2, <a class="el" href="classAtom.html">Atom</a> *a3, <a class="el" href="classAtom.html">Atom</a> *a4, double dih)</td></tr>
<tr class="memdesc:afa6fbeecd0df2fb5a8026895ab57bc60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate the dihedral to set it to a particular value.  <a href="classMolecule.html#afa6fbeecd0df2fb5a8026895ab57bc60">More...</a><br /></td></tr>
<tr class="separator:afa6fbeecd0df2fb5a8026895ab57bc60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dbdfaca5e02c004c63d15b43817c418"><td class="memItemLeft" align="right" valign="top"><a id="a7dbdfaca5e02c004c63d15b43817c418" name="a7dbdfaca5e02c004c63d15b43817c418"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>rotateDihedralTo</b> (int i1, int i2, int i3, int i4, double dih)</td></tr>
<tr class="memdesc:a7dbdfaca5e02c004c63d15b43817c418"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classMolecule.html#afa6fbeecd0df2fb5a8026895ab57bc60" title="Rotate the dihedral to set it to a particular value.">rotateDihedralTo()</a> that uses atom indices instead of <a class="el" href="classAtom.html">Atom</a> pointers. More efficient if you know the indices already <br /></td></tr>
<tr class="separator:a7dbdfaca5e02c004c63d15b43817c418"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef128442de06304833ac94e8a418ba61"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#aef128442de06304833ac94e8a418ba61">calculateInternalEnergy</a> (const <a class="el" href="classForceField.html">ForceField</a> &amp;ff) const</td></tr>
<tr class="memdesc:aef128442de06304833ac94e8a418ba61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the total internal energy of a molecule.  <a href="classMolecule.html#aef128442de06304833ac94e8a418ba61">More...</a><br /></td></tr>
<tr class="separator:aef128442de06304833ac94e8a418ba61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad622f2b8ddde095a834f73e2f589b014"><td class="memItemLeft" align="right" valign="top"><a id="ad622f2b8ddde095a834f73e2f589b014" name="ad622f2b8ddde095a834f73e2f589b014"></a>
std::pair&lt; std::vector&lt; Eigen::Vector3d &gt;, std::vector&lt; Eigen::Vector3d &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>calculateActingForces</b> (<a class="el" href="classMolecule.html">Molecule</a> *lig) const</td></tr>
<tr class="memdesc:ad622f2b8ddde095a834f73e2f589b014"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the forces acting on a target molecule from this molecule. <br /></td></tr>
<tr class="separator:ad622f2b8ddde095a834f73e2f589b014"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a586d332662ebab7d9c3cdf667d39a901"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::pair&lt; int, int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a586d332662ebab7d9c3cdf667d39a901">getAllBridgeHeads</a> ()</td></tr>
<tr class="memdesc:a586d332662ebab7d9c3cdf667d39a901"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find all bridge-head atom index pairs for all possible bridges in this molecule.  <a href="classMolecule.html#a586d332662ebab7d9c3cdf667d39a901">More...</a><br /></td></tr>
<tr class="separator:a586d332662ebab7d9c3cdf667d39a901"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37f0c2acba7e35455f6128fff194e1a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a37f0c2acba7e35455f6128fff194e1a9">dropSingleAtom</a> (int din)</td></tr>
<tr class="memdesc:a37f0c2acba7e35455f6128fff194e1a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows to drop one atom from the molecule. Read well before usage.  <a href="classMolecule.html#a37f0c2acba7e35455f6128fff194e1a9">More...</a><br /></td></tr>
<tr class="separator:a37f0c2acba7e35455f6128fff194e1a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6351ba55249d7e5659dfbb397dd0e069"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a6351ba55249d7e5659dfbb397dd0e069">makePruneFragment</a> (int n, int devid=0)</td></tr>
<tr class="memdesc:a6351ba55249d7e5659dfbb397dd0e069"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function generates the starting fragment for "pruning" (See algorthim PDF).  <a href="classMolecule.html#a6351ba55249d7e5659dfbb397dd0e069">More...</a><br /></td></tr>
<tr class="separator:a6351ba55249d7e5659dfbb397dd0e069"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45071d6f28ea163b763f08ae23430a76"><td class="memItemLeft" align="right" valign="top"><a id="a45071d6f28ea163b763f08ae23430a76" name="a45071d6f28ea163b763f08ae23430a76"></a>
<a class="el" href="classMolecule.html">Molecule</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>createSubmolecule</b> (const std::vector&lt; <a class="el" href="classAtom.html">Atom</a> * &gt; &amp;ats)</td></tr>
<tr class="memdesc:a45071d6f28ea163b763f08ae23430a76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make a sub-Molecule from the given molecule using a set of atoms (maintaining any bonds possible) <br /></td></tr>
<tr class="separator:a45071d6f28ea163b763f08ae23430a76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2e19e6613d0ed3d7249a3aaea8f87dd"><td class="memItemLeft" align="right" valign="top">std::pair&lt; std::string, std::vector&lt; <a class="el" href="classAtom.html">Atom</a> * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#ad2e19e6613d0ed3d7249a3aaea8f87dd">getSMILES2</a> (const <a class="el" href="classForceField.html">ForceField</a> *ff=nullptr, bool daylight=false) const</td></tr>
<tr class="memdesc:ad2e19e6613d0ed3d7249a3aaea8f87dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get SMILES format for this molecule - Improved.  <a href="classMolecule.html#ad2e19e6613d0ed3d7249a3aaea8f87dd">More...</a><br /></td></tr>
<tr class="separator:ad2e19e6613d0ed3d7249a3aaea8f87dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aef6bc268040eb562836135eae6802a"><td class="memItemLeft" align="right" valign="top"><a id="a5aef6bc268040eb562836135eae6802a" name="a5aef6bc268040eb562836135eae6802a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>getAID</b> (<a class="el" href="classAtom.html">Atom</a> *a) const</td></tr>
<tr class="memdesc:a5aef6bc268040eb562836135eae6802a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get <a class="el" href="classAtom.html">Atom</a> ID (used during "hashing") -experimental. <br /></td></tr>
<tr class="separator:a5aef6bc268040eb562836135eae6802a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1796d77ef0d13270640fa26c6402e45"><td class="memItemLeft" align="right" valign="top"><a id="ab1796d77ef0d13270640fa26c6402e45" name="ab1796d77ef0d13270640fa26c6402e45"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>getAID</b> (int atno) const</td></tr>
<tr class="memdesc:ab1796d77ef0d13270640fa26c6402e45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get <a class="el" href="classAtom.html">Atom</a> ID (used during "hashing") -experimental. <br /></td></tr>
<tr class="separator:ab1796d77ef0d13270640fa26c6402e45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bc7955fb40d44962a8a21ad964cbab6"><td class="memItemLeft" align="right" valign="top"><a id="a8bc7955fb40d44962a8a21ad964cbab6" name="a8bc7955fb40d44962a8a21ad964cbab6"></a>
std::vector&lt; int &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>hashatomcomplete</b> (int ind) const</td></tr>
<tr class="memdesc:a8bc7955fb40d44962a8a21ad964cbab6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a "hash vector" for this atom -experimental. <br /></td></tr>
<tr class="separator:a8bc7955fb40d44962a8a21ad964cbab6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54571895bd7b4ffa483889aad3b1092b"><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a54571895bd7b4ffa483889aad3b1092b">hashatom</a> (<a class="el" href="classAtom.html">Atom</a> *a)</td></tr>
<tr class="memdesc:a54571895bd7b4ffa483889aad3b1092b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Numeric first-order hash.  <a href="classMolecule.html#a54571895bd7b4ffa483889aad3b1092b">More...</a><br /></td></tr>
<tr class="separator:a54571895bd7b4ffa483889aad3b1092b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a804447203e588ac312611688aa4fb500"><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a804447203e588ac312611688aa4fb500">getFirstOrderHash</a> ()</td></tr>
<tr class="memdesc:a804447203e588ac312611688aa4fb500"><td class="mdescLeft">&#160;</td><td class="mdescRight">Numeric first-order hash.  <a href="classMolecule.html#a804447203e588ac312611688aa4fb500">More...</a><br /></td></tr>
<tr class="separator:a804447203e588ac312611688aa4fb500"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b7c224368ec15caea268e26051c9437"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a9b7c224368ec15caea268e26051c9437">getCompleteHash</a> (bool heavy=false) const</td></tr>
<tr class="memdesc:a9b7c224368ec15caea268e26051c9437"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a complete hash vector for a molecule. - experimental.  <a href="classMolecule.html#a9b7c224368ec15caea268e26051c9437">More...</a><br /></td></tr>
<tr class="separator:a9b7c224368ec15caea268e26051c9437"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91f54fd4523fcafbb41bb88fc6846d85"><td class="memItemLeft" align="right" valign="top"><a id="a91f54fd4523fcafbb41bb88fc6846d85" name="a91f54fd4523fcafbb41bb88fc6846d85"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>getGraphDistance</b> (const <a class="el" href="classMolecule.html">Molecule</a> *m2, double base=0.8) const</td></tr>
<tr class="memdesc:a91f54fd4523fcafbb41bb88fc6846d85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to match the similarity of two molecules and score the similarity in (0,1) - under development. <br /></td></tr>
<tr class="separator:a91f54fd4523fcafbb41bb88fc6846d85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4065bbc264b5b4263a927a4f63116c3"><td class="memItemLeft" align="right" valign="top"><a id="af4065bbc264b5b4263a927a4f63116c3" name="af4065bbc264b5b4263a927a4f63116c3"></a>
Pose&#160;</td><td class="memItemRight" valign="bottom"><b>extractPose</b> ()</td></tr>
<tr class="memdesc:af4065bbc264b5b4263a927a4f63116c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the "pose" (3D atom-position data) of the <a class="el" href="classMolecule.html">Molecule</a> object. <br /></td></tr>
<tr class="separator:af4065bbc264b5b4263a927a4f63116c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a6b70c9d0397e77a4d7305b9dce395887"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a6b70c9d0397e77a4d7305b9dce395887">squareDistance</a> (std::vector&lt; double &gt; plane)</td></tr>
<tr class="memdesc:a6b70c9d0397e77a4d7305b9dce395887"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the sum of squares distances of each atom (including hydrogen atoms) of this molecule to a given plane.  <a href="classMolecule.html#a6b70c9d0397e77a4d7305b9dce395887">More...</a><br /></td></tr>
<tr class="separator:a6b70c9d0397e77a4d7305b9dce395887"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4b492f2099e1c59c6c4f19818f1394c"><td class="memItemLeft" align="right" valign="top"><a id="ac4b492f2099e1c59c6c4f19818f1394c" name="ac4b492f2099e1c59c6c4f19818f1394c"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><b>normalizedVectorDifference</b> (const std::vector&lt; int &gt; &amp;hash1, const std::vector&lt; int &gt; &amp;hash2, int s1, int s2, double base=0.8)</td></tr>
<tr class="memdesc:ac4b492f2099e1c59c6c4f19818f1394c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Match to vectors and calculate some kind of a "distance" to score the similarity in (0,1) - under development. <br /></td></tr>
<tr class="separator:ac4b492f2099e1c59c6c4f19818f1394c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ab9512050a395e0ebb8fbba92f0a91222"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#ab9512050a395e0ebb8fbba92f0a91222">HC</a> =0</td></tr>
<tr class="separator:ab9512050a395e0ebb8fbba92f0a91222"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e459e9ae52f281073d4821b9af72b60"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a3e459e9ae52f281073d4821b9af72b60">type</a> =0</td></tr>
<tr class="separator:a3e459e9ae52f281073d4821b9af72b60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87674f540b98a33b4921c4d57b3982fc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a87674f540b98a33b4921c4d57b3982fc">ID</a> =-1</td></tr>
<tr class="separator:a87674f540b98a33b4921c4d57b3982fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf710157d0a2da0d5d7bab8d658c39be"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#acf710157d0a2da0d5d7bab8d658c39be">trialmode</a> =false</td></tr>
<tr class="separator:acf710157d0a2da0d5d7bab8d658c39be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adebb2c740099c5db4f14137bb1609877"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#adebb2c740099c5db4f14137bb1609877">myBE</a> =0</td></tr>
<tr class="separator:adebb2c740099c5db4f14137bb1609877"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6647358091d946bb02dbcf3ce35b7d5e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a6647358091d946bb02dbcf3ce35b7d5e">myHBE</a> =0</td></tr>
<tr class="separator:a6647358091d946bb02dbcf3ce35b7d5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b1f799908a9d52d7194d07ac6bb28d3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a6b1f799908a9d52d7194d07ac6bb28d3">errBE</a> =0</td></tr>
<tr class="separator:a6b1f799908a9d52d7194d07ac6bb28d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32075500340345439d0d4912e26fb44f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a32075500340345439d0d4912e26fb44f">errHBE</a> =0</td></tr>
<tr class="separator:a32075500340345439d0d4912e26fb44f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf3e45c79a7ae3fbb0fc174544debc1e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#abf3e45c79a7ae3fbb0fc174544debc1e">pE</a> =0</td></tr>
<tr class="separator:abf3e45c79a7ae3fbb0fc174544debc1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a7e7d290ae641518ad4c4d5303b519d0f"><td class="memItemLeft" align="right" valign="top"><a id="a7e7d290ae641518ad4c4d5303b519d0f" name="a7e7d290ae641518ad4c4d5303b519d0f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Molecule</b> ()</td></tr>
<tr class="memdesc:a7e7d290ae641518ad4c4d5303b519d0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The blank <a class="el" href="classMolecule.html">Molecule</a> constructor. It just creates a ghost molecule object with no atom data. <br /></td></tr>
<tr class="separator:a7e7d290ae641518ad4c4d5303b519d0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38c89b2e6d4e911cfdf9ac6ea3306a1c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a38c89b2e6d4e911cfdf9ac6ea3306a1c">addBE</a> (double x)</td></tr>
<tr class="memdesc:a38c89b2e6d4e911cfdf9ac6ea3306a1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">a wrapper to add some amount to the binding energy stored in this <a class="el" href="classMolecule.html">Molecule</a>.  <a href="classMolecule.html#a38c89b2e6d4e911cfdf9ac6ea3306a1c">More...</a><br /></td></tr>
<tr class="separator:a38c89b2e6d4e911cfdf9ac6ea3306a1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d42407d83a7ca200fe738b67a3c38cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a2d42407d83a7ca200fe738b67a3c38cb">addHBE</a> (double x)</td></tr>
<tr class="memdesc:a2d42407d83a7ca200fe738b67a3c38cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">a wrapper to add some amount to the binding energy (contributed by the "hotspot") stored in this <a class="el" href="classMolecule.html">Molecule</a>.  <a href="classMolecule.html#a2d42407d83a7ca200fe738b67a3c38cb">More...</a><br /></td></tr>
<tr class="separator:a2d42407d83a7ca200fe738b67a3c38cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a13f21a69f0d90e36bffdc2236e75fff3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMolecule.html">Molecule</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMolecule.html#a13f21a69f0d90e36bffdc2236e75fff3">merge</a> (const <a class="el" href="classMolecule.html">Molecule</a> *m1, const <a class="el" href="classMolecule.html">Molecule</a> *m2)</td></tr>
<tr class="separator:a13f21a69f0d90e36bffdc2236e75fff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >The class is the backbone of the DeNovo program. It contains all information about the molecule and all generation methods are included here. As a lot of methods in the class deal with energy, it is useful to mention that the unit of energy used in DeNovo is (kJ/mol)<br  />
 <b>Atoms</b><br  />
 This class holds an array (technically a 'std::vector') of Atom* (pointers to an <a class="el" href="classAtom.html">Atom</a> object). This storage method automatically indexes every atom by an integer.<br  />
 When loaded from a file (PDB, GRO, or TXT), the sequence of indexing for the atoms matches the order in which they were found in the file. When manually constructed, the order is same as the order in which each atom was added. If two molecules are "merged" (see <a class="el" href="classMolecule.html#a13f21a69f0d90e36bffdc2236e75fff3">merge(const Molecule*,const Molecule*)</a>), the lists are concatenated in the same order as the parameters<br  />
 <b>Bonds and adjacency lists</b><br  />
 The molecule is stored in a tree format, using an adjacency list to store bonding data. Bonds are stored as vectors of integer vectors (to represent the matrix).<br  />
 Each element (number) of an integer vector refers to the index of an <a class="el" href="classAtom.html">Atom</a> in the <a class="el" href="classMolecule.html">Molecule</a>. Such vectors are compiled in another vector and indexed by the source atom (the atom which is bonded to all atoms referred to by this list)<br  />
 A sample adjacency list (for benzene):<br  />
 </p><div class="fragment"><div class="line"><a class="code hl_class" href="classAtom.html">Atom</a>-name, Index,  corresponding adjacency vector</div>
<div class="line"> </div>
<div class="line">CA,    0,  {1,5,6}</div>
<div class="line">CA,    1,  {0,2,7}</div>
<div class="line">CA,    2,  {1,3,8}</div>
<div class="line">CA,    3,  {2,4,9}</div>
<div class="line">CA,    4,  {3,5,10}</div>
<div class="line">CA,    5,  {4,0,11}</div>
<div class="line">HA,    6,  {0}</div>
<div class="line">HA,    7,  {1}</div>
<div class="line">HA,    8,  {2}</div>
<div class="line">HA,    9,  {3}</div>
<div class="line">HA,    10, {4}</div>
<div class="line">HA,    11, {5}</div>
<div class="ttc" id="aclassAtom_html"><div class="ttname"><a href="classAtom.html">Atom</a></div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00039">Atom.hpp:40</a></div></div>
</div><!-- fragment --><p> <br  />
 Bond orders are not stored. They usually can be determined from atom-type valencies (and sometimes with the help of hybridization)<br  />
</p>
<p >This class makes use of the Eigen libraries. See Eigen: <a href="http://eigen.tuxfamily.org/">http://eigen.tuxfamily.org/</a> for more details. (git repo: <a href="https://gitlab.com/libeigen/eigen.git">https://gitlab.com/libeigen/eigen.git</a>)</p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00477">477</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa08b915718a7851b753c0cd9acb026f8" name="aa08b915718a7851b753c0cd9acb026f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa08b915718a7851b753c0cd9acb026f8">&#9670;&nbsp;</a></span>Molecule() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Molecule::Molecule </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classAtom.html">Atom</a> * &gt;&#160;</td>
          <td class="paramname"><em>ats</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a molecule by just collecting atoms. </p>
<p >Useful to perform rigid-molecule operations that do not involve bonding. For problems that require bond-data, see <a class="el" href="classMolecule.html#ab5dd0fff02c29ca0e4209822857cf66f" title="Load a molecule from a set of atoms and some connections.">Molecule::Molecule(std::vector&lt;Atom*&gt;,std::vector&lt;std::vector&lt;int&gt;&gt;)</a> </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l02703">2703</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l02703" name="l02703"></a><span class="lineno"> 2703</span>                                       : <a class="code hl_function" href="classMolecule.html#a7e7d290ae641518ad4c4d5303b519d0f">Molecule</a>() {</div>
<div class="line"><a id="l02704" name="l02704"></a><span class="lineno"> 2704</span>    atoms=std::vector&lt;Atom*&gt;();</div>
<div class="line"><a id="l02705" name="l02705"></a><span class="lineno"> 2705</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : ats) atoms.push_back(<span class="keyword">new</span> <a class="code hl_class" href="classAtom.html">Atom</a>(*a));</div>
<div class="line"><a id="l02706" name="l02706"></a><span class="lineno"> 2706</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;ats.size();i++) bonds.push_back(std::vector&lt;int&gt;());</div>
<div class="line"><a id="l02707" name="l02707"></a><span class="lineno"> 2707</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : atoms)</div>
<div class="line"><a id="l02708" name="l02708"></a><span class="lineno"> 2708</span>    {</div>
<div class="line"><a id="l02709" name="l02709"></a><span class="lineno"> 2709</span>        <span class="keywordflow">if</span>(a-&gt;isHydrogen()) <a class="code hl_variable" href="classMolecule.html#ab9512050a395e0ebb8fbba92f0a91222">HC</a>++;</div>
<div class="line"><a id="l02710" name="l02710"></a><span class="lineno"> 2710</span>        <span class="keywordflow">if</span>(VARIEDCOUNT &amp;&amp; VCLIST-&gt;<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(a)) HAC++;</div>
<div class="line"><a id="l02711" name="l02711"></a><span class="lineno"> 2711</span>    }</div>
<div class="line"><a id="l02712" name="l02712"></a><span class="lineno"> 2712</span>}</div>
<div class="ttc" id="aclassCategory_html_a3ffa41a593852318c167862171166f1b"><div class="ttname"><a href="classCategory.html#a3ffa41a593852318c167862171166f1b">Category::contains</a></div><div class="ttdeci">bool contains(const Atom *a) const</div><div class="ttdoc">Checks whether a particular atom type is grouped under this Category.</div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00305">forcefield.hpp:305</a></div></div>
<div class="ttc" id="aclassMolecule_html_a7e7d290ae641518ad4c4d5303b519d0f"><div class="ttname"><a href="classMolecule.html#a7e7d290ae641518ad4c4d5303b519d0f">Molecule::Molecule</a></div><div class="ttdeci">Molecule()</div><div class="ttdoc">The blank Molecule constructor. It just creates a ghost molecule object with no atom data.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00519">Molecule.hpp:519</a></div></div>
<div class="ttc" id="aclassMolecule_html_ab9512050a395e0ebb8fbba92f0a91222"><div class="ttname"><a href="classMolecule.html#ab9512050a395e0ebb8fbba92f0a91222">Molecule::HC</a></div><div class="ttdeci">int HC</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00487">Molecule.hpp:487</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a21ee086bf224ec95f24aae555e94b5b9" name="a21ee086bf224ec95f24aae555e94b5b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21ee086bf224ec95f24aae555e94b5b9">&#9670;&nbsp;</a></span>Molecule() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Molecule::Molecule </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMolecule.html">Molecule</a> *&#160;</td>
          <td class="paramname"><em>o</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The <a class="el" href="classMolecule.html">Molecule</a> class copy constructor. </p>
<p >This constructor is the proper way to clone a <a class="el" href="classMolecule.html">Molecule</a> object. <br  />
Unless explicitly mentioned in the documentation of a specific method <b>DO NOT</b> dereference a Molecule* before using it. It may lead to memory corruption and undefined behaviour.<br  />
 Sample usage: </p><div class="fragment"><div class="line"><a class="code hl_class" href="classMolecule.html">Molecule</a>* srcMolecule; <span class="comment">//Molecule to be copied</span></div>
<div class="line"><a class="code hl_class" href="classMolecule.html">Molecule</a>* clonedMolecule = <span class="keyword">new</span> <a class="code hl_function" href="classMolecule.html#a7e7d290ae641518ad4c4d5303b519d0f">Molecule</a>(srcMolecule)</div>
<div class="ttc" id="aclassMolecule_html"><div class="ttname"><a href="classMolecule.html">Molecule</a></div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00477">Molecule.hpp:478</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l02735">2735</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l02735" name="l02735"></a><span class="lineno"> 2735</span>                                    : <a class="code hl_function" href="classMolecule.html#a7e7d290ae641518ad4c4d5303b519d0f">Molecule</a>()</div>
<div class="line"><a id="l02736" name="l02736"></a><span class="lineno"> 2736</span>{</div>
<div class="line"><a id="l02737" name="l02737"></a><span class="lineno"> 2737</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;o-&gt;<a class="code hl_function" href="classMolecule.html#a6946cbe0d8daa9b2386d85ca7faf0cd1">getSize</a>();i++) atoms.push_back(<span class="keyword">new</span> <a class="code hl_class" href="classAtom.html">Atom</a>(*(o-&gt;atoms[i])));</div>
<div class="line"><a id="l02738" name="l02738"></a><span class="lineno"> 2738</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : atoms) {<span class="keywordflow">if</span>(a-&gt;seek_valency()) freeatoms.push_back(a);}</div>
<div class="line"><a id="l02739" name="l02739"></a><span class="lineno"> 2739</span>    bonds=o-&gt;bonds;</div>
<div class="line"><a id="l02740" name="l02740"></a><span class="lineno"> 2740</span>    <a class="code hl_variable" href="classMolecule.html#a3e459e9ae52f281073d4821b9af72b60">type</a>=o-&gt;<a class="code hl_variable" href="classMolecule.html#a3e459e9ae52f281073d4821b9af72b60">type</a>;</div>
<div class="line"><a id="l02741" name="l02741"></a><span class="lineno"> 2741</span>    <a class="code hl_variable" href="classMolecule.html#adebb2c740099c5db4f14137bb1609877">myBE</a>=o-&gt;<a class="code hl_variable" href="classMolecule.html#adebb2c740099c5db4f14137bb1609877">myBE</a>;</div>
<div class="line"><a id="l02742" name="l02742"></a><span class="lineno"> 2742</span>    <a class="code hl_variable" href="classMolecule.html#a6647358091d946bb02dbcf3ce35b7d5e">myHBE</a>=o-&gt;<a class="code hl_variable" href="classMolecule.html#a6647358091d946bb02dbcf3ce35b7d5e">myHBE</a>;</div>
<div class="line"><a id="l02743" name="l02743"></a><span class="lineno"> 2743</span>    <a class="code hl_variable" href="classMolecule.html#ab9512050a395e0ebb8fbba92f0a91222">HC</a>=o-&gt;<a class="code hl_variable" href="classMolecule.html#ab9512050a395e0ebb8fbba92f0a91222">HC</a>;</div>
<div class="line"><a id="l02744" name="l02744"></a><span class="lineno"> 2744</span>    <span class="keywordflow">if</span>(VARIEDCOUNT) HAC=o-&gt;HAC;</div>
<div class="line"><a id="l02745" name="l02745"></a><span class="lineno"> 2745</span>}</div>
<div class="ttc" id="aclassMolecule_html_a3e459e9ae52f281073d4821b9af72b60"><div class="ttname"><a href="classMolecule.html#a3e459e9ae52f281073d4821b9af72b60">Molecule::type</a></div><div class="ttdeci">int type</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00501">Molecule.hpp:501</a></div></div>
<div class="ttc" id="aclassMolecule_html_a6647358091d946bb02dbcf3ce35b7d5e"><div class="ttname"><a href="classMolecule.html#a6647358091d946bb02dbcf3ce35b7d5e">Molecule::myHBE</a></div><div class="ttdeci">double myHBE</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00505">Molecule.hpp:505</a></div></div>
<div class="ttc" id="aclassMolecule_html_a6946cbe0d8daa9b2386d85ca7faf0cd1"><div class="ttname"><a href="classMolecule.html#a6946cbe0d8daa9b2386d85ca7faf0cd1">Molecule::getSize</a></div><div class="ttdeci">int getSize() const</div><div class="ttdoc">Get the total number of atoms (including hydrogen atoms) in this Molecule.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00571">Molecule.hpp:571</a></div></div>
<div class="ttc" id="aclassMolecule_html_adebb2c740099c5db4f14137bb1609877"><div class="ttname"><a href="classMolecule.html#adebb2c740099c5db4f14137bb1609877">Molecule::myBE</a></div><div class="ttdeci">double myBE</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00504">Molecule.hpp:504</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a041d96213e53bd501f94b46cc36d74f6" name="a041d96213e53bd501f94b46cc36d74f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a041d96213e53bd501f94b46cc36d74f6">&#9670;&nbsp;</a></span>Molecule() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Molecule::Molecule </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>eval</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cpt</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> *&#160;</td>
          <td class="paramname"><em>ff</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a molecule from TXT format (see algorithm PDF for details on TXT format) </p>
<p >This is the <a class="el" href="classMolecule.html">Molecule</a> class constructor that can load molecules from TXT format file. Recent DeNovo versions support PDB and GRO formats, however, this method is kept for backward support <br  />
 From DeNovo \omega onwards, it is used to load checkpoints. You can supply an open input file stream.<br  />
See Also: <a class="el" href="classMolecule.html#a7e7d290ae641518ad4c4d5303b519d0f" title="The blank Molecule constructor. It just creates a ghost molecule object with no atom data.">Molecule::Molecule</a>(const char *file,bool eval=false) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>Input stream from which to load </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eval</td><td>Evaluate bonds? (Default: no) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cpt</td><td>Is a checkpoint file? (Default: no). If yes, it will expect n more lines with bonding data. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l02755">2755</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l02755" name="l02755"></a><span class="lineno"> 2755</span>: <a class="code hl_function" href="classMolecule.html#a7e7d290ae641518ad4c4d5303b519d0f">Molecule</a>() {<a class="code hl_function" href="classMolecule.html#a8cdf18b0095a344a34d5ffe80be73d98">loadMoleculeFromTXT</a>(f,eval,cpt,ff);}</div>
<div class="ttc" id="aclassMolecule_html_a8cdf18b0095a344a34d5ffe80be73d98"><div class="ttname"><a href="classMolecule.html#a8cdf18b0095a344a34d5ffe80be73d98">Molecule::loadMoleculeFromTXT</a></div><div class="ttdeci">void loadMoleculeFromTXT(std::istream &amp;f, bool eval=false, bool cpt=false, const ForceField *ff=nullptr)</div><div class="ttdoc">Actual function called in the TXT file loading constructor. See: Molecule::Molecule(std::istream&amp;,...</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l02756">Molecule.hpp:2756</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abd5df1c615fa93e4c0ce80e6a9dcd900" name="abd5df1c615fa93e4c0ce80e6a9dcd900"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd5df1c615fa93e4c0ce80e6a9dcd900">&#9670;&nbsp;</a></span>Molecule() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Molecule::Molecule </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>eval</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a molecule from TXT format (see algorithm PDF for details on TXT format) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">file</td><td>Name of the file from which to load </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eval</td><td>Evaluate bonds? (Default: no) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l02747">2747</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l02748" name="l02748"></a><span class="lineno"> 2748</span>{</div>
<div class="line"><a id="l02749" name="l02749"></a><span class="lineno"> 2749</span>    ifstream f;</div>
<div class="line"><a id="l02750" name="l02750"></a><span class="lineno"> 2750</span>    f.open(file,ios::in);<span class="comment">//opening file containing the data set</span></div>
<div class="line"><a id="l02751" name="l02751"></a><span class="lineno"> 2751</span>    <span class="keywordflow">if</span>(!f) {cout &lt;&lt; <span class="stringliteral">&quot;Requested file: &quot;</span>&lt;&lt;file&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>; <span class="keywordflow">throw</span> <a class="code hl_class" href="classUnableToOpenFileException.html">UnableToOpenFileException</a>();}</div>
<div class="line"><a id="l02752" name="l02752"></a><span class="lineno"> 2752</span>    <a class="code hl_function" href="classMolecule.html#a8cdf18b0095a344a34d5ffe80be73d98">loadMoleculeFromTXT</a>(f,eval,<span class="keyword">false</span>);</div>
<div class="line"><a id="l02753" name="l02753"></a><span class="lineno"> 2753</span>    f.close();<span class="comment">//file closed</span></div>
<div class="line"><a id="l02754" name="l02754"></a><span class="lineno"> 2754</span>}</div>
<div class="ttc" id="aclassUnableToOpenFileException_html"><div class="ttname"><a href="classUnableToOpenFileException.html">UnableToOpenFileException</a></div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00053">Molecule.hpp:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a834ac3e93af40e0f03bf1bb83c1ccb3e" name="a834ac3e93af40e0f03bf1bb83c1ccb3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a834ac3e93af40e0f03bf1bb83c1ccb3e">&#9670;&nbsp;</a></span>Molecule() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Molecule::Molecule </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>infile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> &amp;&#160;</td>
          <td class="paramname"><em>ff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>format</em> = <code>&quot;pdb&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>eval</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>warnf</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>chain</em> = <code>'A'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load <a class="el" href="classMolecule.html">Molecule</a> from a standard format (PDB or GRO) </p>
<p >This is the constructor used for constructing a <a class="el" href="classMolecule.html">Molecule</a> from a standard format file.<br  />
. It requires a force-field (See <a class="el" href="classForceField.html">ForceField</a>) with atom names defined (to match that from the input file) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">infile</td><td>The input file (PDB or GRO) format </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">format</td><td>Specify the input format. Currently "pdb" and "gro" are supported. If nothing is specified, it is taken to be "pdb" </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ff</td><td>The <a class="el" href="classForceField.html">ForceField</a> object which has the atom-types referred to in this file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eval</td><td>Evaluate bonds? If set to "true", it checks for bonds (using vanderwaal radii as criteria.<br  />
For macromolecules, when loading from a PDB, as only non-bonding interactions matter, it is not necessary to calculate bonds.<br  />
 Only when loading small molecule, this is usually needed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">warnf</td><td>: If set to true, warning (if any) will be printed during the loading. If not, most (weak) warnings will be omitted (Default: off) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chain</td><td>You can specify the chain in this (if loading a multi-chain protein). By default it is taken to be 'A'. Note: You must load multiple chains from different files with different Chain IDs </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l02833">2833</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l02834" name="l02834"></a><span class="lineno"> 2834</span>{</div>
<div class="line"><a id="l02835" name="l02835"></a><span class="lineno"> 2835</span>    ifstream inf; inf.open(infile,ios::in);</div>
<div class="line"><a id="l02836" name="l02836"></a><span class="lineno"> 2836</span>    <span class="keywordflow">if</span>(!inf) {cout &lt;&lt; <span class="stringliteral">&quot;Requested file: &quot;</span>&lt;&lt;infile&lt;&lt;<span class="stringliteral">&quot; was not found/could not be opened for reading\n&quot;</span>; <span class="keywordflow">throw</span> <a class="code hl_class" href="classFileNotFoundException.html">FileNotFoundException</a>();}</div>
<div class="line"><a id="l02837" name="l02837"></a><span class="lineno"> 2837</span>    loadFromInputStream(inf,ff,format,eval,warnf,chain);</div>
<div class="line"><a id="l02838" name="l02838"></a><span class="lineno"> 2838</span>    inf.close();</div>
<div class="line"><a id="l02839" name="l02839"></a><span class="lineno"> 2839</span>}</div>
<div class="ttc" id="aclassFileNotFoundException_html"><div class="ttname"><a href="classFileNotFoundException.html">FileNotFoundException</a></div><div class="ttdef"><b>Definition:</b> <a href="commons_8h_source.html#l00019">commons.h:19</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aadf1f51e311a11e69385ff51602b86bc" name="aadf1f51e311a11e69385ff51602b86bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadf1f51e311a11e69385ff51602b86bc">&#9670;&nbsp;</a></span>addAtom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::addAtom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add a new atom to the <a class="el" href="classMolecule.html">Molecule</a>. </p>
<p >This method allows manually adding atoms to the <a class="el" href="classMolecule.html">Molecule</a> class.<br  />
 Unless specifically asked for, no calculations or validations are performed on this <a class="el" href="classAtom.html">Atom</a>. Also, until manual bonding definition (see addBond()) is given, the <a class="el" href="classAtom.html">Atom</a> is not bonded to any other in the molecule irrespective of its proximity to other atoms </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00637">637</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>{atoms.push_back(a); bonds.push_back(std::vector&lt;int&gt;()); a-&gt;setMolecule(<span class="keyword">this</span>);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a38c89b2e6d4e911cfdf9ac6ea3306a1c" name="a38c89b2e6d4e911cfdf9ac6ea3306a1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38c89b2e6d4e911cfdf9ac6ea3306a1c">&#9670;&nbsp;</a></span>addBE()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::addBE </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>a wrapper to add some amount to the binding energy stored in this <a class="el" href="classMolecule.html">Molecule</a>. </p>
<p >This method is used internally by the program to increment binding energy for every atom added during the growth phase.<br  />
Do not use this function from an external source. </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00628">628</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>{<a class="code hl_variable" href="classMolecule.html#adebb2c740099c5db4f14137bb1609877">myBE</a>+=x;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2d42407d83a7ca200fe738b67a3c38cb" name="a2d42407d83a7ca200fe738b67a3c38cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d42407d83a7ca200fe738b67a3c38cb">&#9670;&nbsp;</a></span>addHBE()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::addHBE </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>a wrapper to add some amount to the binding energy (contributed by the "hotspot") stored in this <a class="el" href="classMolecule.html">Molecule</a>. </p>
<p >This method is used internally by the program to increment binding energy for every atom added during the growth phase.<br  />
Do not use this function from an external source. </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00632">632</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>{<a class="code hl_variable" href="classMolecule.html#a6647358091d946bb02dbcf3ce35b7d5e">myHBE</a>+=x;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5eff5649ce64bbe64269a1b7e21016ed" name="a5eff5649ce64bbe64269a1b7e21016ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eff5649ce64bbe64269a1b7e21016ed">&#9670;&nbsp;</a></span>bestPlaneOfFit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; Molecule::bestPlaneOfFit </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>err</em> = <code>1e-5</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the bast plane of fit to this molecule - experimental. </p>
<p >This function uses Gradient Descent Fitting to fit a plane equation to this molecule. It assigns the global "currmol" to "this" molecule.<br  />
See also: <a class="el" href="classMolecule.html#a6b70c9d0397e77a4d7305b9dce395887" title="Get the sum of squares distances of each atom (including hydrogen atoms) of this molecule to a given ...">squareDistance()</a>. It calculates the square distance from the plane (which is the target function to be minimized by gradient descent) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">err</td><td>The tolerance limit for convergence of gradient descent </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The coeffients of a plane in vector form (a,b,c,d) which corresponds to the plane "&lt;b&gt;a&lt;/b&gt;x +&lt;b&gt;b&lt;/b&gt;y +&lt;b&gt;c&lt;/b&gt;z = &lt;b&gt;d&lt;/b&gt;". (std::vector&lt;double&gt;) </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01818">1818</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span>{currMol=<span class="keyword">this</span>; <span class="keywordflow">return</span> quickmath::gradientDescentFit(<a class="code hl_function" href="classMolecule.html#a6b70c9d0397e77a4d7305b9dce395887">squareDistance</a>,4,err);}</div>
<div class="ttc" id="aclassMolecule_html_a6b70c9d0397e77a4d7305b9dce395887"><div class="ttname"><a href="classMolecule.html#a6b70c9d0397e77a4d7305b9dce395887">Molecule::squareDistance</a></div><div class="ttdeci">static double squareDistance(std::vector&lt; double &gt; plane)</div><div class="ttdoc">Get the sum of squares distances of each atom (including hydrogen atoms) of this molecule to a given ...</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01807">Molecule.hpp:1807</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aebc4ac8f4a68e24dbb0720402798ca4e" name="aebc4ac8f4a68e24dbb0720402798ca4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebc4ac8f4a68e24dbb0720402798ca4e">&#9670;&nbsp;</a></span>bondAtom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Molecule::bondAtom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>natm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add an atom to the molecule by bonding it to a pre-existing atom of the molecule. </p>
<p >This method is a short way to add an atom to a <a class="el" href="classMolecule.html">Molecule</a> when manually building a molecule. It adds the <a class="el" href="classAtom.html">Atom</a> to this <a class="el" href="classMolecule.html">Molecule</a> and then bonds it to the chosen atom (which must be in this molecule).<br  />
 It achieves both the steps in one function.(see <a class="el" href="classMolecule.html#aadf1f51e311a11e69385ff51602b86bc" title="Add a new atom to the Molecule.">addAtom(Atom*)</a> and <a class="el" href="classMolecule.html#a04b3beb3e333664d6421e9f0ee46dd73" title="Join two atoms to make a bond.">makeBond(Atom*,Atom*)</a>)<br  />
No checks are performed to see if the newly added atom already belongs to the molecule. The use must manually check this, or this may lead to memory corruption and/or infinite loops (see <a class="el" href="classMolecule.html#aa13276cae00e350b9b28c07cb82ebcec" title="Get the index value of an atom from it&#39;s pointer.">Molecule::indexOf(Atom*) const</a>). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">natm</td><td>The newly added atom (this must not belong to the molecule object when this method is called) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src</td><td>The source atom (to which this new atom is attached. This atom must be in the <a class="el" href="classMolecule.html">Molecule</a>. No checks are performed here either) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true/false (bool): If either atom (new or source) cannot bond due to lack of valences, no bond is formed and 'false' is returned. Otherwise the function exists with a return value 'true' </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01164">1164</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>    {</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>    <span class="comment">//Atom* nacpy=natm;</span></div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>        <span class="keywordflow">if</span>(!natm-&gt;<a class="code hl_function" href="classAtom.html#acd1d81d4d5011bd1cf6b53e6ec5830dd">canBond</a>() || !src-&gt;<a class="code hl_function" href="classAtom.html#acd1d81d4d5011bd1cf6b53e6ec5830dd">canBond</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>    <span class="keywordflow">if</span>(natm-&gt;<a class="code hl_function" href="classAtom.html#a99ed78f1b94d694b0f3fac609fd92934">isHydrogen</a>()) <a class="code hl_variable" href="classMolecule.html#ab9512050a395e0ebb8fbba92f0a91222">HC</a>++;</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>        <span class="keywordflow">if</span>(VARIEDCOUNT &amp;&amp; VCLIST-&gt;<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(natm)) HAC++;</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>        <span class="keywordtype">int</span> sI=<a class="code hl_function" href="classMolecule.html#aa13276cae00e350b9b28c07cb82ebcec">indexOf</a>(src);</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>        atoms.push_back(natm);</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>        bonds.push_back(std::vector&lt;int&gt;(1,sI));</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>        bonds[sI].push_back(atoms.size()-1);</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>        src-&gt;<a class="code hl_function" href="classAtom.html#a6d1ed6f7432ecc88bee6faa26294cd08">addBond</a>(); natm-&gt;<a class="code hl_function" href="classAtom.html#a6d1ed6f7432ecc88bee6faa26294cd08">addBond</a>();</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>        <span class="keywordflow">if</span>(natm-&gt;<a class="code hl_function" href="classAtom.html#acd1d81d4d5011bd1cf6b53e6ec5830dd">canBond</a>()) freeatoms.push_back(natm);</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>        <span class="keywordflow">if</span>(!src-&gt;<a class="code hl_function" href="classAtom.html#acd1d81d4d5011bd1cf6b53e6ec5830dd">canBond</a>()) freeatoms.erase(std::remove(freeatoms.begin(), freeatoms.end(), src), freeatoms.end());</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>    }</div>
<div class="ttc" id="aclassAtom_html_a6d1ed6f7432ecc88bee6faa26294cd08"><div class="ttname"><a href="classAtom.html#a6d1ed6f7432ecc88bee6faa26294cd08">Atom::addBond</a></div><div class="ttdeci">void addBond()</div><div class="ttdoc">A simple wrapper to reduce the valency by 1.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00157">Atom.hpp:157</a></div></div>
<div class="ttc" id="aclassAtom_html_a99ed78f1b94d694b0f3fac609fd92934"><div class="ttname"><a href="classAtom.html#a99ed78f1b94d694b0f3fac609fd92934">Atom::isHydrogen</a></div><div class="ttdeci">bool isHydrogen() const</div><div class="ttdoc">Tests if this atom is a hydrogen atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00153">Atom.hpp:153</a></div></div>
<div class="ttc" id="aclassAtom_html_acd1d81d4d5011bd1cf6b53e6ec5830dd"><div class="ttname"><a href="classAtom.html#acd1d81d4d5011bd1cf6b53e6ec5830dd">Atom::canBond</a></div><div class="ttdeci">bool canBond()</div><div class="ttdoc">Checks if this atom can make further bonds.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00160">Atom.hpp:160</a></div></div>
<div class="ttc" id="aclassMolecule_html_aa13276cae00e350b9b28c07cb82ebcec"><div class="ttname"><a href="classMolecule.html#aa13276cae00e350b9b28c07cb82ebcec">Molecule::indexOf</a></div><div class="ttdeci">int indexOf(Atom *p) const</div><div class="ttdoc">Get the index value of an atom from it's pointer.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00610">Molecule.hpp:610</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab64af9956394c7077c0ebf2db64b9cdf" name="ab64af9956394c7077c0ebf2db64b9cdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab64af9956394c7077c0ebf2db64b9cdf">&#9670;&nbsp;</a></span>calculateBondOrders()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::calculateBondOrders </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classForceField.html">ForceField</a> &amp;&#160;</td>
          <td class="paramname"><em>ff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>assume_complete</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>assign_valence</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate bond orders for the bonds of this molecules (experimental) </p>
<p >This method parses the adjacency list and uses the atom type definition data (such as hybridization and maximium valency) to judge the orders of various bonds.<br  />
Calling this method is a prerequisite for getSMILES() </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ff</td><td>The <a class="el" href="classForceField.html">ForceField</a> used to get hybridization data and valencies for estimating bond-orders. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">assume_complete</td><td>This parameter (if set to "true" assumes all valencies of the <a class="el" href="classMolecule.html">Molecule</a> to be satisfied. It is useful to use this option when working with external (non CHARMM-27) valency satisfied molecules using an "empty forcefield".<br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">assign_valence</td><td>This parameter (by default: off), if switched on, recalculates the free valencies for the atoms of this <a class="el" href="classMolecule.html">Molecule</a>. It is useful when using the "empty" force-field on an external molecule See Also: Force-Field (not the class) in PDF </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00646">646</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>    {</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>        <span class="keywordflow">if</span>(!ff.<a class="code hl_function" href="classForceField.html#ab5bfc00e94bac57310cc3a4778e11342">hasCategory</a>(<span class="stringliteral">&quot;aromatic&quot;</span>)) <span class="keywordflow">throw</span> <a class="code hl_class" href="classNoAromaticCategoryException.html">NoAromaticCategoryException</a>();</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>        <span class="keyword">const</span> <a class="code hl_class" href="classCategory.html">Category</a>&amp; aromcat=ff.<a class="code hl_function" href="classForceField.html#a5a30c5a7760b5c791c5b34f9bd133506">getCategory</a>(<span class="stringliteral">&quot;aromatic&quot;</span>);</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>        orders=std::vector&lt;std::vector&lt;unsigned short int&gt;&gt;();</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>        std::vector&lt;int&gt; exB;</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>        <span class="keywordtype">bool</span> rep=<span class="keyword">false</span>;</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++) {std::vector&lt;unsigned short int&gt; aord; <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;bonds[i].size();j++) aord.push_back(0); orders.push_back(aord); exB.push_back(0);}</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++)</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>        {</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>            std::vector&lt;Atom*&gt; a1bonds=this-&gt;<a class="code hl_function" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a>(atoms[i]);</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;a1bonds.size();j++)</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>            {</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>                <span class="keywordflow">if</span>(orders[i][j]!=0 &amp;&amp; !rep) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>                <a class="code hl_class" href="classAtom.html">Atom</a>* ca=a1bonds[j];</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>                <span class="keywordtype">int</span> ind=<a class="code hl_function" href="classMolecule.html#aa13276cae00e350b9b28c07cb82ebcec">indexOf</a>(ca);</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>                std::vector&lt;Atom*&gt; a2bonds=this-&gt;<a class="code hl_function" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a>(ca);</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>                <span class="keywordtype">int</span> ord=1;</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>                <span class="keywordflow">if</span>(assume_complete)</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>                {</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>                    ord=(min(1-exB[i]+(ff.<a class="code hl_function" href="classForceField.html#a71608edab6564b721aa4b77739a82fc4">getDefaultConnectivity</a>(atoms[i])-a1bonds.size()),1-exB[ind]+(ff.<a class="code hl_function" href="classForceField.html#a71608edab6564b721aa4b77739a82fc4">getDefaultConnectivity</a>(ca)-a2bonds.size())));</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>                    exB[i]+=(ord-1);</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>                    exB[ind]+=(ord-1);</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>                }</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>                {</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>                    <span class="keywordtype">int</span> exv1,exv2;</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>                    <span class="keywordflow">switch</span>(atoms[i]-&gt;toString()[0])</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>                    {</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>                        <span class="keywordflow">case</span> <span class="charliteral">&#39;P&#39;</span>:</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>                            exv1=1;</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>                        <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>:</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>                            exv1=2;</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>                        <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>                            exv1=0;</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>                    }</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>                    <span class="keywordflow">switch</span>(ca-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>()[0])</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>                    {</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>                        <span class="keywordflow">case</span> <span class="charliteral">&#39;P&#39;</span>:</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>                            exv2=1;</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>                        <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>:</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>                            exv2=2;</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>                        <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>                            exv2=0;</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>                    }</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>                    <span class="comment">//int exv1=(atoms[i]-&gt;toString()[0]==&#39;S&#39; || atoms[i]-&gt;toString()[0]==&#39;P&#39;)?1:0,exv2=(ca-&gt;toString()[0]==&#39;S&#39; || ca-&gt;toString()[0]==&#39;P&#39;)?1:0;</span></div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>                    cout &lt;&lt; atoms[i]-&gt;toString() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>&lt;&lt;atoms[ind]-&gt;toString() &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; (1+(3-atoms[i]-&gt;getHybridization())+exv1)&lt;&lt;<span class="stringliteral">&quot;(&quot;</span>&lt;&lt;(-exB[i])&lt;&lt;<span class="stringliteral">&quot;)&quot;</span> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; (1+(3-ca-&gt;<a class="code hl_function" href="classAtom.html#a3082999bd6c416335c36e02db4dd72a0">getHybridization</a>())+exv2)&lt;&lt;<span class="stringliteral">&quot;(&quot;</span>&lt;&lt;(-exB[ind])&lt;&lt;<span class="stringliteral">&quot;)&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>                    ord=min(1+(3-atoms[i]-&gt;getHybridization())+exv1-exB[i],1+(3-ca-&gt;<a class="code hl_function" href="classAtom.html#a3082999bd6c416335c36e02db4dd72a0">getHybridization</a>())+exv2-exB[ind]);</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>                    <span class="keywordflow">if</span>(!atoms[i]-&gt;getHybridization() || !atoms[ind]-&gt;getHybridization() || (aromcat.<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(atoms[i]) &amp;&amp; atoms[ind]-&gt;getStandardValency()&gt;1) || (aromcat.<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(atoms[ind]) &amp;&amp; atoms[i]-&gt;getStandardValency()&gt;1)) ord=1;</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>                    <span class="comment">//if(atoms[i]-&gt;getStandardValency()&lt;ord || ca-&gt;getStandardValency()&lt;ord) ord=min(atoms[i]-&gt;getStandardValency(),ca-&gt;getStandardValency());</span></div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>                    exB[i]+=(ord-1);</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>                    exB[ind]+=(ord-1);</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>                }</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>                orders[i][j]=ord;</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;a2bonds.size();k++) {<span class="keywordflow">if</span>(a2bonds[k]==atoms[i]) orders[ind][k]=ord;}</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>            }</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>            <span class="keywordflow">if</span>(rep) rep=<span class="keyword">false</span>;</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>            {</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>                <span class="keywordflow">if</span>(atoms[i]-&gt;getStandardValency()==1 || atoms[i]-&gt;getHybridization()==3 || aromcat.<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(atoms[i])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>                <span class="keywordtype">int</span> s=0;</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>                <span class="comment">/*if(atoms[i]-&gt;toString()[0]==&#39;N&#39;) s++;</span></div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span><span class="comment">                else if(atoms[i]-&gt;toString()[0]==&#39;N&#39;) s+=2;*/</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t=0;t&lt;orders[i].size();t++) s+=orders[i][t];</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>                cout &lt;&lt; atoms[i]-&gt;toString() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span>&lt;&lt; s &lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt; ff.<a class="code hl_function" href="classForceField.html#a71608edab6564b721aa4b77739a82fc4">getDefaultConnectivity</a>(atoms[i]) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>                <span class="keywordflow">if</span>(s&lt;ff.<a class="code hl_function" href="classForceField.html#a71608edab6564b721aa4b77739a82fc4">getDefaultConnectivity</a>(atoms[i]))</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>                {</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>                    rep=<span class="keyword">true</span>;</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;a1bonds.size();j++)</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>                    {</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>                        <span class="keywordtype">int</span> ind=<a class="code hl_function" href="classMolecule.html#aa13276cae00e350b9b28c07cb82ebcec">indexOf</a>(a1bonds[j]);</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>                        exB[ind]=0;</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> t=0;t&lt;orders[ind].size();t++)</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>                        {</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>                            orders[ind][t]=1;</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>                            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> u=0;u&lt;orders[bonds[ind][t]].size();u++) <span class="keywordflow">if</span>(bonds[bonds[ind][t]][u]==ind) {orders[bonds[ind][t]][u]=1; <span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>                        }</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>                    }</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>                    i--;</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>                }</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>            }</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>        }</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>        <span class="keywordflow">if</span>(assign_valence)</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>        {</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>            <span class="keywordtype">int</span> s=0;</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;orders.size();i++)</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>            {</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>                s=0;</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;orders[i].size();j++) s+=orders[i][j];</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>                <span class="comment">//cout &lt;&lt; atoms[i]-&gt;toString() &lt;&lt; &quot;\t&quot;&lt;&lt;(s-(int)orders[i].size())&lt;&lt;&quot; &quot;&lt;&lt;atoms[i]-&gt;seek_valency()&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>                atoms[i]-&gt;setValency(ff.<a class="code hl_function" href="classForceField.html#a71608edab6564b721aa4b77739a82fc4">getDefaultConnectivity</a>(atoms[i])-s);</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>            }</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>            <a class="code hl_function" href="classMolecule.html#a588965bd448a1cb43f25aed3179ecf96">calculateFreeAtoms</a>();</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>        }</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>    }</div>
<div class="ttc" id="aclassAtom_html_a189def3b8bade8507d49cfd7de881178"><div class="ttname"><a href="classAtom.html#a189def3b8bade8507d49cfd7de881178">Atom::toString</a></div><div class="ttdeci">const std::string &amp; toString() const</div><div class="ttdoc">Gives the atom name for this atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00110">Atom.hpp:110</a></div></div>
<div class="ttc" id="aclassAtom_html_a3082999bd6c416335c36e02db4dd72a0"><div class="ttname"><a href="classAtom.html#a3082999bd6c416335c36e02db4dd72a0">Atom::getHybridization</a></div><div class="ttdeci">int getHybridization() const</div><div class="ttdoc">Get the force-field (or otherwise loaded) hybridization of this atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00155">Atom.hpp:155</a></div></div>
<div class="ttc" id="aclassCategory_html"><div class="ttname"><a href="classCategory.html">Category</a></div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00284">forcefield.hpp:285</a></div></div>
<div class="ttc" id="aclassForceField_html_a5a30c5a7760b5c791c5b34f9bd133506"><div class="ttname"><a href="classForceField.html#a5a30c5a7760b5c791c5b34f9bd133506">ForceField::getCategory</a></div><div class="ttdeci">const Category &amp; getCategory(const std::string &amp;name) const</div><div class="ttdoc">Gets the chosen Category by name if present in the list loaded into this ForceField....</div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00507">forcefield.hpp:507</a></div></div>
<div class="ttc" id="aclassForceField_html_a71608edab6564b721aa4b77739a82fc4"><div class="ttname"><a href="classForceField.html#a71608edab6564b721aa4b77739a82fc4">ForceField::getDefaultConnectivity</a></div><div class="ttdeci">int getDefaultConnectivity(Atom *a)</div><div class="ttdoc">Get the defaualt connectivity (not from forcefield data) for a given element.</div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00386">forcefield.hpp:386</a></div></div>
<div class="ttc" id="aclassForceField_html_ab5bfc00e94bac57310cc3a4778e11342"><div class="ttname"><a href="classForceField.html#ab5bfc00e94bac57310cc3a4778e11342">ForceField::hasCategory</a></div><div class="ttdeci">bool hasCategory(const std::string &amp;name) const</div><div class="ttdoc">Checks if the given Category is present in the list loaded into this ForceField.</div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00501">forcefield.hpp:501</a></div></div>
<div class="ttc" id="aclassMolecule_html_a588965bd448a1cb43f25aed3179ecf96"><div class="ttname"><a href="classMolecule.html#a588965bd448a1cb43f25aed3179ecf96">Molecule::calculateFreeAtoms</a></div><div class="ttdeci">void calculateFreeAtoms()</div><div class="ttdoc">Manually parse the atom-list to add/remove atoms from the &quot;free atoms&quot; list. This is useful only when...</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00978">Molecule.hpp:978</a></div></div>
<div class="ttc" id="aclassMolecule_html_aef77043ab98f1008a15a1e52d85b827e"><div class="ttname"><a href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">Molecule::getBondedAtoms</a></div><div class="ttdeci">const std::vector&lt; Atom * &gt; getBondedAtoms(Atom *src) const</div><div class="ttdoc">Get all atoms bonded to a given atom.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00994">Molecule.hpp:994</a></div></div>
<div class="ttc" id="aclassNoAromaticCategoryException_html"><div class="ttname"><a href="classNoAromaticCategoryException.html">NoAromaticCategoryException</a></div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00073">Molecule.hpp:73</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aef128442de06304833ac94e8a418ba61" name="aef128442de06304833ac94e8a418ba61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef128442de06304833ac94e8a418ba61">&#9670;&nbsp;</a></span>calculateInternalEnergy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double Molecule::calculateInternalEnergy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> &amp;&#160;</td>
          <td class="paramname"><em>ff</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the total internal energy of a molecule. </p>
<p >Calculates the sum all all forms of internal potential for a molecule. It includes angle, dihedral, and non-bonding interaction energies.<br  />
This function still requires proper testing. </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01874">1874</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span>    {</div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>        <span class="keywordtype">double</span> inte=0;</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>        <span class="keywordtype">double</span> ange=0,dihe=0,ofe=0,lje=0;</div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>        std::vector&lt;Atom*&gt; visited;</div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++)</div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span>        {</div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>            <span class="keywordflow">if</span>(atoms[i]-&gt;isHydrogen()) <span class="keywordflow">continue</span>; <span class="comment">//Comment to calculate H-H interactios as well.</span></div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span>            visited.push_back(atoms[i]);</div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span>            std::vector&lt;Atom*&gt; bndats=this-&gt;<a class="code hl_function" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a>(atoms[i]);</div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span>            std::vector&lt;Atom*&gt; nearat=bndats;</div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span>            <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* ca : bndats)</div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span>            {</div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span>                <span class="keywordflow">if</span>(ca-&gt;isHydrogen()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span>                std::vector&lt;Atom*&gt; sbndats=this-&gt;<a class="code hl_function" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a>(ca);</div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span>                <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* sca : sbndats)</div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span>                {</div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span>                    <span class="keywordflow">if</span>(sca-&gt;isHydrogen() || sca==atoms[i]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span>                    nearat.push_back(sca);</div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span>                    std::vector&lt;Atom*&gt; tbndats=this-&gt;<a class="code hl_function" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a>(ca);</div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span>                    <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* tca : tbndats)</div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span>                    {</div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span>                        <span class="keywordflow">if</span>(tca==atoms[i]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span>                        <span class="keywordflow">if</span>(tca-&gt;isHydrogen()) <span class="keywordflow">continue</span>; <span class="comment">//Comment to calculate 1-4s for Hydrogen as well</span></div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span>                        ofe+=<a class="code hl_function" href="namespacechemtools.html#a4d736b938261879ac0c621cd97172a7a">chemtools::getNonbondingPotential</a>(tca,atoms[i])/2;</div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span>                        nearat.push_back(tca);</div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span>                    }</div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span>                }</div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span>            }</div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span>            <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* fa : atoms)</div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span>            {</div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"> 1905</span>                <span class="keywordflow">if</span>(fa-&gt;isHydrogen()) <span class="keywordflow">continue</span>; <span class="comment">//Comment to calculate LJs for hydrogen as well</span></div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span>                <span class="keywordflow">if</span>(fa==atoms[i] || contains(nearat,fa)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span>                <span class="keywordtype">double</span> ae=<a class="code hl_function" href="namespacechemtools.html#a4d736b938261879ac0c621cd97172a7a">chemtools::getNonbondingPotential</a>(fa,atoms[i]);</div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span>                cout &lt;&lt; atoms[i]-&gt;toString()&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;atoms[i]-&gt;getPosition().transpose() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>&lt;&lt;fa-&gt;toString()&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;fa-&gt;getPosition().transpose() &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;ae&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span>                lje+=ae;</div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span>            }</div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span>        }</div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>        ange/=2; dihe/=2; lje/=2; ofe/=2;</div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span>        cout &lt;&lt; <span class="stringliteral">&quot;Angle energy: &quot;</span>&lt;&lt;ange&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span>        cout &lt;&lt; <span class="stringliteral">&quot;Dihedral energy: &quot;</span>&lt;&lt;dihe&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span>        cout &lt;&lt; <span class="stringliteral">&quot;LJ Energy: &quot;</span>&lt;&lt; lje&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"> 1916</span>        cout &lt;&lt; <span class="stringliteral">&quot;1-4 Energy: &quot;</span>&lt;&lt;ofe&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span>        <span class="keywordflow">return</span> ange+dihe+lje+ofe;</div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span>    }</div>
<div class="ttc" id="anamespacechemtools_html_a4d736b938261879ac0c621cd97172a7a"><div class="ttname"><a href="namespacechemtools.html#a4d736b938261879ac0c621cd97172a7a">chemtools::getNonbondingPotential</a></div><div class="ttdeci">static double getNonbondingPotential(Atom *a1, Atom *a2)</div><div class="ttdoc">A wrapper that uses the stored parameters of Atom objects to calculate non-bonding interaction betwee...</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00366">Molecule.hpp:366</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8234989a3038abdd2228bf243cb7f668" name="a8234989a3038abdd2228bf243cb7f668"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8234989a3038abdd2228bf243cb7f668">&#9670;&nbsp;</a></span>calculateNRot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Molecule::calculateNRot </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> *&#160;</td>
          <td class="paramname"><em>ff</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>mod</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the number of rotatable bonds. </p>
<p >Calculates N_{ROT}, or the number of rotational degrees of freedom. This is used to empirically correct for some of the entropy caused due to ligand size<br  />
 <b>Note: </b> This assumes that the cycles have been already marked in this molecule (See: <a class="el" href="classMolecule.html#abfd8b7d4b46f69a9675e2fcac4397d19" title="Mark the atoms which are cyclized.">Molecule::markCyclizedAtoms()</a>) </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00859">859</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>    {</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>        <span class="keyword">const</span> <a class="code hl_class" href="classCategory.html">Category</a>* cat=(ff &amp;&amp; ff-&gt;<a class="code hl_function" href="classForceField.html#ab5bfc00e94bac57310cc3a4778e11342">hasCategory</a>(<span class="stringliteral">&quot;amidic&quot;</span>))?&amp;(ff-&gt;<a class="code hl_function" href="classForceField.html#a5a30c5a7760b5c791c5b34f9bd133506">getCategory</a>(<span class="stringliteral">&quot;amidic&quot;</span>)):<span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>        <span class="comment">//if(cat) cout &lt;&lt; &quot;Found category: &#39;amidic&#39;\n&quot;;</span></div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>        <span class="keywordtype">int</span> nrot=0;</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++)</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>        {</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>            <span class="keywordflow">if</span>(atoms[i]-&gt;getStandardValency()&lt;2 || atoms[i]-&gt;getHybridization()&lt;2) <span class="keywordflow">continue</span>; <span class="comment">//Consider changing valency limit to 3 (Does C-O bond in R-C(R&#39;)-OH actually have a degree of freedom)</span></div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;bonds[i].size();j++)</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>            {</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>                <span class="keywordflow">if</span>(atoms[bonds[i][j]]-&gt;getStandardValency()&lt;2 || atoms[i]-&gt;getHybridization()&lt;2 || (mod &amp;&amp; atoms[i]-&gt;getHybridization()&lt;3 &amp;&amp; atoms[bonds[i][j]]-&gt;getHybridization()&lt;3) || (cat &amp;&amp; ((cat-&gt;<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(atoms[i]) &amp;&amp; atoms[bonds[i][j]]-&gt;toString()[0]==<span class="charliteral">&#39;N&#39;</span>) || (cat-&gt;<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(atoms[bonds[i][j]]) &amp;&amp; atoms[i]-&gt;toString()[0]==<span class="charliteral">&#39;N&#39;</span>)) ) ) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>                <span class="keywordtype">bool</span> all1=<span class="keyword">true</span>,all2=<span class="keyword">true</span>;</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>                <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; v : cycles)</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>                {</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>                    all1=<span class="keyword">true</span>; all2=<span class="keyword">true</span>;</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>                    <span class="keywordflow">for</span>(<span class="keyword">const</span> <a class="code hl_class" href="classAtom.html">Atom</a>* ta : v)</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>                    {</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>                        <span class="keywordflow">if</span>(ta==atoms[i]) all1=<span class="keyword">false</span>;</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ta==atoms[bonds[i][j]]) all2=<span class="keyword">false</span>;</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>                    }</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>                    <span class="keywordflow">if</span>(!all1 &amp;&amp; !all2) {<span class="comment">/*cout &lt;&lt; &quot;\t&quot; &lt;&lt; atoms[i]-&gt;toString() &lt;&lt; &quot; - &quot; &lt;&lt; atoms[bonds[i][j]]-&gt;toString()&lt;&lt;&quot;\n&quot;;*/</span> <span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>                }</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>                <span class="keywordflow">if</span>(!all1 &amp;&amp; !all2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>                <span class="comment">//cout &lt;&lt; atoms[i]-&gt;toString() &lt;&lt; &quot; - &quot; &lt;&lt; atoms[bonds[i][j]]-&gt;toString()&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>                nrot++;</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>            }</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>        }</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span> </div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>        <span class="keywordflow">return</span> nrot/2;</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a04b2de48ba4c22b9bef6ca8aec90c1f9" name="a04b2de48ba4c22b9bef6ca8aec90c1f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04b2de48ba4c22b9bef6ca8aec90c1f9">&#9670;&nbsp;</a></span>commit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::commit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save all changes and end trial mode. </p>
<p >This method marks the end of "trial mode". All changes made are kept, the back-up copy is deleted, and trial mode is switched off. </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01127">1127</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>{<a class="code hl_variable" href="classMolecule.html#acf710157d0a2da0d5d7bab8d658c39be">trialmode</a>=<span class="keyword">false</span>;}</div>
<div class="ttc" id="aclassMolecule_html_acf710157d0a2da0d5d7bab8d658c39be"><div class="ttname"><a href="classMolecule.html#acf710157d0a2da0d5d7bab8d658c39be">Molecule::trialmode</a></div><div class="ttdeci">bool trialmode</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00503">Molecule.hpp:503</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a728fa63d31ed43876593086571e82cf6" name="a728fa63d31ed43876593086571e82cf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a728fa63d31ed43876593086571e82cf6">&#9670;&nbsp;</a></span>describeStructure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::describeStructure </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>outs</em> = <code>std::cout</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Symbolically describe the structure of the molecule. </p>
<p >Describe the molecule atom-wise along with the free valecies in brackets.<br  />
Atoms that must cyclize have a '*' on the side and atoms that have cyclized have a '$' </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01563">1563</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>  {</div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : atoms) outs &lt;&lt; a-&gt;toString()&lt;&lt;((a-&gt;mustCycl)?<span class="stringliteral">&quot;*&quot;</span>:<span class="stringliteral">&quot;&quot;</span>)&lt;&lt;((a-&gt;isCyclized())?<span class="stringliteral">&quot;$&quot;</span>:<span class="stringliteral">&quot;&quot;</span>)&lt;&lt; <span class="stringliteral">&quot;(&quot;</span>&lt;&lt;a-&gt;seek_valency()&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span>    outs &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : freeatoms) outs &lt;&lt; a-&gt;toString() &lt;&lt; <span class="stringliteral">&quot;(&quot;</span>&lt;&lt;a-&gt;seek_valency()&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>    outs &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a37f0c2acba7e35455f6128fff194e1a9" name="a37f0c2acba7e35455f6128fff194e1a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37f0c2acba7e35455f6128fff194e1a9">&#9670;&nbsp;</a></span>dropSingleAtom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::dropSingleAtom </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>din</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function allows to drop one atom from the molecule. Read well before usage. </p>
<p >Using this function, you can drop any atom which is a terminal atom. This is most commonly a hydrogen atom, and sometimes a halogen, but more uncommonly it might also be carbonyl oxygen.<br  />
You can also remove other atoms as long as you are sure they have exactly one connection to them at the time of removal. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">din</td><td>Index of atom to be removed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l02070">2070</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l02071" name="l02071"></a><span class="lineno"> 2071</span>    {</div>
<div class="line"><a id="l02072" name="l02072"></a><span class="lineno"> 2072</span>        std::vector&lt;int&gt; conA=bonds[din];</div>
<div class="line"><a id="l02073" name="l02073"></a><span class="lineno"> 2073</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span>&amp; c : conA)</div>
<div class="line"><a id="l02074" name="l02074"></a><span class="lineno"> 2074</span>        {</div>
<div class="line"><a id="l02075" name="l02075"></a><span class="lineno"> 2075</span>            <span class="keywordtype">int</span> i=0;</div>
<div class="line"><a id="l02076" name="l02076"></a><span class="lineno"> 2076</span>            <span class="keywordflow">for</span>(;i&lt;bonds[c].size();i++) {<span class="keywordflow">if</span>(bonds[c][i]==din) <span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l02077" name="l02077"></a><span class="lineno"> 2077</span>            bonds[c].erase(bonds[c].begin()+i);</div>
<div class="line"><a id="l02078" name="l02078"></a><span class="lineno"> 2078</span>            atoms[c]-&gt;setValency(atoms[c]-&gt;seek_valency()+1);</div>
<div class="line"><a id="l02079" name="l02079"></a><span class="lineno"> 2079</span>            <span class="keywordflow">if</span>(!contains(freeatoms,atoms[c])) freeatoms.push_back(atoms[c]);</div>
<div class="line"><a id="l02080" name="l02080"></a><span class="lineno"> 2080</span>        }</div>
<div class="line"><a id="l02081" name="l02081"></a><span class="lineno"> 2081</span>        bonds.erase(bonds.begin()+din);</div>
<div class="line"><a id="l02082" name="l02082"></a><span class="lineno"> 2082</span>        <a class="code hl_variable" href="classMolecule.html#adebb2c740099c5db4f14137bb1609877">myBE</a>-=atoms[din]-&gt;getEnergyContribution();</div>
<div class="line"><a id="l02083" name="l02083"></a><span class="lineno"> 2083</span>        <a class="code hl_variable" href="classMolecule.html#a6647358091d946bb02dbcf3ce35b7d5e">myHBE</a>-=atoms[din]-&gt;getHotspotEnergyContribution();</div>
<div class="line"><a id="l02084" name="l02084"></a><span class="lineno"> 2084</span>        <span class="keywordflow">if</span>(atoms[din]-&gt;isHydrogen()) <a class="code hl_variable" href="classMolecule.html#ab9512050a395e0ebb8fbba92f0a91222">HC</a>--;</div>
<div class="line"><a id="l02085" name="l02085"></a><span class="lineno"> 2085</span>        <span class="keywordflow">if</span>(VARIEDCOUNT &amp;&amp; VCLIST-&gt;<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(atoms[din])) HAC--;</div>
<div class="line"><a id="l02086" name="l02086"></a><span class="lineno"> 2086</span>        atoms.erase(atoms.begin()+din);</div>
<div class="line"><a id="l02087" name="l02087"></a><span class="lineno"> 2087</span>        <span class="keywordflow">for</span>(std::vector&lt;int&gt;&amp; bv : bonds)</div>
<div class="line"><a id="l02088" name="l02088"></a><span class="lineno"> 2088</span>        {</div>
<div class="line"><a id="l02089" name="l02089"></a><span class="lineno"> 2089</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span>&amp; i : bv) {<span class="keywordflow">if</span>(i&gt;=din) i--;}</div>
<div class="line"><a id="l02090" name="l02090"></a><span class="lineno"> 2090</span>        }</div>
<div class="line"><a id="l02091" name="l02091"></a><span class="lineno"> 2091</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a72616aa9d293190a9a0372a735f76966" name="a72616aa9d293190a9a0372a735f76966"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72616aa9d293190a9a0372a735f76966">&#9670;&nbsp;</a></span>dumpMol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::dumpMol </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> *&#160;</td>
          <td class="paramname"><em>ff</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write (dump) a molecule to a file (in PDB format) </p>
<p >This functions writes the molecule (with atom-type names and coordinates) to a PDB file. A <a class="el" href="classForceField.html">ForceField</a> is also takaen as input (optionally) to detect elements separately from atom-type names (eg. CLAR is chlorine and not carbon) </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01594">1594</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span>  {</div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span>    cout &lt;&lt; <span class="stringliteral">&quot;Dumping to: &quot;</span>&lt;&lt;fn&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>    ofstream of; of.open(fn,ios::out);</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>    <a class="code hl_function" href="classMolecule.html#a72616aa9d293190a9a0372a735f76966">dumpMol</a>(of,ff);</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span>    of.close();</div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span>  }</div>
<div class="ttc" id="aclassMolecule_html_a72616aa9d293190a9a0372a735f76966"><div class="ttname"><a href="classMolecule.html#a72616aa9d293190a9a0372a735f76966">Molecule::dumpMol</a></div><div class="ttdeci">void dumpMol(const std::string &amp;fn, const ForceField *ff=nullptr) const</div><div class="ttdoc">Write (dump) a molecule to a file (in PDB format)</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01594">Molecule.hpp:1594</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d59b178a86747eca8237e73170351e5" name="a8d59b178a86747eca8237e73170351e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d59b178a86747eca8237e73170351e5">&#9670;&nbsp;</a></span>dumpMolAsGRO()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::dumpMolAsGRO </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stI</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>head</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>header</em> = <code>&quot;DNV&#160;GRO&#160;molecule&#160;output&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write the molecule data in GRO format. </p>
<p >GRO format is the standard GROMACS format. </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01626">1626</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span>    {</div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>        <span class="keywordflow">if</span>(head)</div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span>        {</div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>            os &lt;&lt; header &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>            os &lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt; this-&gt;<a class="code hl_function" href="classMolecule.html#a6946cbe0d8daa9b2386d85ca7faf0cd1">getSize</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>        }</div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>        <span class="keywordtype">char</span> rnum[10],x[10],y[10],z[10],atn[10],ind[10];</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>        <span class="keywordtype">char</span> rnam[10]; sprintf(rnam,<span class="stringliteral">&quot;%4s&quot;</span>,atoms[0]-&gt;getResidue().c_str());</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>        <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : atoms)</div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>        {</div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>            sprintf(rnum,<span class="stringliteral">&quot;%d&quot;</span>,a-&gt;getResidueNumber());</div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>            sprintf(atn,<span class="stringliteral">&quot;%+4s&quot;</span>,a-&gt;toString().c_str());</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>            sprintf(ind,<span class="stringliteral">&quot;%d&quot;</span>,stI++);</div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>            sprintf(x,<span class="stringliteral">&quot;%.3f&quot;</span>,a-&gt;seek_x());</div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>            sprintf(y,<span class="stringliteral">&quot;%.3f&quot;</span>,a-&gt;seek_y());</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span>            sprintf(z,<span class="stringliteral">&quot;%.3f&quot;</span>,a-&gt;seek_z());</div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>            <span class="keywordtype">char</span> line[100];</div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>            sprintf(line,<span class="stringliteral">&quot;%+5s%+5s%+5s%+5s %+7s %+7s %+7s\n&quot;</span>,rnum,rnam,atn,ind,x,y,z);</div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span>            os &lt;&lt; line;</div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>        }</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af8c0559dba93cc2a1abef93b13216de1" name="af8c0559dba93cc2a1abef93b13216de1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8c0559dba93cc2a1abef93b13216de1">&#9670;&nbsp;</a></span>dumpMolAsMol2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::dumpMolAsMol2 </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classForceField.html">ForceField</a> *&#160;</td>
          <td class="paramname"><em>ff</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>no_orders</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calculate_orders</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em> = <code>&quot;DNV&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dump molecule in mol2 format to a stream. </p>
<p >Provides a function write the molecule in mol2 format. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">os</td><td>The output stream to write to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ff</td><td>The <a class="el" href="classForceField.html">ForceField</a> to use for guessing bond-types (and orders) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">no_orders</td><td>Ignores orders and bond-type data in mol2 bond records. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">calculate_orders</td><td>Calculate order before writing if not already calculated. Must provide ff </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>Name to give the molecule (Default: DNV) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01656">1656</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span>    {</div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>        <span class="keywordflow">if</span>(no_orders || !ff) calculate_orders=<span class="keyword">false</span>;</div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>        std::string globalrecs=<span class="stringliteral">&quot;@&lt;TRIPOS&gt;MOLECULE\n&quot;</span>+name+<span class="stringliteral">&quot;\n&quot;</span>,atomrecs=<span class="stringliteral">&quot;@&lt;TRIPOS&gt;ATOM\n&quot;</span>,bondrecs=<span class="stringliteral">&quot;@&lt;TRIPOS&gt;BOND\n&quot;</span>;</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>        <span class="keywordtype">int</span> bondcount=0,conK=0;</div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>        <span class="keyword">const</span> <a class="code hl_class" href="classCategory.html">Category</a>* aromcat=<span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>        <span class="keyword">const</span> <a class="code hl_class" href="classCategory.html">Category</a>* halocat=<span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>        <span class="keywordflow">if</span>(ff)</div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>        {</div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span>            aromcat=ff-&gt;<a class="code hl_function" href="classForceField.html#ab5bfc00e94bac57310cc3a4778e11342">hasCategory</a>(<span class="stringliteral">&quot;aromatic&quot;</span>)?&amp;ff-&gt;<a class="code hl_function" href="classForceField.html#a5a30c5a7760b5c791c5b34f9bd133506">getCategory</a>(<span class="stringliteral">&quot;aromatic&quot;</span>):<span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>            halocat=ff-&gt;<a class="code hl_function" href="classForceField.html#ab5bfc00e94bac57310cc3a4778e11342">hasCategory</a>(<span class="stringliteral">&quot;halogen&quot;</span>)?&amp;ff-&gt;<a class="code hl_function" href="classForceField.html#a5a30c5a7760b5c791c5b34f9bd133506">getCategory</a>(<span class="stringliteral">&quot;halogen&quot;</span>):<span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>        }</div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>        <span class="keywordflow">if</span>(!orders.size() &amp;&amp; calculate_orders) this-&gt;<a class="code hl_function" href="classMolecule.html#aa0590f11faa97d063d7542f91587898c">calculateBondOrders2</a>(*ff);</div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++)</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span>        {</div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span>            <span class="keywordtype">char</span> atstr[100];</div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span>            <span class="keywordtype">char</span> fch=atoms[i]-&gt;toString()[0];</div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>            std::string symb=(halocat &amp;&amp; halocat-&gt;<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(atoms[i]))?((fch==<span class="charliteral">&#39;C&#39;</span>?<span class="stringliteral">&quot;Cl&quot;</span>:(fch==<span class="charliteral">&#39;B&#39;</span>?<span class="stringliteral">&quot;Br&quot;</span>:std::string(1,fch)))):std::string(1,fch);</div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>            <span class="keywordflow">if</span>(aromcat &amp;&amp; aromcat-&gt;<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(atoms[i]))</div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span>            {</div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>                <span class="keywordflow">if</span>(fch==<span class="charliteral">&#39;O&#39;</span>) symb+=<span class="stringliteral">&quot;.2&quot;</span>;</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>                <span class="keywordflow">else</span> symb+=<span class="stringliteral">&quot;.ar&quot;</span>;</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span>            }</div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span>            {</div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span>                <span class="keywordflow">if</span>(atoms[i]-&gt;getHybridization()) symb+=<span class="stringliteral">&quot;.&quot;</span>+to_string(atoms[i]-&gt;getHybridization());</div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span>            }</div>
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"> 1683</span>            <span class="keywordtype">char</span> x[10],y[10],z[10];</div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span>            sprintf(x,<span class="stringliteral">&quot;%4.4f&quot;</span>,atoms[i]-&gt;seek_x()*10);</div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span>            sprintf(y,<span class="stringliteral">&quot;%4.4f&quot;</span>,atoms[i]-&gt;seek_y()*10);</div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span>            sprintf(z,<span class="stringliteral">&quot;%4.4f&quot;</span>,atoms[i]-&gt;seek_z()*10);</div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span>            sprintf(atstr,<span class="stringliteral">&quot;   %4d %4s     %9s %9s %9s %5s   1  DNV        %1.4f\n&quot;</span>,i+1,atoms[i]-&gt;toString().c_str(),x,y,z,symb.c_str(),atoms[i]-&gt;seek_charge());</div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span>            atomrecs+=atstr;</div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span>            bondcount+=bonds[i].size();</div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;bonds[i].size();j++)</div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span>            {</div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>                <span class="keywordflow">if</span>(bonds[i][j]&lt;i) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>                <span class="keywordtype">char</span> bstr[60];</div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span>                std::string btype=<span class="stringliteral">&quot;1&quot;</span>;</div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span>                <span class="keywordflow">if</span>(!no_orders)</div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>                {</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>                    <span class="keywordflow">if</span>(aromcat &amp;&amp; aromcat-&gt;<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(atoms[i]) &amp;&amp; aromcat-&gt;<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(atoms[bonds[i][j]])) btype=<span class="stringliteral">&quot;ar&quot;</span>;</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span>                    <span class="keywordflow">else</span> {<span class="keywordflow">if</span>(orders.size() &amp;&amp; orders[i][j]!=1) btype=to_string(orders[i][j]);}</div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span>                }</div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span>                sprintf(bstr,<span class="stringliteral">&quot;  %4d  %4d  %4d  %4s\n&quot;</span>,++conK,i+1,bonds[i][j]+1,btype.c_str());</div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span>                bondrecs+=bstr;</div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span>            }</div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span>        }</div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span>        globalrecs+=to_string(atoms.size())+<span class="stringliteral">&quot; &quot;</span>+to_string(bondcount/2)+<span class="stringliteral">&quot; 0 0 0\n&quot;</span>;</div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="classMolecule.html#a008ae56ec47345e906b08db6d2fd2b1c">binding_energy</a>()) os &lt;&lt; <span class="stringliteral">&quot;#REMARK &quot;</span>&lt;&lt;<a class="code hl_function" href="classMolecule.html#a008ae56ec47345e906b08db6d2fd2b1c">binding_energy</a>()&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;<a class="code hl_function" href="classMolecule.html#a5fbc68980ca26d735d65eaf7c35a49c4">hotspot_binding_energy</a>()&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;<a class="code hl_variable" href="classMolecule.html#abf3e45c79a7ae3fbb0fc174544debc1e">pE</a>&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;<a class="code hl_variable" href="classMolecule.html#a6b1f799908a9d52d7194d07ac6bb28d3">errBE</a>&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;<a class="code hl_variable" href="classMolecule.html#a32075500340345439d0d4912e26fb44f">errHBE</a>&lt;&lt;<span class="stringliteral">&quot;(error not impletemented yet -- Last two columns)\n&quot;</span>;</div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; ring : cycles)</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>        {</div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span>            os &lt;&lt; <span class="stringliteral">&quot;#REMARK CYCLE &quot;</span>&lt;&lt;ring.size()&lt;&lt;<span class="stringliteral">&quot; with atoms: &quot;</span>;</div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span>            <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : ring) os &lt;&lt; <a class="code hl_function" href="classMolecule.html#aa13276cae00e350b9b28c07cb82ebcec">indexOf</a>(a) &lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>            os&lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span>        }</div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span>        os &lt;&lt; globalrecs&lt;&lt;atomrecs&lt;&lt;bondrecs&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>    }</div>
<div class="ttc" id="aclassMolecule_html_a008ae56ec47345e906b08db6d2fd2b1c"><div class="ttname"><a href="classMolecule.html#a008ae56ec47345e906b08db6d2fd2b1c">Molecule::binding_energy</a></div><div class="ttdeci">double binding_energy() const</div><div class="ttdoc">a wrapper to get the calculated binding energy for this molecule. See Protein::calculateNonBondingEne...</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00618">Molecule.hpp:618</a></div></div>
<div class="ttc" id="aclassMolecule_html_a32075500340345439d0d4912e26fb44f"><div class="ttname"><a href="classMolecule.html#a32075500340345439d0d4912e26fb44f">Molecule::errHBE</a></div><div class="ttdeci">double errHBE</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00507">Molecule.hpp:507</a></div></div>
<div class="ttc" id="aclassMolecule_html_a5fbc68980ca26d735d65eaf7c35a49c4"><div class="ttname"><a href="classMolecule.html#a5fbc68980ca26d735d65eaf7c35a49c4">Molecule::hotspot_binding_energy</a></div><div class="ttdeci">double hotspot_binding_energy() const</div><div class="ttdoc">a wrapper to get the calculated binding energy (the contribution of the &quot;hotspot&quot; region) for this mo...</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00620">Molecule.hpp:620</a></div></div>
<div class="ttc" id="aclassMolecule_html_a6b1f799908a9d52d7194d07ac6bb28d3"><div class="ttname"><a href="classMolecule.html#a6b1f799908a9d52d7194d07ac6bb28d3">Molecule::errBE</a></div><div class="ttdeci">double errBE</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00506">Molecule.hpp:506</a></div></div>
<div class="ttc" id="aclassMolecule_html_aa0590f11faa97d063d7542f91587898c"><div class="ttname"><a href="classMolecule.html#aa0590f11faa97d063d7542f91587898c">Molecule::calculateBondOrders2</a></div><div class="ttdeci">void calculateBondOrders2(ForceField &amp;ff, bool assume_complete=false, bool assign_valence=false)</div><div class="ttdoc">An update on the original calculateBondOrders() method.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00746">Molecule.hpp:746</a></div></div>
<div class="ttc" id="aclassMolecule_html_abf3e45c79a7ae3fbb0fc174544debc1e"><div class="ttname"><a href="classMolecule.html#abf3e45c79a7ae3fbb0fc174544debc1e">Molecule::pE</a></div><div class="ttdeci">double pE</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00512">Molecule.hpp:512</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3afedbfc21fac19be1d4c5aaa9a9ac63" name="a3afedbfc21fac19be1d4c5aaa9a9ac63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3afedbfc21fac19be1d4c5aaa9a9ac63">&#9670;&nbsp;</a></span>dumpMolAsTxt() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::dumpMolAsTxt </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cpt</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Same as dumpMolAsTxt(const std::string&amp;). Uses an output stream instead of filename. </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01617">1617</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>{ofstream of; of.open(f,ios::out); this-&gt;<a class="code hl_function" href="classMolecule.html#abeb8483a7acbcab66438a3ec61b53971">dumpMolAsTxt</a>(of,cpt); of.close();}</div>
<div class="ttc" id="aclassMolecule_html_abeb8483a7acbcab66438a3ec61b53971"><div class="ttname"><a href="classMolecule.html#abeb8483a7acbcab66438a3ec61b53971">Molecule::dumpMolAsTxt</a></div><div class="ttdeci">void dumpMolAsTxt(ostream &amp;f, bool cpt=false) const</div><div class="ttdoc">Dump the molecule as a TXT file (See algorithm documentation PDF for details about this format)</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01607">Molecule.hpp:1607</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abeb8483a7acbcab66438a3ec61b53971" name="abeb8483a7acbcab66438a3ec61b53971"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abeb8483a7acbcab66438a3ec61b53971">&#9670;&nbsp;</a></span>dumpMolAsTxt() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::dumpMolAsTxt </td>
          <td>(</td>
          <td class="paramtype">ostream &amp;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cpt</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dump the molecule as a TXT file (See algorithm documentation PDF for details about this format) </p>
<p >This function dumps in the old TXT format. This function is kept as backward support. </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01607">1607</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>    {</div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>        f&lt;&lt;atoms.size()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>; <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++) f &lt;&lt; *(atoms[i]) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>        <span class="keywordflow">if</span>(cpt)</div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>        {</div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++) {<span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keywordtype">int</span> bmi : bonds[i]) f &lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt; bmi; f &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;}</div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>            f &lt;&lt; this-&gt;<a class="code hl_variable" href="classMolecule.html#adebb2c740099c5db4f14137bb1609877">myBE</a> &lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;this-&gt;<a class="code hl_variable" href="classMolecule.html#a6647358091d946bb02dbcf3ce35b7d5e">myHBE</a>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>        }</div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab6c1f0207db1069de8e3a49a1881e880" name="ab6c1f0207db1069de8e3a49a1881e880"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6c1f0207db1069de8e3a49a1881e880">&#9670;&nbsp;</a></span>free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>val</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Manually "frees" a capped or completely valency satisfied atom. </p>
<p >Grants some free valencies to a given atom. No checks are performed at this stage to ensure that it does not cross the upper limit of allowed bonds for that atom. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>A pointer to the <a class="el" href="classAtom.html">Atom</a> whose valency is to be set. If it doesn't belong to this <a class="el" href="classMolecule.html">Molecule</a>, <a class="el" href="classAtomNotInMoleculeException.html">AtomNotInMoleculeException</a> is thrown </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">val</td><td>The number of valecies to set for this atom. If it is negative, the free valecies of the target atom are set to 1 (if it was initally 0), otherwise it is unchanged. It should not be 0. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00968">968</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>    {</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>        assert(val); <span class="comment">//val!=0</span></div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>        <span class="keywordflow">if</span>(!contains(atoms,a)) <span class="keywordflow">throw</span> <a class="code hl_class" href="classAtomNotInMoleculeException.html">AtomNotInMoleculeException</a>();</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>        <span class="keywordflow">if</span>(!contains(freeatoms,a)) freeatoms.push_back(a);</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>        <span class="keywordflow">if</span>(val&lt;0) val=a-&gt;seek_valency();</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>        <span class="keywordflow">if</span>(val==0) val=1;</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>        a-&gt;setValency(val);</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>    }</div>
<div class="ttc" id="aclassAtomNotInMoleculeException_html"><div class="ttname"><a href="classAtomNotInMoleculeException.html">AtomNotInMoleculeException</a></div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00045">Molecule.hpp:45</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a586d332662ebab7d9c3cdf667d39a901" name="a586d332662ebab7d9c3cdf667d39a901"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a586d332662ebab7d9c3cdf667d39a901">&#9670;&nbsp;</a></span>getAllBridgeHeads()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::pair&lt; int, int &gt; &gt; Molecule::getAllBridgeHeads </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find all bridge-head atom index pairs for all possible bridges in this molecule. </p>
<p >Looks for bridge edges in the molecule and produces all pairs of atoms that have bridge-bonds. </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01957">1957</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span>    {</div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span>        std::vector&lt;std::pair&lt;int,int&gt;&gt; ret;</div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span>        this-&gt;<a class="code hl_function" href="classMolecule.html#abfd8b7d4b46f69a9675e2fcac4397d19">markCyclizedAtoms</a>();</div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++)</div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span>        {</div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span>            <span class="keywordflow">if</span>(atoms[i]-&gt;getStandardValency()&lt;2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"> 1964</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;bonds[i].size();j++)</div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span>            {</div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span>                <span class="keywordflow">if</span>(bonds[i][j]&gt;i) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span>                <span class="keywordflow">if</span>(atoms[bonds[i][j]]-&gt;getStandardValency()&lt;2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span>                <span class="keywordflow">if</span>(!inSameCycle(atoms[i],atoms[bonds[i][j]])) ret.push_back(make_pair(i,bonds[i][j]));</div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span>            }</div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span>        }</div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span>        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span>    }</div>
<div class="ttc" id="aclassMolecule_html_abfd8b7d4b46f69a9675e2fcac4397d19"><div class="ttname"><a href="classMolecule.html#abfd8b7d4b46f69a9675e2fcac4397d19">Molecule::markCyclizedAtoms</a></div><div class="ttdeci">void markCyclizedAtoms()</div><div class="ttdoc">Mark the atoms which are cyclized.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00842">Molecule.hpp:842</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d42c427c602da77f79246fe39246fb9" name="a7d42c427c602da77f79246fe39246fb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d42c427c602da77f79246fe39246fb9">&#9670;&nbsp;</a></span>getAtoms()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; <a class="el" href="classAtom.html">Atom</a> * &gt; &amp; Molecule::getAtoms </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get a copy of the list of atoms belonging to this <a class="el" href="classMolecule.html">Molecule</a>. </p>
<p >This method will give a vector of Atom* (pointers) for all the atoms in the <a class="el" href="classMolecule.html">Molecule</a>.<br  />
Any modifications made to the atoms in this list will reflect on those in <a class="el" href="classMolecule.html">Molecule</a> as well.<br  />
To avoid this copy the <a class="el" href="classMolecule.html">Molecule</a>. See <a class="el" href="classMolecule.html#a21ee086bf224ec95f24aae555e94b5b9" title="The Molecule class copy constructor.">Molecule::Molecule(const Molecule*)</a> </p><dl class="section return"><dt>Returns</dt><dd>List (vector) of pointers to all the atoms of this molecules with same indices as the original molecule (std::vector&lt;Atom*&gt;) </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00599">599</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>{<span class="keywordflow">return</span> atoms;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aef77043ab98f1008a15a1e52d85b827e" name="aef77043ab98f1008a15a1e52d85b827e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef77043ab98f1008a15a1e52d85b827e">&#9670;&nbsp;</a></span>getBondedAtoms()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; <a class="el" href="classAtom.html">Atom</a> * &gt; Molecule::getBondedAtoms </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get all atoms bonded to a given atom. </p>
<p >Gives a list of pointers to all the atoms that are bonded to this atom. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">src</td><td>Source atom for which bonded atom list is required. If the atom is itself not in this molecule, <a class="el" href="classAtomNotInMoleculeException.html">AtomNotInMoleculeException</a> is thrown </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>List of pointers to all the atoms (std::vector&lt;Atom*&gt;) </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00994">994</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>    {</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>        std::vector&lt;Atom*&gt; res;</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>    <span class="comment">//cout &lt;&lt; src-&gt;toString()&lt;&lt;&quot;: getBondedAtoms() was called on this\n&quot;;</span></div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>        <span class="keywordtype">int</span> ind=<a class="code hl_function" href="classMolecule.html#aa13276cae00e350b9b28c07cb82ebcec">indexOf</a>(src);</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>    <span class="keywordflow">if</span>(ind==-1)</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>        {</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>            cout &lt;&lt; src-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>() &lt;&lt; <span class="stringliteral">&quot;(&quot;</span>&lt;&lt;(long)src&lt;&lt;<span class="stringliteral">&quot;) not in: &quot;</span>; <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++) cout &lt;&lt; atoms[i]-&gt;toString()&lt;&lt;<span class="stringliteral">&quot;(&quot;</span>&lt;&lt;(long)atoms[i]&lt;&lt;<span class="stringliteral">&quot;),&quot;</span>; cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; <span class="keywordflow">throw</span> <a class="code hl_class" href="classAtomNotInMoleculeException.html">AtomNotInMoleculeException</a>();</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>        }</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i : bonds[ind]) res.push_back(atoms[i]);</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>        <span class="keywordflow">return</span> res;</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7b87ff96eec588c7296fcda7ee7ed178" name="a7b87ff96eec588c7296fcda7ee7ed178"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b87ff96eec588c7296fcda7ee7ed178">&#9670;&nbsp;</a></span>getBonds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; std::vector&lt; int &gt; &gt; &amp; Molecule::getBonds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the bonding data of the molecule. </p>
<p >This method will give a copy of the adjacency list stored in this object. </p><dl class="section return"><dt>Returns</dt><dd>The matrix is returned as a vector of integer-entry vectors (std::vector&lt;std::vector&lt;int&gt;&gt;) </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00604">604</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>{<span class="keywordflow">return</span> bonds;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0839d679a7ed5664c8729ab572ef67d7" name="a0839d679a7ed5664c8729ab572ef67d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0839d679a7ed5664c8729ab572ef67d7">&#9670;&nbsp;</a></span>getCentreOfGeometry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::Vector3d Molecule::getCentreOfGeometry </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>inch</em> = <code>false</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the center of geometry of the molecule. </p>
<p >Calculates the center of geometry for a molecule. The position is returned as a Vector (Eigen::Vector3d) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">inch</td><td>Include hydrogens? If set to true, the hydrogren atom positions are also considered for calculation of center of geomtery. Default: false </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01729">1729</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>  {</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span>    Eigen::Vector3d COG(0,0,0);</div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : <a class="code hl_function" href="classMolecule.html#a7d42c427c602da77f79246fe39246fb9">getAtoms</a>())</div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>    {</div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span>      <span class="keywordflow">if</span>(!inch &amp;&amp; a-&gt;isHydrogen()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span>      COG+=a-&gt;getPosition();</div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span>    }</div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>    <span class="keywordflow">if</span>(inch) COG/=<a class="code hl_function" href="classMolecule.html#a6946cbe0d8daa9b2386d85ca7faf0cd1">getSize</a>();</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span>    <span class="keywordflow">else</span> COG/=<a class="code hl_function" href="classMolecule.html#a4c6228c3225bd9571ba276841caa7c90">getEffectiveSize</a>();</div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>    <span class="keywordflow">return</span> COG;</div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span>  }</div>
<div class="ttc" id="aclassMolecule_html_a4c6228c3225bd9571ba276841caa7c90"><div class="ttname"><a href="classMolecule.html#a4c6228c3225bd9571ba276841caa7c90">Molecule::getEffectiveSize</a></div><div class="ttdeci">int getEffectiveSize() const</div><div class="ttdoc">Get the total number of atoms (excluding hydrogen atoms) in this Molecule.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00575">Molecule.hpp:575</a></div></div>
<div class="ttc" id="aclassMolecule_html_a7d42c427c602da77f79246fe39246fb9"><div class="ttname"><a href="classMolecule.html#a7d42c427c602da77f79246fe39246fb9">Molecule::getAtoms</a></div><div class="ttdeci">const std::vector&lt; Atom * &gt; &amp; getAtoms() const</div><div class="ttdoc">Get a copy of the list of atoms belonging to this Molecule.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00599">Molecule.hpp:599</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b7c224368ec15caea268e26051c9437" name="a9b7c224368ec15caea268e26051c9437"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b7c224368ec15caea268e26051c9437">&#9670;&nbsp;</a></span>getCompleteHash()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; int &gt; Molecule::getCompleteHash </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>heavy</em> = <code>false</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get a complete hash vector for a molecule. - experimental. </p>
<p >The hash vector generated by this function can uniquely identify each atom of the molecule and the molecule as a whole.<br  />
As of now, this hash cannot be used as a fingerprint for similarity matching. However, it can be used to tell if two molecule graphs are exactly same or not </p><dl class="section return"><dt>Returns</dt><dd>The hash vector for the entire molecule. If two molecules are same, they will have the same hash vector. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l02421">2421</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l02422" name="l02422"></a><span class="lineno"> 2422</span>    {</div>
<div class="line"><a id="l02423" name="l02423"></a><span class="lineno"> 2423</span>        std::vector&lt;int&gt; fhash;</div>
<div class="line"><a id="l02424" name="l02424"></a><span class="lineno"> 2424</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++)</div>
<div class="line"><a id="l02425" name="l02425"></a><span class="lineno"> 2425</span>        {</div>
<div class="line"><a id="l02426" name="l02426"></a><span class="lineno"> 2426</span>            cout &lt;&lt; atoms[i]-&gt;toString() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l02427" name="l02427"></a><span class="lineno"> 2427</span>            <span class="keywordflow">if</span>(!atoms[i]-&gt;hashvector.size()) hashatomcomplete(i);</div>
<div class="line"><a id="l02428" name="l02428"></a><span class="lineno"> 2428</span>        }</div>
<div class="line"><a id="l02429" name="l02429"></a><span class="lineno"> 2429</span>        <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : atoms)</div>
<div class="line"><a id="l02430" name="l02430"></a><span class="lineno"> 2430</span>        {</div>
<div class="line"><a id="l02431" name="l02431"></a><span class="lineno"> 2431</span>            <span class="keywordflow">if</span>(heavy &amp;&amp; a-&gt;isHydrogen()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l02432" name="l02432"></a><span class="lineno"> 2432</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;a-&gt;hashvector.size();i++)</div>
<div class="line"><a id="l02433" name="l02433"></a><span class="lineno"> 2433</span>            {</div>
<div class="line"><a id="l02434" name="l02434"></a><span class="lineno"> 2434</span>                <span class="keywordflow">if</span>(fhash.size()&gt;i) fhash[i]+=a-&gt;hashvector[i];</div>
<div class="line"><a id="l02435" name="l02435"></a><span class="lineno"> 2435</span>                <span class="keywordflow">else</span> fhash.push_back(a-&gt;hashvector[i]);</div>
<div class="line"><a id="l02436" name="l02436"></a><span class="lineno"> 2436</span>            }</div>
<div class="line"><a id="l02437" name="l02437"></a><span class="lineno"> 2437</span>        }</div>
<div class="line"><a id="l02438" name="l02438"></a><span class="lineno"> 2438</span>        <span class="keywordflow">return</span> fhash;</div>
<div class="line"><a id="l02439" name="l02439"></a><span class="lineno"> 2439</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d482b455228629e6ca908ce461a64a7" name="a3d482b455228629e6ca908ce461a64a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d482b455228629e6ca908ce461a64a7">&#9670;&nbsp;</a></span>getContainer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; Eigen::Vector3d, Eigen::Vector3d &gt; Molecule::getContainer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get a containing "box" co-ordinates which ensures that the molecule is enclosed by it. </p>
<p >This functions will give the co-ordinates (x<sub>min</sub>,y<sub>min</sub>,z<sub>min</sub>) and (x<sub>max</sub>,y<sub>max</sub>,z<sub>max</sub>).<br  />
 Using these coordinates, a bounding box can be constructed </p><dl class="section return"><dt>Returns</dt><dd>Pair of Vectors (std::pair&lt;Eigen::Vector3d,Eigen::Vector3d&gt;), one for each co-ordinate </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01786">1786</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span>  {</div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span>    Eigen::Vector3d minC,maxC,temp;</div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="classMolecule.html#a6946cbe0d8daa9b2386d85ca7faf0cd1">getSize</a>()&lt;=0) <span class="keywordflow">return</span> make_pair(Eigen::Vector3d(0,0,0),Eigen::Vector3d(0,0,0));</div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>    minC=atoms[0]-&gt;getPosition(); maxC=atoms[0]-&gt;getPosition();</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1;i&lt;atoms.size();i++)</div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span>    {</div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span>      temp=atoms[i]-&gt;getPosition();</div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span>      minC(0)=min(temp(0),minC(0));</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span>      minC(1)=min(temp(1),minC(1));</div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>      minC(2)=min(temp(2),minC(2));</div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span> </div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span>      maxC(0)=max(temp(0),maxC(0));</div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span>      maxC(1)=max(temp(1),maxC(1));</div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span>      maxC(2)=max(temp(2),maxC(2));</div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>    }</div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span>    <span class="keywordflow">return</span> make_pair(minC,maxC);</div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4c6228c3225bd9571ba276841caa7c90" name="a4c6228c3225bd9571ba276841caa7c90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c6228c3225bd9571ba276841caa7c90">&#9670;&nbsp;</a></span>getEffectiveSize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Molecule::getEffectiveSize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the total number of atoms (excluding hydrogen atoms) in this <a class="el" href="classMolecule.html">Molecule</a>. </p>
<p >Hydrogen atoms are considered "light" atoms by DeNovo. An atom type is considered to be a hydrogen atom if the first character of its atom name is 'H'<br  />
See Also: <a class="el" href="classMolecule.html#a6946cbe0d8daa9b2386d85ca7faf0cd1" title="Get the total number of atoms (including hydrogen atoms) in this Molecule.">getSize() const</a> </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00575">575</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>    {</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>        <span class="keywordflow">if</span>(VARIEDCOUNT) <span class="keywordflow">return</span> HAC;</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>        <span class="keywordflow">else</span> <span class="keywordflow">return</span> atoms.size()-<a class="code hl_variable" href="classMolecule.html#ab9512050a395e0ebb8fbba92f0a91222">HC</a>;</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a804447203e588ac312611688aa4fb500" name="a804447203e588ac312611688aa4fb500"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a804447203e588ac312611688aa4fb500">&#9670;&nbsp;</a></span>getFirstOrderHash()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long int Molecule::getFirstOrderHash </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Numeric first-order hash. </p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000050">Deprecated:</a></b></dt><dd>Use <a class="el" href="classMolecule.html#a9b7c224368ec15caea268e26051c9437" title="Get a complete hash vector for a molecule. - experimental.">getCompleteHash()</a> now </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l02410">2410</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l02411" name="l02411"></a><span class="lineno"> 2411</span>    {</div>
<div class="line"><a id="l02412" name="l02412"></a><span class="lineno"> 2412</span>        <span class="keywordflow">if</span>(!atoms.size()) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l02413" name="l02413"></a><span class="lineno"> 2413</span>        <span class="keywordtype">long</span> <span class="keywordtype">int</span> hash=0;</div>
<div class="line"><a id="l02414" name="l02414"></a><span class="lineno"> 2414</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++) {hash+=<a class="code hl_function" href="classMolecule.html#a54571895bd7b4ffa483889aad3b1092b">hashatom</a>(atoms[i]);}</div>
<div class="line"><a id="l02415" name="l02415"></a><span class="lineno"> 2415</span>        <span class="keywordflow">return</span> hash;</div>
<div class="line"><a id="l02416" name="l02416"></a><span class="lineno"> 2416</span>    }</div>
<div class="ttc" id="aclassMolecule_html_a54571895bd7b4ffa483889aad3b1092b"><div class="ttname"><a href="classMolecule.html#a54571895bd7b4ffa483889aad3b1092b">Molecule::hashatom</a></div><div class="ttdeci">long int hashatom(Atom *a)</div><div class="ttdoc">Numeric first-order hash.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l02385">Molecule.hpp:2385</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a63283844d6c417b775c29fc9c86eef47" name="a63283844d6c417b775c29fc9c86eef47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63283844d6c417b775c29fc9c86eef47">&#9670;&nbsp;</a></span>getHotspotEnergy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double Molecule::getHotspotEnergy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSystem.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>v</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000047">Deprecated:</a></b></dt><dd>Calculate the non-bonding interaction energy of the <a class="el" href="classMolecule.html">Molecule</a> to the hotspot region of the Proteins in this system. Use <a class="el" href="classMolecule.html#a973b1a0e85f2a3cf1e5c55dbe24c54e3" title="A wrapper to iterate through all the atoms in this molecule, and sum up the non-bonding interaction e...">calculateNonBondingEnergy()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l04128">4128</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l04129" name="l04129"></a><span class="lineno"> 4129</span>{</div>
<div class="line"><a id="l04130" name="l04130"></a><span class="lineno"> 4130</span>  <span class="keywordflow">if</span>(v!=0) <span class="keywordflow">return</span> v;</div>
<div class="line"><a id="l04131" name="l04131"></a><span class="lineno"> 4131</span>  <span class="keywordflow">for</span>(<a class="code hl_class" href="classMolecule.html">Molecule</a>* m : s.<a class="code hl_function" href="classSystem.html#a9a511120c5458822e88f2136aa7fdb2e">getMolecules</a>())</div>
<div class="line"><a id="l04132" name="l04132"></a><span class="lineno"> 4132</span>  {</div>
<div class="line"><a id="l04133" name="l04133"></a><span class="lineno"> 4133</span>    v+=get&lt;1&gt;(((<a class="code hl_class" href="classProtein.html">Protein</a>*)m)-&gt;<a class="code hl_function" href="classMolecule.html#a973b1a0e85f2a3cf1e5c55dbe24c54e3">calculateNonBondingEnergy</a>(<span class="keyword">this</span>));</div>
<div class="line"><a id="l04134" name="l04134"></a><span class="lineno"> 4134</span>    <span class="comment">//v+=((Protein*)m)-&gt;getHotspotBindingEnergy();</span></div>
<div class="line"><a id="l04135" name="l04135"></a><span class="lineno"> 4135</span>  }</div>
<div class="line"><a id="l04136" name="l04136"></a><span class="lineno"> 4136</span>  <span class="keywordflow">return</span> v;</div>
<div class="line"><a id="l04137" name="l04137"></a><span class="lineno"> 4137</span>}</div>
<div class="ttc" id="aclassMolecule_html_a973b1a0e85f2a3cf1e5c55dbe24c54e3"><div class="ttname"><a href="classMolecule.html#a973b1a0e85f2a3cf1e5c55dbe24c54e3">Molecule::calculateNonBondingEnergy</a></div><div class="ttdeci">virtual std::pair&lt; double, double &gt; calculateNonBondingEnergy(Atom *dummy, bool write=false)</div><div class="ttdoc">A wrapper to iterate through all the atoms in this molecule, and sum up the non-bonding interaction e...</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l03038">Molecule.hpp:3038</a></div></div>
<div class="ttc" id="aclassProtein_html"><div class="ttname"><a href="classProtein.html">Protein</a></div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l03064">Molecule.hpp:3065</a></div></div>
<div class="ttc" id="aclassSystem_html_a9a511120c5458822e88f2136aa7fdb2e"><div class="ttname"><a href="classSystem.html#a9a511120c5458822e88f2136aa7fdb2e">System::getMolecules</a></div><div class="ttdeci">const std::vector&lt; Molecule * &gt; &amp; getMolecules() const</div><div class="ttdoc">Get all the molecules contained in this System. (alternate method for a &quot;const&quot; System object)</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00168">Molecule.hpp:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a3d512a623d6ffdcc21783b651c1dee" name="a1a3d512a623d6ffdcc21783b651c1dee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a3d512a623d6ffdcc21783b651c1dee">&#9670;&nbsp;</a></span>getLastAtom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classAtom.html">Atom</a> * Molecule::getLastAtom </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the last atom in this molecule. </p>
<p >It is usually the atom last added to the <a class="el" href="classMolecule.html">Molecule</a>.<br  />
 It is basically a wrapper for mol-&gt;getAtom(mol-&gt;<a class="el" href="classMolecule.html#a6946cbe0d8daa9b2386d85ca7faf0cd1" title="Get the total number of atoms (including hydrogen atoms) in this Molecule.">getSize()</a>-1); </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00585">585</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>{<span class="keywordflow">return</span> atoms[atoms.size()-1];}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a69594b093fbb60eabc373d6860f19a87" name="a69594b093fbb60eabc373d6860f19a87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69594b093fbb60eabc373d6860f19a87">&#9670;&nbsp;</a></span>getNetCharge()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double Molecule::getNetCharge </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> &amp;&#160;</td>
          <td class="paramname"><em>ff</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get expected charge of a molecule. </p>
<p >The expected charge is calculated by summing the non-zero formal charges on each atom. The formal charges are defined separately in the forcefield (See algorithm PDF) </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01553">1553</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span>    {</div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>        <span class="keywordtype">double</span> nc=0;</div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>        <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* at : atoms) nc+=at-&gt;getFormalCharge();</div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span>        <span class="keywordflow">return</span> nc;</div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a50d2a2068fcda1e9676eb5d8e3aac9f2" name="a50d2a2068fcda1e9676eb5d8e3aac9f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50d2a2068fcda1e9676eb5d8e3aac9f2">&#9670;&nbsp;</a></span>getRandomBondableAtom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAtom.html">Atom</a> * Molecule::getRandomBondableAtom </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Randomly select an atom with free valencies. </p>
<p >Randomly picks an atom from the list of "free atoms". If the <a class="el" href="classMolecule.html">Molecule</a> was manually constructed, you may need to use <a class="el" href="classMolecule.html#a588965bd448a1cb43f25aed3179ecf96" title="Manually parse the atom-list to add/remove atoms from the &quot;free atoms&quot; list. This is useful only when...">calculateFreeAtoms()</a> </p><dl class="section return"><dt>Returns</dt><dd>A pointer to a random <a class="el" href="classAtom.html">Atom</a> belonging to this molecule which has at-least one free valency. If there is no such atom, a nullptr (Null-pointer) is returned </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01134">1134</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>    {</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>        <span class="keywordflow">if</span>(!freeatoms.size()) <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>        <span class="keywordflow">return</span> randomSelect(freeatoms);</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad2e19e6613d0ed3d7249a3aaea8f87dd" name="ad2e19e6613d0ed3d7249a3aaea8f87dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2e19e6613d0ed3d7249a3aaea8f87dd">&#9670;&nbsp;</a></span>getSMILES2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; std::string, std::vector&lt; <a class="el" href="classAtom.html">Atom</a> * &gt; &gt; Molecule::getSMILES2 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> *&#160;</td>
          <td class="paramname"><em>ff</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>daylight</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get SMILES format for this molecule - Improved. </p>
<p >This function parses the graph of the molecule to generate a valid smiles string. It requires a <a class="el" href="classForceField.html">ForceField</a> (in order to get valency and hybridization).<br  />
For complete molecules (with no free valecies), the "empty" force-field can be used (See algorithm PDF).<br  />
It can also be called without a <a class="el" href="classForceField.html">ForceField</a>, in which case it guesses at the valencies using standard parameters.<br  />
This function requires the <a class="el" href="classMolecule.html#ab64af9956394c7077c0ebf2db64b9cdf" title="Calculate bond orders for the bonds of this molecules (experimental)">calculateBondOrders()</a> to be called eariler on this <a class="el" href="classMolecule.html">Molecule</a> object </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ff</td><td><a class="el" href="classForceField.html">ForceField</a> to use (Note that it's a pointer to the <a class="el" href="classForceField.html">ForceField</a> object) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">daylight</td><td>Generate daylight SMILES (represents aromatic atoms with small letters and omits their bond-orders) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l02203">2203</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l02204" name="l02204"></a><span class="lineno"> 2204</span>    {</div>
<div class="line"><a id="l02205" name="l02205"></a><span class="lineno"> 2205</span>        <span class="keywordflow">if</span>(daylight &amp;&amp; (!ff || !ff-&gt;<a class="code hl_function" href="classForceField.html#ab5bfc00e94bac57310cc3a4778e11342">hasCategory</a>(<span class="stringliteral">&quot;aromatic&quot;</span>))) <span class="keywordflow">throw</span> <a class="code hl_class" href="classNoAromaticCategoryException.html">NoAromaticCategoryException</a>();</div>
<div class="line"><a id="l02206" name="l02206"></a><span class="lineno"> 2206</span>        <span class="keywordflow">if</span>(!orders.size()) <span class="keywordflow">throw</span> <a class="code hl_class" href="classBondOrdersUncalculatedException.html">BondOrdersUncalculatedException</a>();</div>
<div class="line"><a id="l02207" name="l02207"></a><span class="lineno"> 2207</span>        <span class="keyword">const</span> <a class="code hl_class" href="classCategory.html">Category</a> *aromcat=&amp;(ff-&gt;<a class="code hl_function" href="classForceField.html#a5a30c5a7760b5c791c5b34f9bd133506">getCategory</a>(<span class="stringliteral">&quot;aromatic&quot;</span>)),*halocat=<span class="keyword">nullptr</span>; <span class="keywordflow">if</span>(ff-&gt;<a class="code hl_function" href="classForceField.html#ab5bfc00e94bac57310cc3a4778e11342">hasCategory</a>(<span class="stringliteral">&quot;halogen&quot;</span>)) halocat=&amp;(ff-&gt;<a class="code hl_function" href="classForceField.html#a5a30c5a7760b5c791c5b34f9bd133506">getCategory</a>(<span class="stringliteral">&quot;halogen&quot;</span>));</div>
<div class="line"><a id="l02208" name="l02208"></a><span class="lineno"> 2208</span>        std::string SMILES=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l02209" name="l02209"></a><span class="lineno"> 2209</span>        <span class="keywordtype">int</span> K=0,ringID=1;</div>
<div class="line"><a id="l02210" name="l02210"></a><span class="lineno"> 2210</span>        <span class="keywordflow">for</span>(K=0;K&lt;atoms.size();K++) <span class="keywordflow">if</span>(!atoms[K]-&gt;isHydrogen()) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02211" name="l02211"></a><span class="lineno"> 2211</span>        std::vector&lt;int&gt; hcount,visited;</div>
<div class="line"><a id="l02212" name="l02212"></a><span class="lineno"> 2212</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++)</div>
<div class="line"><a id="l02213" name="l02213"></a><span class="lineno"> 2213</span>        {</div>
<div class="line"><a id="l02214" name="l02214"></a><span class="lineno"> 2214</span>            <span class="keywordtype">int</span> hC=0;</div>
<div class="line"><a id="l02215" name="l02215"></a><span class="lineno"> 2215</span>            <span class="keywordflow">if</span>(atoms[i]-&gt;isHydrogen()) {hcount.push_back(0); <span class="keywordflow">continue</span>;}</div>
<div class="line"><a id="l02216" name="l02216"></a><span class="lineno"> 2216</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;bonds[i].size();j++) {<span class="keywordflow">if</span>(atoms[bonds[i][j]]-&gt;isHydrogen()) hC++;}</div>
<div class="line"><a id="l02217" name="l02217"></a><span class="lineno"> 2217</span>            hcount.push_back(hC);</div>
<div class="line"><a id="l02218" name="l02218"></a><span class="lineno"> 2218</span>        }</div>
<div class="line"><a id="l02219" name="l02219"></a><span class="lineno"> 2219</span>        std::vector&lt;std::string&gt; atomnames;</div>
<div class="line"><a id="l02220" name="l02220"></a><span class="lineno"> 2220</span>        <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : atoms)</div>
<div class="line"><a id="l02221" name="l02221"></a><span class="lineno"> 2221</span>        {</div>
<div class="line"><a id="l02222" name="l02222"></a><span class="lineno"> 2222</span>            <span class="keywordflow">if</span>(halocat &amp;&amp; halocat-&gt;contains(a))</div>
<div class="line"><a id="l02223" name="l02223"></a><span class="lineno"> 2223</span>            {</div>
<div class="line"><a id="l02224" name="l02224"></a><span class="lineno"> 2224</span>                <span class="keywordflow">if</span>(a-&gt;toString()[0]==<span class="charliteral">&#39;C&#39;</span>) atomnames.push_back(<span class="stringliteral">&quot;Cl&quot;</span>);</div>
<div class="line"><a id="l02225" name="l02225"></a><span class="lineno"> 2225</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(a-&gt;toString()[0]==<span class="charliteral">&#39;B&#39;</span>) atomnames.push_back(<span class="stringliteral">&quot;Br&quot;</span>);</div>
<div class="line"><a id="l02226" name="l02226"></a><span class="lineno"> 2226</span>                <span class="keywordflow">else</span> atomnames.push_back(std::string(1,a-&gt;toString()[0]));</div>
<div class="line"><a id="l02227" name="l02227"></a><span class="lineno"> 2227</span>            }</div>
<div class="line"><a id="l02228" name="l02228"></a><span class="lineno"> 2228</span>            <span class="keywordflow">else</span> atomnames.push_back(std::string(1,a-&gt;toString()[0]));</div>
<div class="line"><a id="l02229" name="l02229"></a><span class="lineno"> 2229</span>            <span class="keywordflow">if</span>(a-&gt;getFormalCharge())</div>
<div class="line"><a id="l02230" name="l02230"></a><span class="lineno"> 2230</span>            {</div>
<div class="line"><a id="l02231" name="l02231"></a><span class="lineno"> 2231</span>                <span class="keywordtype">int</span> atnind=<a class="code hl_function" href="classMolecule.html#aa13276cae00e350b9b28c07cb82ebcec">indexOf</a>(a); <span class="keywordflow">if</span>(hcount[atnind]) atomnames[atomnames.size()-1]+=<span class="stringliteral">&quot;H&quot;</span>+((hcount[atnind]==1)?<span class="stringliteral">&quot;&quot;</span>:to_string(hcount[atnind]));</div>
<div class="line"><a id="l02232" name="l02232"></a><span class="lineno"> 2232</span>                <span class="keywordflow">if</span>(a-&gt;getFormalCharge()&gt;0) atomnames[atomnames.size()-1]=<span class="stringliteral">&quot;[&quot;</span>+atomnames[atomnames.size()-1]+<span class="stringliteral">&quot;+&quot;</span>+to_string((<span class="keywordtype">int</span>)a-&gt;getFormalCharge())+<span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a id="l02233" name="l02233"></a><span class="lineno"> 2233</span>                <span class="keywordflow">else</span> atomnames[atomnames.size()-1]=<span class="stringliteral">&quot;[&quot;</span>+atomnames[atomnames.size()-1]+to_string((<span class="keywordtype">int</span>)a-&gt;getFormalCharge())+<span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a id="l02234" name="l02234"></a><span class="lineno"> 2234</span>            }</div>
<div class="line"><a id="l02235" name="l02235"></a><span class="lineno"> 2235</span>        }</div>
<div class="line"><a id="l02236" name="l02236"></a><span class="lineno"> 2236</span> </div>
<div class="line"><a id="l02237" name="l02237"></a><span class="lineno"> 2237</span>        std::vector&lt;Atom*&gt; neworder;</div>
<div class="line"><a id="l02238" name="l02238"></a><span class="lineno"> 2238</span>        parseForSMILES2(K,SMILES,atomnames,hcount,visited,neworder,ringID);</div>
<div class="line"><a id="l02239" name="l02239"></a><span class="lineno"> 2239</span>        <span class="keywordflow">if</span>(!QUIET) cout &lt;&lt; <span class="stringliteral">&quot;Raw SMILES: &quot;</span>&lt;&lt;SMILES&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l02240" name="l02240"></a><span class="lineno"> 2240</span> </div>
<div class="line"><a id="l02241" name="l02241"></a><span class="lineno"> 2241</span>        <span class="comment">//Replacing atom references by actual node data</span></div>
<div class="line"><a id="l02242" name="l02242"></a><span class="lineno"> 2242</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=atoms.size()-1;i&gt;=0;i--)</div>
<div class="line"><a id="l02243" name="l02243"></a><span class="lineno"> 2243</span>        {</div>
<div class="line"><a id="l02244" name="l02244"></a><span class="lineno"> 2244</span>            <span class="keywordflow">if</span>(!atoms[i]-&gt;isHydrogen()) cout &lt;&lt; atoms[i]-&gt;toString() &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;atomnames[i]&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l02245" name="l02245"></a><span class="lineno"> 2245</span>            <span class="keywordflow">else</span> <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l02246" name="l02246"></a><span class="lineno"> 2246</span>            std::string oldsmiles=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l02247" name="l02247"></a><span class="lineno"> 2247</span>            <span class="keywordflow">while</span>(oldsmiles!=SMILES)</div>
<div class="line"><a id="l02248" name="l02248"></a><span class="lineno"> 2248</span>            {</div>
<div class="line"><a id="l02249" name="l02249"></a><span class="lineno"> 2249</span>                oldsmiles=SMILES;</div>
<div class="line"><a id="l02250" name="l02250"></a><span class="lineno"> 2250</span>                <a class="code hl_function" href="namespacestringfx.html#a827b03090f77597d306efc02f5132d04">stringfx::replace</a>(SMILES,<span class="stringliteral">&quot;&amp;&quot;</span>+to_string(i)+<span class="stringliteral">&quot;$&quot;</span>,atomnames[i]);</div>
<div class="line"><a id="l02251" name="l02251"></a><span class="lineno"> 2251</span>            }</div>
<div class="line"><a id="l02252" name="l02252"></a><span class="lineno"> 2252</span>        }</div>
<div class="line"><a id="l02253" name="l02253"></a><span class="lineno"> 2253</span> </div>
<div class="line"><a id="l02254" name="l02254"></a><span class="lineno"> 2254</span>        <span class="comment">//Return the result</span></div>
<div class="line"><a id="l02255" name="l02255"></a><span class="lineno"> 2255</span>        <span class="keywordflow">if</span>(!QUIET) cout &lt;&lt; <span class="stringliteral">&quot;New order: \n&quot;</span>;</div>
<div class="line"><a id="l02256" name="l02256"></a><span class="lineno"> 2256</span>        <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : neworder) cout &lt;&lt; a-&gt;toString() &lt;&lt;<span class="stringliteral">&quot;(&quot;</span>&lt;&lt;this-&gt;<a class="code hl_function" href="classMolecule.html#aa13276cae00e350b9b28c07cb82ebcec">indexOf</a>(a)&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>&lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l02257" name="l02257"></a><span class="lineno"> 2257</span>        <span class="keywordflow">return</span> make_pair(SMILES,neworder);</div>
<div class="line"><a id="l02258" name="l02258"></a><span class="lineno"> 2258</span>    }</div>
<div class="ttc" id="aclassBondOrdersUncalculatedException_html"><div class="ttname"><a href="classBondOrdersUncalculatedException.html">BondOrdersUncalculatedException</a></div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00069">Molecule.hpp:69</a></div></div>
<div class="ttc" id="anamespacestringfx_html_a827b03090f77597d306efc02f5132d04"><div class="ttname"><a href="namespacestringfx.html#a827b03090f77597d306efc02f5132d04">stringfx::replace</a></div><div class="ttdeci">std::string &amp; replace(std::string &amp;s, std::string val, std::string ns)</div><div class="ttdoc">Replace a substring with another.</div><div class="ttdef"><b>Definition:</b> <a href="commons_8h_source.html#l00399">commons.h:399</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a54571895bd7b4ffa483889aad3b1092b" name="a54571895bd7b4ffa483889aad3b1092b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54571895bd7b4ffa483889aad3b1092b">&#9670;&nbsp;</a></span>hashatom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long int Molecule::hashatom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Numeric first-order hash. </p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000049">Deprecated:</a></b></dt><dd>Use hashatomcomplete() now </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l02385">2385</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l02386" name="l02386"></a><span class="lineno"> 2386</span>    {</div>
<div class="line"><a id="l02387" name="l02387"></a><span class="lineno"> 2387</span>        std::vector&lt;Atom*&gt; bnd=this-&gt;<a class="code hl_function" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a>(a);</div>
<div class="line"><a id="l02388" name="l02388"></a><span class="lineno"> 2388</span>        <span class="keywordtype">long</span> <span class="keywordtype">int</span> myhash=(<span class="keywordtype">long</span> int)(a-&gt;toString()[0])*10000;</div>
<div class="line"><a id="l02389" name="l02389"></a><span class="lineno"> 2389</span>        <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* n : bnd)</div>
<div class="line"><a id="l02390" name="l02390"></a><span class="lineno"> 2390</span>        {</div>
<div class="line"><a id="l02391" name="l02391"></a><span class="lineno"> 2391</span>            <span class="keywordflow">if</span>(bnd.size()==1)</div>
<div class="line"><a id="l02392" name="l02392"></a><span class="lineno"> 2392</span>            {</div>
<div class="line"><a id="l02393" name="l02393"></a><span class="lineno"> 2393</span>                <span class="keywordflow">if</span>(!n-&gt;hashvalue) <a class="code hl_function" href="classMolecule.html#a54571895bd7b4ffa483889aad3b1092b">hashatom</a>(n);</div>
<div class="line"><a id="l02394" name="l02394"></a><span class="lineno"> 2394</span>                myhash+=n-&gt;hashvalue;</div>
<div class="line"><a id="l02395" name="l02395"></a><span class="lineno"> 2395</span>            }</div>
<div class="line"><a id="l02396" name="l02396"></a><span class="lineno"> 2396</span>            myhash+=(int)(n-&gt;toString()[0]*10)*(this-&gt;<a class="code hl_function" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a>(n).size());</div>
<div class="line"><a id="l02397" name="l02397"></a><span class="lineno"> 2397</span>            std::vector&lt;Atom*&gt; sobnd=this-&gt;<a class="code hl_function" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a>(n);</div>
<div class="line"><a id="l02398" name="l02398"></a><span class="lineno"> 2398</span>            <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* n2 : sobnd)</div>
<div class="line"><a id="l02399" name="l02399"></a><span class="lineno"> 2399</span>            {</div>
<div class="line"><a id="l02400" name="l02400"></a><span class="lineno"> 2400</span>                <span class="keywordtype">int</span> nb=bonds[<a class="code hl_function" href="classMolecule.html#aa13276cae00e350b9b28c07cb82ebcec">indexOf</a>(n2)].size();</div>
<div class="line"><a id="l02401" name="l02401"></a><span class="lineno"> 2401</span>                <span class="keywordflow">if</span>(nb==1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l02402" name="l02402"></a><span class="lineno"> 2402</span>                <span class="keywordflow">if</span>(n2==a) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l02403" name="l02403"></a><span class="lineno"> 2403</span>                myhash+=(<span class="keywordtype">long</span> int)(n2-&gt;toString()[0])*nb;</div>
<div class="line"><a id="l02404" name="l02404"></a><span class="lineno"> 2404</span>            }</div>
<div class="line"><a id="l02405" name="l02405"></a><span class="lineno"> 2405</span>        }</div>
<div class="line"><a id="l02406" name="l02406"></a><span class="lineno"> 2406</span>        a-&gt;hashvalue=myhash;</div>
<div class="line"><a id="l02407" name="l02407"></a><span class="lineno"> 2407</span>        <span class="keywordflow">return</span> myhash;</div>
<div class="line"><a id="l02408" name="l02408"></a><span class="lineno"> 2408</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa13276cae00e350b9b28c07cb82ebcec" name="aa13276cae00e350b9b28c07cb82ebcec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa13276cae00e350b9b28c07cb82ebcec">&#9670;&nbsp;</a></span>indexOf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Molecule::indexOf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the index value of an atom from it's pointer. </p>
<dl class="section return"><dt>Returns</dt><dd>The index of the atom. If the atom is not found, the result is '-1' </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00610">610</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>{<span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++) {<span class="keywordflow">if</span>(atoms[i]==p) <span class="keywordflow">return</span> i;} <span class="keywordflow">return</span> -1;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b92bf02eb26dd75ea36273601e0a3c2" name="a1b92bf02eb26dd75ea36273601e0a3c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b92bf02eb26dd75ea36273601e0a3c2">&#9670;&nbsp;</a></span>loadGrid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Molecule::loadGrid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSystem.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000043">Deprecated:</a></b></dt><dd>Grid functions are deprecated </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00986">986</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>{s.<a class="code hl_function" href="classSystem.html#ab40a2d763cf2f23f4565f663aedc25df">grid</a>().fill_with_zero();}</div>
<div class="ttc" id="aclassSystem_html_ab40a2d763cf2f23f4565f663aedc25df"><div class="ttname"><a href="classSystem.html#ab40a2d763cf2f23f4565f663aedc25df">System::grid</a></div><div class="ttdeci">Grid &amp; grid()</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00146">Molecule.hpp:146</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a04b3beb3e333664d6421e9f0ee46dd73" name="a04b3beb3e333664d6421e9f0ee46dd73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04b3beb3e333664d6421e9f0ee46dd73">&#9670;&nbsp;</a></span>makeBond()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::makeBond </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Join two atoms to make a bond. </p>
<p >This is one of the functions used for manually constructing a molecule in cpp. I can also be used to add non-existing/un-expected bonds to a loaded molecule.<br  />
This function accepts two atoms (as pointers). These atoms <b>must belong to this <a class="el" href="classMolecule.html">Molecule</a> object</b>. See <a class="el" href="classMolecule.html#aadf1f51e311a11e69385ff51602b86bc" title="Add a new atom to the Molecule.">addAtom(Atom*)</a> for details on adding an atom<br  />
It is necessary for both atoms to have one free valency at-least. Make sure you have chosen the correct atom types before bonding. You can add valencies using <a class="el" href="classMolecule.html#ab6c1f0207db1069de8e3a49a1881e880" title="Manually &quot;frees&quot; a capped or completely valency satisfied atom.">free()</a> or <a class="el" href="classAtom.html#a9eb04d5b5e7b60694e96e5f9dd20bfac" title="Set the number of free valencies.">Atom::setValency(int)</a>, but it is not recommended. If you do not know what atom-type to use and/or do not intend to use it with force-fields, use the "empty forcefield".<br  />
 See Also: Force-Field in PDF, and the <a class="el" href="classForceField.html">ForceField</a> class </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01143">1143</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>    {</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>        assert(a1!=a2);</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>        <span class="keywordtype">int</span> i1=<a class="code hl_function" href="classMolecule.html#aa13276cae00e350b9b28c07cb82ebcec">indexOf</a>(a1),i2=<a class="code hl_function" href="classMolecule.html#aa13276cae00e350b9b28c07cb82ebcec">indexOf</a>(a2);</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>        <span class="keywordflow">if</span>(i1==-1 || i2==-1) <span class="keywordflow">throw</span> <a class="code hl_class" href="classAtomNotInMoleculeException.html">AtomNotInMoleculeException</a>();</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span><span class="preprocessor">        #ifndef PLACEHOLDERMOLECULES</span></div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>            <span class="keywordflow">if</span>(!a1-&gt;<a class="code hl_function" href="classAtom.html#acd1d81d4d5011bd1cf6b53e6ec5830dd">canBond</a>() || !a2-&gt;<a class="code hl_function" href="classAtom.html#acd1d81d4d5011bd1cf6b53e6ec5830dd">canBond</a>()) <span class="keywordflow">throw</span> <a class="code hl_class" href="classNoValencyAvailableException.html">NoValencyAvailableException</a>();</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span><span class="preprocessor">        #endif</span></div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>        bonds[i1].push_back(i2);</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>        bonds[i2].push_back(i1);</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>        a1-&gt;<a class="code hl_function" href="classAtom.html#a6d1ed6f7432ecc88bee6faa26294cd08">addBond</a>(); a2-&gt;<a class="code hl_function" href="classAtom.html#a6d1ed6f7432ecc88bee6faa26294cd08">addBond</a>();</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>        <span class="keywordflow">if</span>(!a1-&gt;<a class="code hl_function" href="classAtom.html#acd1d81d4d5011bd1cf6b53e6ec5830dd">canBond</a>()) freeatoms.erase(std::remove(freeatoms.begin(), freeatoms.end(), a1), freeatoms.end());</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>        <span class="keywordflow">if</span>(!a2-&gt;<a class="code hl_function" href="classAtom.html#acd1d81d4d5011bd1cf6b53e6ec5830dd">canBond</a>()) freeatoms.erase(std::remove(freeatoms.begin(), freeatoms.end(), a2), freeatoms.end());</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>    }</div>
<div class="ttc" id="aclassNoValencyAvailableException_html"><div class="ttname"><a href="classNoValencyAvailableException.html">NoValencyAvailableException</a></div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00022">Atom.hpp:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6351ba55249d7e5659dfbb397dd0e069" name="a6351ba55249d7e5659dfbb397dd0e069"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6351ba55249d7e5659dfbb397dd0e069">&#9670;&nbsp;</a></span>makePruneFragment()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::makePruneFragment </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>devid</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function generates the starting fragment for "pruning" (See algorthim PDF). </p>
<p >The algorithm of pruning requires removal of random "terminal" atoms. Atoms which have a single non-hydrogen neighbour are treated as terminals, and the non-hydrogen neighbour is called the "stem". </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>It is the prune depth. 'n' terminal atoms are recursively removed before pruning begins. After the first terminal atom is removed, the next atom (which initially was not terminal but is terminal now) can be removed (hence the term 'depth') </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l02096">2096</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l02097" name="l02097"></a><span class="lineno"> 2097</span>    {</div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span>        cout &lt;&lt; <span class="stringliteral">&quot;Begin. n=&quot;</span>&lt;&lt;n&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span>        std::vector&lt;std::vector&lt;int&gt;&gt; hydats;</div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span>        std::vector&lt;int&gt; terms,termconns;</div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span>        <span class="keywordtype">bool</span> terminal=<span class="keyword">true</span>;</div>
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"> 2102</span>        <span class="keywordtype">int</span> termholder=-1;</div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span>        std::vector&lt;int&gt; hydatis;</div>
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"> 2104</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++)</div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span>        {</div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span>            <span class="keywordflow">if</span>(atoms[i]-&gt;isHydrogen()) {hydatis.push_back(i); <span class="keywordflow">continue</span>;}</div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span>            std::vector&lt;int&gt; hyd;</div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"> 2108</span>            terminal=<span class="keyword">true</span>;</div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span>            termholder=-1;</div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span>            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; bai : bonds[i])</div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span>            {</div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span>                <span class="keywordflow">if</span>(atoms[bai]-&gt;isHydrogen()) hyd.push_back(bai);</div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span>                {</div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span>                    <span class="keywordflow">if</span>(termholder==-1) termholder=bai;</div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span>                    <span class="keywordflow">else</span> {terminal=<span class="keyword">false</span>; <span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l02117" name="l02117"></a><span class="lineno"> 2117</span>                }</div>
<div class="line"><a id="l02118" name="l02118"></a><span class="lineno"> 2118</span>            }</div>
<div class="line"><a id="l02119" name="l02119"></a><span class="lineno"> 2119</span>            <span class="keywordflow">if</span>(terminal)</div>
<div class="line"><a id="l02120" name="l02120"></a><span class="lineno"> 2120</span>            {</div>
<div class="line"><a id="l02121" name="l02121"></a><span class="lineno"> 2121</span>                <span class="keywordflow">if</span>(termholder==-1) cout &lt;&lt; <span class="stringliteral">&quot;WARN: holder not found!!!\n&quot;</span>;</div>
<div class="line"><a id="l02122" name="l02122"></a><span class="lineno"> 2122</span>                terms.push_back(i); hydats.push_back(hyd); termconns.push_back(termholder);</div>
<div class="line"><a id="l02123" name="l02123"></a><span class="lineno"> 2123</span>            }</div>
<div class="line"><a id="l02124" name="l02124"></a><span class="lineno"> 2124</span>        }</div>
<div class="line"><a id="l02125" name="l02125"></a><span class="lineno"> 2125</span>        <span class="keywordflow">if</span>(!terms.size())</div>
<div class="line"><a id="l02126" name="l02126"></a><span class="lineno"> 2126</span>        {</div>
<div class="line"><a id="l02127" name="l02127"></a><span class="lineno"> 2127</span>            <span class="keywordflow">if</span>(hydatis.size())</div>
<div class="line"><a id="l02128" name="l02128"></a><span class="lineno"> 2128</span>            {</div>
<div class="line"><a id="l02129" name="l02129"></a><span class="lineno"> 2129</span>                cout &lt;&lt; <span class="stringliteral">&quot;NOTE: Prune fragment generation will only remove hydrogen atoms now. No heavy-atom terminals to prune.\n&quot;</span>;</div>
<div class="line"><a id="l02130" name="l02130"></a><span class="lineno"> 2130</span>                <span class="keywordtype">int</span> rhi=randomSelect(hydatis,devid);</div>
<div class="line"><a id="l02131" name="l02131"></a><span class="lineno"> 2131</span>                this-&gt;<a class="code hl_function" href="classMolecule.html#a37f0c2acba7e35455f6128fff194e1a9">dropSingleAtom</a>(rhi);</div>
<div class="line"><a id="l02132" name="l02132"></a><span class="lineno"> 2132</span>                n--;</div>
<div class="line"><a id="l02133" name="l02133"></a><span class="lineno"> 2133</span>                <span class="keywordflow">if</span>(n&gt;0) <a class="code hl_function" href="classMolecule.html#a6351ba55249d7e5659dfbb397dd0e069">makePruneFragment</a>(n,devid);</div>
<div class="line"><a id="l02134" name="l02134"></a><span class="lineno"> 2134</span>                <span class="keywordflow">else</span> this-&gt;<a class="code hl_function" href="classMolecule.html#a72616aa9d293190a9a0372a735f76966">dumpMol</a>(<span class="stringliteral">&quot;prunefrag.pdb&quot;</span>);</div>
<div class="line"><a id="l02135" name="l02135"></a><span class="lineno"> 2135</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l02136" name="l02136"></a><span class="lineno"> 2136</span>            }</div>
<div class="line"><a id="l02137" name="l02137"></a><span class="lineno"> 2137</span>            <span class="keywordflow">else</span> {cout &lt;&lt; <span class="stringliteral">&quot;WARN: Prune fragment generation failed. No terminals to prune. Stopping.\n&quot;</span>; <a class="code hl_function" href="classMolecule.html#a728fa63d31ed43876593086571e82cf6">describeStructure</a>(); <span class="keywordflow">return</span>;}</div>
<div class="line"><a id="l02138" name="l02138"></a><span class="lineno"> 2138</span>        }</div>
<div class="line"><a id="l02139" name="l02139"></a><span class="lineno"> 2139</span>        cout &lt;&lt; <span class="stringliteral">&quot;Terminals:\n&quot;</span>; <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;terms.size();i++) cout&lt;&lt;terms[i]&lt;&lt;<span class="stringliteral">&quot;:&quot;</span>&lt;&lt; atoms[terms[i]]-&gt;toString()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l02140" name="l02140"></a><span class="lineno"> 2140</span>        <span class="keywordtype">int</span> rS=(int)RNG::throwarandompoint(devid,0,terms.size());</div>
<div class="line"><a id="l02141" name="l02141"></a><span class="lineno"> 2141</span>        cout &lt;&lt; <span class="stringliteral">&quot;Chose rS=&quot;</span>&lt;&lt;rS&lt;&lt;<span class="stringliteral">&quot; i.e. &quot;</span>&lt;&lt;terms[rS]&lt;&lt;<span class="stringliteral">&quot;:&quot;</span>&lt;&lt;atoms[terms[rS]]-&gt;toString()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l02142" name="l02142"></a><span class="lineno"> 2142</span>        std::vector&lt;int&gt; erasure(1,terms[rS]); <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; hai : hydats[rS]) erasure.push_back(hai);</div>
<div class="line"><a id="l02143" name="l02143"></a><span class="lineno"> 2143</span>        <span class="keywordtype">int</span> i=-1;</div>
<div class="line"><a id="l02144" name="l02144"></a><span class="lineno"> 2144</span>        <span class="keywordflow">for</span>(i=0;i&lt;bonds[termconns[rS]].size();i++)</div>
<div class="line"><a id="l02145" name="l02145"></a><span class="lineno"> 2145</span>        {</div>
<div class="line"><a id="l02146" name="l02146"></a><span class="lineno"> 2146</span>            <span class="keywordflow">if</span>(bonds[termconns[rS]][i]==terms[rS]) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l02147" name="l02147"></a><span class="lineno"> 2147</span>        }</div>
<div class="line"><a id="l02148" name="l02148"></a><span class="lineno"> 2148</span>        cout &lt;&lt; <span class="stringliteral">&quot;Using bonds of &quot;</span>&lt;&lt;termconns[rS]&lt;&lt;<span class="stringliteral">&quot;:&quot;</span>&lt;&lt;atoms[termconns[rS]]-&gt;toString()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l02149" name="l02149"></a><span class="lineno"> 2149</span>        <span class="keywordflow">if</span>(i&gt;=bonds[termconns[rS]].size()) cout &lt;&lt; <span class="stringliteral">&quot;Failed to find bond for &quot;</span>&lt;&lt;terms[rS]&lt;&lt;<span class="stringliteral">&quot; in: &quot;</span>&lt;&lt;bonds[termconns[rS]]&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l02150" name="l02150"></a><span class="lineno"> 2150</span>        cout &lt;&lt; terms[rS] &lt;&lt; <span class="stringliteral">&quot;:&quot;</span>&lt;&lt;atoms[terms[rS]]-&gt;toString()&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l02151" name="l02151"></a><span class="lineno"> 2151</span>        bonds[termconns[rS]].erase(bonds[termconns[rS]].begin()+i);</div>
<div class="line"><a id="l02152" name="l02152"></a><span class="lineno"> 2152</span>        <span class="keywordflow">if</span>(!atoms[termconns[rS]]-&gt;seek_valency()) freeatoms.push_back(atoms[termconns[rS]]);</div>
<div class="line"><a id="l02153" name="l02153"></a><span class="lineno"> 2153</span>        atoms[termconns[rS]]-&gt;setValency(atoms[termconns[rS]]-&gt;seek_valency()+1);</div>
<div class="line"><a id="l02154" name="l02154"></a><span class="lineno"> 2154</span>        <a class="code hl_variable" href="classMolecule.html#ab9512050a395e0ebb8fbba92f0a91222">HC</a>-=hydats[rS].size();</div>
<div class="line"><a id="l02155" name="l02155"></a><span class="lineno"> 2155</span>        <span class="keywordflow">if</span>(VARIEDCOUNT &amp;&amp; VCLIST-&gt;<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(atoms[terms[rS]])) HAC--;</div>
<div class="line"><a id="l02156" name="l02156"></a><span class="lineno"> 2156</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;erasure.size();i++)</div>
<div class="line"><a id="l02157" name="l02157"></a><span class="lineno"> 2157</span>        {</div>
<div class="line"><a id="l02158" name="l02158"></a><span class="lineno"> 2158</span>            <a class="code hl_variable" href="classMolecule.html#adebb2c740099c5db4f14137bb1609877">myBE</a>-=atoms[erasure[i]]-&gt;getEnergyContribution();</div>
<div class="line"><a id="l02159" name="l02159"></a><span class="lineno"> 2159</span>            <a class="code hl_variable" href="classMolecule.html#a6647358091d946bb02dbcf3ce35b7d5e">myHBE</a>-=atoms[erasure[i]]-&gt;getHotspotEnergyContribution();</div>
<div class="line"><a id="l02160" name="l02160"></a><span class="lineno"> 2160</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> deli=0;deli&lt;freeatoms.size();deli++) {<span class="keywordflow">if</span>(freeatoms[deli]==atoms[erasure[i]]) {freeatoms.erase(freeatoms.begin()+deli);<span class="keywordflow">break</span>;}}</div>
<div class="line"><a id="l02161" name="l02161"></a><span class="lineno"> 2161</span>            <span class="keyword">delete</span> atoms[erasure[i]];</div>
<div class="line"><a id="l02162" name="l02162"></a><span class="lineno"> 2162</span>            atoms.erase(atoms.begin()+erasure[i]);</div>
<div class="line"><a id="l02163" name="l02163"></a><span class="lineno"> 2163</span>            bonds.erase(bonds.begin()+erasure[i]);</div>
<div class="line"><a id="l02164" name="l02164"></a><span class="lineno"> 2164</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=i+1;p&lt;erasure.size();p++) {<span class="keywordflow">if</span>(erasure[p]&gt;erasure[i]) erasure[p]--;}</div>
<div class="line"><a id="l02165" name="l02165"></a><span class="lineno"> 2165</span>            <span class="keywordflow">for</span>(std::vector&lt;int&gt;&amp; bv : bonds)</div>
<div class="line"><a id="l02166" name="l02166"></a><span class="lineno"> 2166</span>            {</div>
<div class="line"><a id="l02167" name="l02167"></a><span class="lineno"> 2167</span>                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;bv.size();j++) {<span class="keywordflow">if</span>(bv[j]&gt;erasure[i]) bv[j]--;}</div>
<div class="line"><a id="l02168" name="l02168"></a><span class="lineno"> 2168</span>            }</div>
<div class="line"><a id="l02169" name="l02169"></a><span class="lineno"> 2169</span>        }</div>
<div class="line"><a id="l02170" name="l02170"></a><span class="lineno"> 2170</span>        <a class="code hl_function" href="classMolecule.html#a728fa63d31ed43876593086571e82cf6">describeStructure</a>();</div>
<div class="line"><a id="l02171" name="l02171"></a><span class="lineno"> 2171</span>        n--;</div>
<div class="line"><a id="l02172" name="l02172"></a><span class="lineno"> 2172</span>        <span class="keywordflow">if</span>(n&gt;0) <a class="code hl_function" href="classMolecule.html#a6351ba55249d7e5659dfbb397dd0e069">makePruneFragment</a>(n);</div>
<div class="line"><a id="l02173" name="l02173"></a><span class="lineno"> 2173</span>        <span class="keywordflow">else</span> this-&gt;<a class="code hl_function" href="classMolecule.html#a72616aa9d293190a9a0372a735f76966">dumpMol</a>(<span class="stringliteral">&quot;prunefrag.pdb&quot;</span>);</div>
<div class="line"><a id="l02174" name="l02174"></a><span class="lineno"> 2174</span>    }</div>
<div class="ttc" id="aclassMolecule_html_a37f0c2acba7e35455f6128fff194e1a9"><div class="ttname"><a href="classMolecule.html#a37f0c2acba7e35455f6128fff194e1a9">Molecule::dropSingleAtom</a></div><div class="ttdeci">void dropSingleAtom(int din)</div><div class="ttdoc">This function allows to drop one atom from the molecule. Read well before usage.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l02070">Molecule.hpp:2070</a></div></div>
<div class="ttc" id="aclassMolecule_html_a6351ba55249d7e5659dfbb397dd0e069"><div class="ttname"><a href="classMolecule.html#a6351ba55249d7e5659dfbb397dd0e069">Molecule::makePruneFragment</a></div><div class="ttdeci">void makePruneFragment(int n, int devid=0)</div><div class="ttdoc">This function generates the starting fragment for &quot;pruning&quot; (See algorthim PDF).</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l02096">Molecule.hpp:2096</a></div></div>
<div class="ttc" id="aclassMolecule_html_a728fa63d31ed43876593086571e82cf6"><div class="ttname"><a href="classMolecule.html#a728fa63d31ed43876593086571e82cf6">Molecule::describeStructure</a></div><div class="ttdeci">void describeStructure(std::ostream &amp;outs=std::cout) const</div><div class="ttdoc">Symbolically describe the structure of the molecule.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01563">Molecule.hpp:1563</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abfd8b7d4b46f69a9675e2fcac4397d19" name="abfd8b7d4b46f69a9675e2fcac4397d19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfd8b7d4b46f69a9675e2fcac4397d19">&#9670;&nbsp;</a></span>markCyclizedAtoms()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::markCyclizedAtoms </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mark the atoms which are cyclized. </p>
<p >This sets the "cyclized" flag for the atoms which have formed cycles to "True" </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00842">842</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>    {</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>        std::vector&lt;int&gt; traced;</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>        <span class="keywordtype">int</span> stI=0;</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>        <span class="keywordflow">while</span>(bonds[stI].size()&lt;=1)</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>        {</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>            stI++;</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>            <span class="keywordflow">if</span>(stI&gt;=bonds.size()) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>        }</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>        <span class="keywordflow">if</span>(stI&gt;=bonds.size()) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>        std::vector&lt;int&gt; travpath;</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>        traverseMarkCyclicAtoms(stI,travpath);</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac178106e85c4a667d2c7faa57765d0fb" name="ac178106e85c4a667d2c7faa57765d0fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac178106e85c4a667d2c7faa57765d0fb">&#9670;&nbsp;</a></span>miniRollback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::miniRollback </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> &amp;&#160;</td>
          <td class="paramname"><em>ff</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000044">Deprecated:</a></b></dt><dd>This method is not safe to use. </dd></dl>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000045">Deprecated:</a></b></dt><dd>Rollback partially (only remove those atom types which are unsatisfied). </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01033">1033</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>  {</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>    cout &lt;&lt; atoms.size() &lt;&lt; <span class="stringliteral">&quot; in the beginning\n&quot;</span>;</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : oldatoms)</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>        {</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>            cout &lt;&lt; a-&gt;toString() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>; cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>        }</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>    std::vector&lt;Atom*&gt; newatoms;</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>    std::vector&lt;std::vector&lt;int&gt;&gt; newbonds;</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>    std::vector&lt;std::pair&lt;Atom*,std::vector&lt;Atom*&gt;&gt;&gt; bonddata;</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : atoms) {bonddata.push_back(make_pair(a,<a class="code hl_function" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a>(a)));}</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>    cout &lt;&lt; <span class="stringliteral">&quot;Bond data loaded\n&quot;</span>;</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>    std::vector&lt;Atom*&gt; waste;</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>    <span class="keywordtype">bool</span> passed=<span class="keyword">false</span>;</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>    <span class="keywordflow">while</span>(<span class="keyword">true</span>)</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>    {</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>      cout &lt;&lt; <span class="stringliteral">&quot;Loop: &quot;</span>&lt;&lt;atoms.size() &lt;&lt; <span class="stringliteral">&quot; atoms\n&quot;</span>;</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>      newatoms=std::vector&lt;Atom*&gt;();</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>      newbonds=std::vector&lt;std::vector&lt;int&gt;&gt;();</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++)</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>      {</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>        <span class="keywordflow">if</span>(contains(oldatoms,atoms[i]) || ff.<a class="code hl_function" href="classForceField.html#a365a885eb6f7bc1b154ac2e3c1a0e71e">isSatisfied</a>(atoms[i],<a class="code hl_function" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a>(atoms[i])))</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>        {</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>          newatoms.push_back(atoms[i]);</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>          newbonds.push_back(std::vector&lt;int&gt;());</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>        }</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>        {</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>          waste.push_back(atoms[i]);</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>          cout &lt;&lt; atoms[i]-&gt;toString()&lt;&lt;<span class="stringliteral">&quot; connected to:\t&quot;</span>;</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;bonds[i].size();j++)</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>                    {</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>                        cout &lt;&lt;atoms[bonds[i][j]]-&gt;toString();cout&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>                    }</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>        }</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>      }</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>      <span class="keywordflow">if</span>(newatoms.size()==atoms.size()) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>      cout &lt;&lt; <span class="stringliteral">&quot;\\Loop: &quot;</span>&lt;&lt;newatoms.size()&lt;&lt; <span class="stringliteral">&quot; atoms\n&quot;</span>;</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>      <span class="keywordtype">int</span> K=0;</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++)</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>      {</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>        <span class="keywordflow">if</span>(!contains(newatoms,atoms[i])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j : bonds[i]) {<span class="keywordflow">if</span>(contains(newatoms,atoms[j])) newbonds[K].push_back(j);}</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>        K++;</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>      }</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>      atoms=newatoms;</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>      bonds=newbonds;</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>    }</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : waste)</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>    {</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>      <span class="comment">//if(a) cout &lt;&lt; &quot;Deleting: &quot;&lt;&lt; a-&gt;toString()&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>      <span class="keyword">delete</span> a;</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>    }</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>    cout &lt;&lt; <span class="stringliteral">&quot;Atoms fixed \tand\t&quot;</span>;</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>    <span class="comment">/*for(int i=0;i&lt;atoms.size();i++) newbonds.push_back(std::vector&lt;int&gt;());</span></div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span><span class="comment">    for(int i=0;i&lt;atoms.size();i++)</span></div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span><span class="comment">    {</span></div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span><span class="comment">      for(int j=i+1;j&lt;atoms.size();j++)</span></div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span><span class="comment">      {</span></div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span><span class="comment">        if(contains(findByKey(bonddata,atoms[i]),atoms[j])) newbonds[i].push_back(j);</span></div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span><span class="comment">        if(contains(findByKey(bonddata,atoms[j]),atoms[i])) newbonds[j].push_back(i);</span></div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span><span class="comment">      }</span></div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span><span class="comment">    }</span></div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span><span class="comment">    bonds=newbonds;*/</span></div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>    cout &lt;&lt; <span class="stringliteral">&quot;Bonds assigned\n&quot;</span>;</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++)</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>    {</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>      <span class="keywordflow">if</span>(contains(oldatoms,atoms[i])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>      <span class="keywordflow">if</span>(!bonds[i].size())</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>      {</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>        <span class="keyword">delete</span> atoms[i];</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>        atoms.erase(atoms.begin()+i);</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>        bonds.erase(bonds.begin()+i);</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>        i--;</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>      }</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>    }</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++) atoms[i]-&gt;setValency(atoms[i]-&gt;getStandardValency()-bonds[i].size());</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>    cout &lt;&lt; <span class="stringliteral">&quot;Valencies set\n&quot;</span>;</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>    freeatoms=std::vector&lt;Atom*&gt;();</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>    <a class="code hl_variable" href="classMolecule.html#ab9512050a395e0ebb8fbba92f0a91222">HC</a>=0;</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>        <span class="keywordflow">if</span>(VARIEDCOUNT) HAC=0;</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : atoms)</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>    {</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>      <span class="keywordflow">if</span>(a-&gt;canBond()) freeatoms.push_back(a);</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>      <span class="keywordflow">if</span>(a-&gt;isHydrogen()) <a class="code hl_variable" href="classMolecule.html#ab9512050a395e0ebb8fbba92f0a91222">HC</a>++;</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>            <span class="keywordflow">if</span>(VARIEDCOUNT &amp;&amp; VCLIST-&gt;<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(a)) HAC++;</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>    }</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>    cout &lt;&lt; atoms.size() &lt;&lt; <span class="stringliteral">&quot; atoms left\n&quot;</span>;</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>    <span class="comment">//for(Atom* a : atoms) cout &lt;&lt; a-&gt;toString() &lt;&lt; &quot;,&quot;; cout &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>    <a class="code hl_variable" href="classMolecule.html#acf710157d0a2da0d5d7bab8d658c39be">trialmode</a>=<span class="keyword">false</span>;</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>  }</div>
<div class="ttc" id="aclassForceField_html_a365a885eb6f7bc1b154ac2e3c1a0e71e"><div class="ttname"><a href="classForceField.html#a365a885eb6f7bc1b154ac2e3c1a0e71e">ForceField::isSatisfied</a></div><div class="ttdeci">bool isSatisfied(Atom *a, const std::vector&lt; Atom * &gt; &amp;bnd) const</div><div class="ttdoc">Uses the rules loaded into this ForceField to check if an atom (with the bonds supplied) satisfies al...</div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00513">forcefield.hpp:513</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3457de95adc23d040a6545a8b783dd32" name="a3457de95adc23d040a6545a8b783dd32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3457de95adc23d040a6545a8b783dd32">&#9670;&nbsp;</a></span>quickLocate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; int &gt; Molecule::quickLocate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>latind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>startatin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int &gt;&#160;</td>
          <td class="paramname"><em>passed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Locate the closest path joining the atoms at the two indices without passing through the given list of atoms (Used to find path when cyclization occurs) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">latind</td><td>Target atom index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">startatin</td><td>Starting atom index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">passed</td><td>vector of atoms which must not be in the path. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01576">1576</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span>  {</div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span>    <span class="comment">//std::vector&lt;int&gt; passed=passin;</span></div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>    passed.push_back(startatin);</div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; j : bonds[startatin])</div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span>    {</div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span>      <span class="keywordflow">if</span>(j==latind) <span class="keywordflow">return</span> passed;</div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>      <span class="keywordflow">if</span>(contains(passed,j)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>      <span class="keywordflow">try</span> {<span class="keywordflow">return</span> <a class="code hl_function" href="classMolecule.html#a3457de95adc23d040a6545a8b783dd32">quickLocate</a>(latind,j,passed);}</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>      <span class="keywordflow">catch</span>(<a class="code hl_class" href="classNoPathPossibleException.html">NoPathPossibleException</a> ex) {<span class="keywordflow">continue</span>;}</div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>    }</div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classNoPathPossibleException.html">NoPathPossibleException</a>();</div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>  }</div>
<div class="ttc" id="aclassMolecule_html_a3457de95adc23d040a6545a8b783dd32"><div class="ttname"><a href="classMolecule.html#a3457de95adc23d040a6545a8b783dd32">Molecule::quickLocate</a></div><div class="ttdeci">std::vector&lt; int &gt; quickLocate(int latind, int startatin, std::vector&lt; int &gt; passed)</div><div class="ttdoc">Locate the closest path joining the atoms at the two indices without passing through the given list o...</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01576">Molecule.hpp:1576</a></div></div>
<div class="ttc" id="aclassNoPathPossibleException_html"><div class="ttname"><a href="classNoPathPossibleException.html">NoPathPossibleException</a></div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00067">Molecule.hpp:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab0beb758c9101529938d5fdab3ed3f86" name="ab0beb758c9101529938d5fdab3ed3f86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0beb758c9101529938d5fdab3ed3f86">&#9670;&nbsp;</a></span>reduce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Molecule::reduce </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSystem.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trials</em> = <code>15</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>forced</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>devid</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Complete all valencies by adding hydrogens. </p>
<p >This functions adds hydrogen atoms to all the available valencies of each atom in the molecule. Geometric checks are mild and in the interest of time, exact position of hydrogen atoms are not calculated, which may lead to two overlapping hydrogen atoms from the same parent atom.<br  />
The overlaps can easily be addressed by a simple steepest descent optimization in any molecule viewer (such as Chimera)<br  />
The energy contribution of non-polar hydrogen atoms is very low. If you think certain hydrogen atoms have significant contribution, ensure that they are properly defined in the 'definitions' file. See algorithm PDF for more details. </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l04575">4575</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l04576" name="l04576"></a><span class="lineno"> 4576</span>{</div>
<div class="line"><a id="l04577" name="l04577"></a><span class="lineno"> 4577</span>    cout &lt;&lt; <span class="stringliteral">&quot;Reduction begins: &quot;</span>&lt;&lt;((forced)?<span class="stringliteral">&quot;forced&quot;</span>:<span class="stringliteral">&quot;unforced&quot;</span>)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l04578" name="l04578"></a><span class="lineno"> 4578</span>    <a class="code hl_class" href="classAtom.html">Atom</a> *ha=s.<a class="code hl_variable" href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">ff</a>-&gt;<a class="code hl_function" href="classForceField.html#a388e3f80e59286f915299e61341d078f">getAtom</a>(<span class="stringliteral">&quot;H&quot;</span>),*nxt,*tmp,*aa;</div>
<div class="line"><a id="l04579" name="l04579"></a><span class="lineno"> 4579</span>    <span class="keywordtype">double</span> div,ebe,ehbe;</div>
<div class="line"><a id="l04580" name="l04580"></a><span class="lineno"> 4580</span>    <span class="keywordtype">int</span> h=0;</div>
<div class="line"><a id="l04581" name="l04581"></a><span class="lineno"> 4581</span>    <a class="code hl_class" href="classMolecule.html">Molecule</a>* p = s.<a class="code hl_function" href="classSystem.html#ad9f7387804eeb148d60d439e9a8bd9b2">getProteinMolecule</a>();</div>
<div class="line"><a id="l04582" name="l04582"></a><span class="lineno"> 4582</span>    <span class="keywordtype">int</span> sz=atoms.size(); <span class="keywordflow">if</span>(sz&lt;=2) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l04583" name="l04583"></a><span class="lineno"> 4583</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> I=0;I&lt;sz;I++)</div>
<div class="line"><a id="l04584" name="l04584"></a><span class="lineno"> 4584</span>    {</div>
<div class="line"><a id="l04585" name="l04585"></a><span class="lineno"> 4585</span>        <span class="keywordflow">while</span>(atoms[I] &amp;&amp; atoms[I]-&gt;seek_valency())</div>
<div class="line"><a id="l04586" name="l04586"></a><span class="lineno"> 4586</span>        {</div>
<div class="line"><a id="l04587" name="l04587"></a><span class="lineno"> 4587</span>            <span class="comment">//cout &lt;&lt; atoms[I]-&gt;toString() &lt;&lt; &quot; to be reduced\t&quot;;</span></div>
<div class="line"><a id="l04588" name="l04588"></a><span class="lineno"> 4588</span>            <span class="keywordtype">double</span> blen=0.09;</div>
<div class="line"><a id="l04589" name="l04589"></a><span class="lineno"> 4589</span>            <a class="code hl_class" href="classAtom.html">Atom</a>* ta=(forced)?s.<a class="code hl_variable" href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">ff</a>-&gt;<a class="code hl_function" href="classForceField.html#aab183018c1dce0c5c93e1dd36eccd57e">selectRandomBondableAtomTerminal</a>(atoms[I],ha):s.<a class="code hl_variable" href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">ff</a>-&gt;selectAtomByRule(atoms[I],this-&gt;<a class="code hl_function" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a>(atoms[I]),ha);</div>
<div class="line"><a id="l04590" name="l04590"></a><span class="lineno"> 4590</span>            <span class="keywordflow">if</span>(!ta || !ta-&gt;<a class="code hl_function" href="classAtom.html#a99ed78f1b94d694b0f3fac609fd92934">isHydrogen</a>())</div>
<div class="line"><a id="l04591" name="l04591"></a><span class="lineno"> 4591</span>            {</div>
<div class="line"><a id="l04592" name="l04592"></a><span class="lineno"> 4592</span>                <span class="keywordflow">if</span>(ta) {cout &lt;&lt; <span class="stringliteral">&quot;In reduce: No hydrogen atom to bond to: &quot;</span>&lt;&lt;atoms[I]-&gt;toString() &lt;&lt; <span class="stringliteral">&quot;. Will switch to other terminals\n&quot;</span>; blen=s.<a class="code hl_variable" href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">ff</a>-&gt;<a class="code hl_function" href="classForceField.html#ab19cd0db1e679daf537e06ef3308f721">getBondLength</a>(atoms[I],ta,<span class="keyword">true</span>);}</div>
<div class="line"><a id="l04593" name="l04593"></a><span class="lineno"> 4593</span>                <span class="keywordflow">else</span> { cout &lt;&lt; <span class="stringliteral">&quot;In reduce: No terminal atom to bond to: &quot;</span>&lt;&lt;atoms[I]-&gt;toString() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; <span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l04594" name="l04594"></a><span class="lineno"> 4594</span>            }</div>
<div class="line"><a id="l04595" name="l04595"></a><span class="lineno"> 4595</span>            <a class="code hl_class" href="classAtom.html">Atom</a> *nha=<span class="keyword">nullptr</span>,*eca1=<span class="keyword">nullptr</span>,*eca2=<span class="keyword">nullptr</span>,*dia=<span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l04596" name="l04596"></a><span class="lineno"> 4596</span>            <span class="keywordtype">int</span> nhai=-1,eca1i=-1,eca2i=-1,diai=-1;</div>
<div class="line"><a id="l04597" name="l04597"></a><span class="lineno"> 4597</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;bonds[I].size();i++)</div>
<div class="line"><a id="l04598" name="l04598"></a><span class="lineno"> 4598</span>            {</div>
<div class="line"><a id="l04599" name="l04599"></a><span class="lineno"> 4599</span>                <span class="keywordflow">if</span>(bonds[bonds[I][i]].size()&lt;=1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l04600" name="l04600"></a><span class="lineno"> 4600</span>                nha=atoms[bonds[I][i]]; nhai=bonds[I][i]; <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l04601" name="l04601"></a><span class="lineno"> 4601</span>            }</div>
<div class="line"><a id="l04602" name="l04602"></a><span class="lineno"> 4602</span>            <span class="keywordflow">if</span>(!nha) <span class="comment">//If there is no &quot;heavy&quot; atom connected (rare), choose a random hydrogen atom. If even that is not present, reject reduction altogether for this atom (Lone atom reduction is not allowed)</span></div>
<div class="line"><a id="l04603" name="l04603"></a><span class="lineno"> 4603</span>            {</div>
<div class="line"><a id="l04604" name="l04604"></a><span class="lineno"> 4604</span>                <span class="keywordflow">if</span>(!bonds[I].size()) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l04605" name="l04605"></a><span class="lineno"> 4605</span>                nha=atoms[bonds[I][0]];</div>
<div class="line"><a id="l04606" name="l04606"></a><span class="lineno"> 4606</span>                nhai=bonds[I][0];</div>
<div class="line"><a id="l04607" name="l04607"></a><span class="lineno"> 4607</span>            }</div>
<div class="line"><a id="l04608" name="l04608"></a><span class="lineno"> 4608</span>            <span class="comment">//cout &lt;&lt; &quot;Using: &quot;&lt;&lt;nha-&gt;toString()&lt;&lt;&quot; as the first neighbour\n&quot;;</span></div>
<div class="line"><a id="l04609" name="l04609"></a><span class="lineno"> 4609</span>            Eigen::Vector3d base=atoms[I]-&gt;bondVectorTo(nha);</div>
<div class="line"><a id="l04610" name="l04610"></a><span class="lineno"> 4610</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;bonds[I].size();i++) <span class="comment">//Find 2 more atoms which are bonded to reduction target</span></div>
<div class="line"><a id="l04611" name="l04611"></a><span class="lineno"> 4611</span>            {</div>
<div class="line"><a id="l04612" name="l04612"></a><span class="lineno"> 4612</span>                <span class="keywordflow">if</span>(bonds[I][i]==nhai) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l04613" name="l04613"></a><span class="lineno"> 4613</span>                <span class="keywordflow">if</span>(!eca1) {eca1i=bonds[I][i]; eca1=atoms[eca1i];}</div>
<div class="line"><a id="l04614" name="l04614"></a><span class="lineno"> 4614</span>                <span class="keywordflow">else</span> {eca2i=bonds[I][i]; eca2=atoms[eca2i]; <span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l04615" name="l04615"></a><span class="lineno"> 4615</span>            }</div>
<div class="line"><a id="l04616" name="l04616"></a><span class="lineno"> 4616</span>            <span class="comment">/*cout &lt;&lt; &quot;Looking for other neighbours: &quot;&lt;&lt;(eca1!=nullptr)&lt;&lt;&quot; and &quot;&lt;&lt;(eca2!=nullptr);</span></div>
<div class="line"><a id="l04617" name="l04617"></a><span class="lineno"> 4617</span><span class="comment">            if(eca1) cout &lt;&lt;&quot;\n&quot;&lt;&lt; eca1-&gt;toString() &lt;&lt; &quot;\t&quot;;</span></div>
<div class="line"><a id="l04618" name="l04618"></a><span class="lineno"> 4618</span><span class="comment">            if(eca2) cout &lt;&lt; eca2-&gt;toString();</span></div>
<div class="line"><a id="l04619" name="l04619"></a><span class="lineno"> 4619</span><span class="comment">            cout &lt;&lt; &quot;\n&quot;;*/</span></div>
<div class="line"><a id="l04620" name="l04620"></a><span class="lineno"> 4620</span>            Eigen::Vector3d ref; <span class="keywordtype">double</span> dih=0;</div>
<div class="line"><a id="l04621" name="l04621"></a><span class="lineno"> 4621</span>            <span class="keywordflow">if</span>(bonds[nhai].size()&lt;=1) ref=Eigen::Vector3d(0,0,1);</div>
<div class="line"><a id="l04622" name="l04622"></a><span class="lineno"> 4622</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l04623" name="l04623"></a><span class="lineno"> 4623</span>            {</div>
<div class="line"><a id="l04624" name="l04624"></a><span class="lineno"> 4624</span>                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;bonds[nhai].size();i++)</div>
<div class="line"><a id="l04625" name="l04625"></a><span class="lineno"> 4625</span>                {</div>
<div class="line"><a id="l04626" name="l04626"></a><span class="lineno"> 4626</span>                    <span class="keywordflow">if</span>(bonds[nhai][i]==I) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l04627" name="l04627"></a><span class="lineno"> 4627</span>                    diai=bonds[nhai][i];</div>
<div class="line"><a id="l04628" name="l04628"></a><span class="lineno"> 4628</span>                    dia=atoms[diai];</div>
<div class="line"><a id="l04629" name="l04629"></a><span class="lineno"> 4629</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l04630" name="l04630"></a><span class="lineno"> 4630</span>                }</div>
<div class="line"><a id="l04631" name="l04631"></a><span class="lineno"> 4631</span>                ref=nha-&gt;<a class="code hl_function" href="classAtom.html#a40e4a43205a24f5e64ea0d27994a3efb">bondVectorTo</a>(dia);</div>
<div class="line"><a id="l04632" name="l04632"></a><span class="lineno"> 4632</span>                <span class="keywordflow">if</span>(eca1 &amp;&amp; dia) {dih=<a class="code hl_function" href="namespacechemtools.html#af1bacba692469862a68fec24a291334e">chemtools::getDihedral</a>(eca1,atoms[I],nha,dia); } <span class="comment">// cout &lt;&lt; &quot;Picked dih=&quot;&lt;&lt;dih&lt;&lt;&quot; from calculation &quot;&lt;&lt;eca1-&gt;getPosition().transpose()&lt;&lt;&quot;, &quot;&lt;&lt;atoms[I]-&gt;getPosition().transpose()&lt;&lt;&quot;, &quot;&lt;&lt;nha-&gt;getPosition().transpose()&lt;&lt;&quot; and &quot;&lt;&lt;dia-&gt;getPosition().transpose()&lt;&lt;&quot;\n&quot;;}</span></div>
<div class="line"><a id="l04633" name="l04633"></a><span class="lineno"> 4633</span>            }</div>
<div class="line"><a id="l04634" name="l04634"></a><span class="lineno"> 4634</span>            <span class="keywordtype">int</span> m=1;</div>
<div class="line"><a id="l04635" name="l04635"></a><span class="lineno"> 4635</span>            <span class="keywordflow">switch</span>(atoms[I]-&gt;getStandardValency())</div>
<div class="line"><a id="l04636" name="l04636"></a><span class="lineno"> 4636</span>            {</div>
<div class="line"><a id="l04637" name="l04637"></a><span class="lineno"> 4637</span>                <span class="keywordflow">case</span> 4:</div>
<div class="line"><a id="l04638" name="l04638"></a><span class="lineno"> 4638</span>                    dih+=(2*PI)/3;</div>
<div class="line"><a id="l04639" name="l04639"></a><span class="lineno"> 4639</span>                    m=3;</div>
<div class="line"><a id="l04640" name="l04640"></a><span class="lineno"> 4640</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l04641" name="l04641"></a><span class="lineno"> 4641</span>                <span class="keywordflow">case</span> 3:</div>
<div class="line"><a id="l04642" name="l04642"></a><span class="lineno"> 4642</span>                    dih+=PI;</div>
<div class="line"><a id="l04643" name="l04643"></a><span class="lineno"> 4643</span>                    m=2;</div>
<div class="line"><a id="l04644" name="l04644"></a><span class="lineno"> 4644</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l04645" name="l04645"></a><span class="lineno"> 4645</span>                <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l04646" name="l04646"></a><span class="lineno"> 4646</span>                    m=1;</div>
<div class="line"><a id="l04647" name="l04647"></a><span class="lineno"> 4647</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l04648" name="l04648"></a><span class="lineno"> 4648</span>            }</div>
<div class="line"><a id="l04649" name="l04649"></a><span class="lineno"> 4649</span>            <span class="comment">//cout &lt;&lt;&quot;Under dihedral data: &quot;&lt;&lt;dih&lt;&lt;&quot; with multiplicity &quot;&lt;&lt;m&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l04650" name="l04650"></a><span class="lineno"> 4650</span>            <span class="comment">//cout &lt;&lt;&quot;Under getArcPositions: &quot;&lt;&lt;base.transpose()&lt;&lt;&quot;\t&quot;&lt;&lt;ref.transpose()&lt;&lt;&quot;:\t&quot;&lt;&lt;blen&lt;&lt;&quot;,&quot;&lt;&lt;((atoms[I]-&gt;getStandardValency()==4)?109.5:120)*(PI/180.0)&lt;&lt;&quot;,&quot;&lt;&lt;ForceField::expandMultiplicity(dih,m)&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l04651" name="l04651"></a><span class="lineno"> 4651</span>            std::vector&lt;Eigen::Vector3d&gt; tposes=<a class="code hl_function" href="namespacequickgeom.html#af60aae27d8f525f83c7088e81fcda69f">quickgeom::getArcPositions</a>(base,ref,blen,((atoms[I]-&gt;getStandardValency()==4)?109.5:120)*(PI/180.0),<a class="code hl_function" href="classForceField.html#a0b53370d39b444980839b0b6181ee0cf">ForceField::expandMultiplicity</a>(dih,m),32,devid);</div>
<div class="line"><a id="l04652" name="l04652"></a><span class="lineno"> 4652</span>            <span class="keywordtype">bool</span> acc=<span class="keyword">true</span>;</div>
<div class="line"><a id="l04653" name="l04653"></a><span class="lineno"> 4653</span>            Eigen::Vector3d fpos(0,0,0);</div>
<div class="line"><a id="l04654" name="l04654"></a><span class="lineno"> 4654</span>            <span class="keywordtype">double</span> angs=0,nangs;</div>
<div class="line"><a id="l04655" name="l04655"></a><span class="lineno"> 4655</span>            <span class="keywordflow">for</span>(Eigen::Vector3d&amp; v : tposes)</div>
<div class="line"><a id="l04656" name="l04656"></a><span class="lineno"> 4656</span>            {</div>
<div class="line"><a id="l04657" name="l04657"></a><span class="lineno"> 4657</span>                ta-&gt;<a class="code hl_function" href="classAtom.html#a34fc2756d0f817a9ee6cf91c797d8bcc">setPosition</a>(atoms[I]-&gt;getPosition()+v);</div>
<div class="line"><a id="l04658" name="l04658"></a><span class="lineno"> 4658</span>                acc=<span class="keyword">true</span>;</div>
<div class="line"><a id="l04659" name="l04659"></a><span class="lineno"> 4659</span>                nangs=0;</div>
<div class="line"><a id="l04660" name="l04660"></a><span class="lineno"> 4660</span>                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;bonds[I].size();i++)</div>
<div class="line"><a id="l04661" name="l04661"></a><span class="lineno"> 4661</span>                {</div>
<div class="line"><a id="l04662" name="l04662"></a><span class="lineno"> 4662</span>                    <span class="keywordflow">if</span>(atoms[bonds[I][i]]-&gt;distanceFrom(ta)&lt;RCUT/1.5) {acc=<span class="keyword">false</span>; <span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l04663" name="l04663"></a><span class="lineno"> 4663</span>                    nangs+=<a class="code hl_function" href="namespacechemtools.html#a330bbc0a28d98a7b8d22150d8e590050">chemtools::getAngle</a>(ta,atoms[I],atoms[bonds[I][i]]);</div>
<div class="line"><a id="l04664" name="l04664"></a><span class="lineno"> 4664</span>                    <span class="comment">//cout &lt;&lt; chemtools::getAngle(ta,atoms[I],atoms[bonds[I][i]]) &lt;&lt;&quot; for angle: &quot;&lt;&lt;ta-&gt;toString()&lt;&lt;&quot;*-&quot;&lt;&lt;atoms[I]-&gt;toString()&lt;&lt;&quot;-&quot;&lt;&lt;atoms[bonds[I][i]]-&gt;toString()&lt;&lt;&quot;,\t&quot;;</span></div>
<div class="line"><a id="l04665" name="l04665"></a><span class="lineno"> 4665</span>                }</div>
<div class="line"><a id="l04666" name="l04666"></a><span class="lineno"> 4666</span>                <span class="comment">//cout &lt;&lt; &quot; as nangs against &quot;&lt;&lt;angs&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l04667" name="l04667"></a><span class="lineno"> 4667</span>                <span class="keywordflow">if</span>(!acc || nangs&lt;angs) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l04668" name="l04668"></a><span class="lineno"> 4668</span>                angs=nangs;</div>
<div class="line"><a id="l04669" name="l04669"></a><span class="lineno"> 4669</span>                fpos=ta-&gt;<a class="code hl_function" href="classAtom.html#a73b92d7b24611f250127856e3b52ed31">getPosition</a>();</div>
<div class="line"><a id="l04670" name="l04670"></a><span class="lineno"> 4670</span>            }</div>
<div class="line"><a id="l04671" name="l04671"></a><span class="lineno"> 4671</span>            <span class="keywordflow">if</span>(!angs) {cout &lt;&lt; <span class="stringliteral">&quot;Failed to reduce: &quot;</span>&lt;&lt;atoms[I]-&gt;toString()&lt;&lt;<span class="stringliteral">&quot; with std. valency: &quot;</span>+to_string(atoms[I]-&gt;getStandardValency())+<span class="stringliteral">&quot;\n&quot;</span>; <span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l04672" name="l04672"></a><span class="lineno"> 4672</span>            ta-&gt;<a class="code hl_function" href="classAtom.html#a34fc2756d0f817a9ee6cf91c797d8bcc">setPosition</a>(fpos);</div>
<div class="line"><a id="l04673" name="l04673"></a><span class="lineno"> 4673</span>            <a class="code hl_function" href="classMolecule.html#aebc4ac8f4a68e24dbb0720402798ca4e">bondAtom</a>(ta,atoms[I]);</div>
<div class="line"><a id="l04674" name="l04674"></a><span class="lineno"> 4674</span>            <span class="keywordflow">if</span>(p)</div>
<div class="line"><a id="l04675" name="l04675"></a><span class="lineno"> 4675</span>            {</div>
<div class="line"><a id="l04676" name="l04676"></a><span class="lineno"> 4676</span>                <span class="keyword">const</span> <span class="keyword">auto</span>&amp; ptr=((<a class="code hl_class" href="classProtein.html">Protein</a>*)p)-&gt;calculateNonBondingEnergy(ta);</div>
<div class="line"><a id="l04677" name="l04677"></a><span class="lineno"> 4677</span>                ebe=get&lt;0&gt;(ptr);</div>
<div class="line"><a id="l04678" name="l04678"></a><span class="lineno"> 4678</span>                ehbe=get&lt;1&gt;(ptr);</div>
<div class="line"><a id="l04679" name="l04679"></a><span class="lineno"> 4679</span>                <a class="code hl_variable" href="classMolecule.html#adebb2c740099c5db4f14137bb1609877">myBE</a>+=(ta-&gt;<a class="code hl_function" href="classAtom.html#a6054acec965e008ad281764b7b4e5f5d">setEnergyContribution</a>(ebe));</div>
<div class="line"><a id="l04680" name="l04680"></a><span class="lineno"> 4680</span>                <a class="code hl_variable" href="classMolecule.html#a6647358091d946bb02dbcf3ce35b7d5e">myHBE</a>+=(ta-&gt;<a class="code hl_function" href="classAtom.html#a6e6ad3000e35fb4f424f9e82ac414311">setHotspotEnergyContribution</a>(ehbe));</div>
<div class="line"><a id="l04681" name="l04681"></a><span class="lineno"> 4681</span>            }</div>
<div class="line"><a id="l04682" name="l04682"></a><span class="lineno"> 4682</span>            <span class="keywordflow">if</span>(!QUIET) cout &lt;&lt; <span class="stringliteral">&quot;Added a hydrogen atom. Left: &quot;</span>&lt;&lt;atoms[I]-&gt;seek_valency()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l04683" name="l04683"></a><span class="lineno"> 4683</span>            h++;</div>
<div class="line"><a id="l04684" name="l04684"></a><span class="lineno"> 4684</span>        }</div>
<div class="line"><a id="l04685" name="l04685"></a><span class="lineno"> 4685</span>    }</div>
<div class="line"><a id="l04686" name="l04686"></a><span class="lineno"> 4686</span>    <span class="keywordflow">if</span>(!QUIET) cout &lt;&lt; h &lt;&lt; <span class="stringliteral">&quot; hydrogen atoms added.\n&quot;</span>;</div>
<div class="line"><a id="l04687" name="l04687"></a><span class="lineno"> 4687</span>    <span class="keywordflow">if</span>(ha) <span class="keyword">delete</span> ha;</div>
<div class="line"><a id="l04688" name="l04688"></a><span class="lineno"> 4688</span>    cout &lt;&lt; <span class="stringliteral">&quot;Reduction ends: &quot;</span>&lt;&lt;((forced)?<span class="stringliteral">&quot;forced&quot;</span>:<span class="stringliteral">&quot;unforced&quot;</span>)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l04689" name="l04689"></a><span class="lineno"> 4689</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : atoms)</div>
<div class="line"><a id="l04690" name="l04690"></a><span class="lineno"> 4690</span>    {</div>
<div class="line"><a id="l04691" name="l04691"></a><span class="lineno"> 4691</span>        <span class="keywordflow">if</span>(a-&gt;getPosition()[0]!=a-&gt;getPosition()[0])</div>
<div class="line"><a id="l04692" name="l04692"></a><span class="lineno"> 4692</span>        {</div>
<div class="line"><a id="l04693" name="l04693"></a><span class="lineno"> 4693</span>            cout &lt;&lt; <span class="stringliteral">&quot;Bad Hydrogen Atom Placement\n&quot;</span>;</div>
<div class="line"><a id="l04694" name="l04694"></a><span class="lineno"> 4694</span>            this-&gt;<a class="code hl_function" href="classMolecule.html#a72616aa9d293190a9a0372a735f76966">dumpMol</a>(<span class="stringliteral">&quot;badred.pdb&quot;</span>,s.<a class="code hl_variable" href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">ff</a>);</div>
<div class="line"><a id="l04695" name="l04695"></a><span class="lineno"> 4695</span>            <span class="keywordflow">throw</span> <a class="code hl_class" href="classNoPositionAvailableException.html">NoPositionAvailableException</a>(); <span class="comment">//Might remove this later on</span></div>
<div class="line"><a id="l04696" name="l04696"></a><span class="lineno"> 4696</span>        }</div>
<div class="line"><a id="l04697" name="l04697"></a><span class="lineno"> 4697</span>    }</div>
<div class="line"><a id="l04698" name="l04698"></a><span class="lineno"> 4698</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l04699" name="l04699"></a><span class="lineno"> 4699</span>}</div>
<div class="ttc" id="aclassAtom_html_a34fc2756d0f817a9ee6cf91c797d8bcc"><div class="ttname"><a href="classAtom.html#a34fc2756d0f817a9ee6cf91c797d8bcc">Atom::setPosition</a></div><div class="ttdeci">void setPosition(const Eigen::Vector3d &amp;v)</div><div class="ttdoc">Allows setting the position of the atom by providing an &quot;Eigen::Vector3d&quot; object.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00386">Atom.hpp:386</a></div></div>
<div class="ttc" id="aclassAtom_html_a40e4a43205a24f5e64ea0d27994a3efb"><div class="ttname"><a href="classAtom.html#a40e4a43205a24f5e64ea0d27994a3efb">Atom::bondVectorTo</a></div><div class="ttdeci">Eigen::Vector3d bondVectorTo(Atom *a) const</div><div class="ttdoc">Get a vector from this atom to 'a'.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00390">Atom.hpp:390</a></div></div>
<div class="ttc" id="aclassAtom_html_a6054acec965e008ad281764b7b4e5f5d"><div class="ttname"><a href="classAtom.html#a6054acec965e008ad281764b7b4e5f5d">Atom::setEnergyContribution</a></div><div class="ttdeci">double setEnergyContribution(double e)</div><div class="ttdoc">Do NOT use this method directly. It manually sets the interaction energy of this atom to the Protein ...</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00189">Atom.hpp:189</a></div></div>
<div class="ttc" id="aclassAtom_html_a6e6ad3000e35fb4f424f9e82ac414311"><div class="ttname"><a href="classAtom.html#a6e6ad3000e35fb4f424f9e82ac414311">Atom::setHotspotEnergyContribution</a></div><div class="ttdeci">double setHotspotEnergyContribution(double e)</div><div class="ttdoc">Do NOT use this method directly. It manually sets the interaction energy of this atom to the &quot;hotspot...</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00197">Atom.hpp:197</a></div></div>
<div class="ttc" id="aclassAtom_html_a73b92d7b24611f250127856e3b52ed31"><div class="ttname"><a href="classAtom.html#a73b92d7b24611f250127856e3b52ed31">Atom::getPosition</a></div><div class="ttdeci">Eigen::Vector3d getPosition() const</div><div class="ttdoc">Returns this complete position of the enitre atom in an &quot;Eigen::Vector3d&quot; object.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00385">Atom.hpp:385</a></div></div>
<div class="ttc" id="aclassForceField_html_a0b53370d39b444980839b0b6181ee0cf"><div class="ttname"><a href="classForceField.html#a0b53370d39b444980839b0b6181ee0cf">ForceField::expandMultiplicity</a></div><div class="ttdeci">static std::vector&lt; double &gt; expandMultiplicity(double v, int m)</div><div class="ttdoc">Expand dihedral multiplicity to explicitly write down the allowed dihedrals. See algorithm PDF (the d...</div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00794">forcefield.hpp:794</a></div></div>
<div class="ttc" id="aclassForceField_html_a388e3f80e59286f915299e61341d078f"><div class="ttname"><a href="classForceField.html#a388e3f80e59286f915299e61341d078f">ForceField::getAtom</a></div><div class="ttdeci">Atom * getAtom(const std::string &amp;s) const</div><div class="ttdoc">Get a copy of an atom-type loaded into this ForceField by name.</div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00540">forcefield.hpp:540</a></div></div>
<div class="ttc" id="aclassForceField_html_aab183018c1dce0c5c93e1dd36eccd57e"><div class="ttname"><a href="classForceField.html#aab183018c1dce0c5c93e1dd36eccd57e">ForceField::selectRandomBondableAtomTerminal</a></div><div class="ttdeci">Atom * selectRandomBondableAtomTerminal(Atom *a, Atom *bias=nullptr) const</div><div class="ttdoc">Get a random terminal atom that can bond to this atom but bias the output.</div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00628">forcefield.hpp:628</a></div></div>
<div class="ttc" id="aclassForceField_html_ab19cd0db1e679daf537e06ef3308f721"><div class="ttname"><a href="classForceField.html#ab19cd0db1e679daf537e06ef3308f721">ForceField::getBondLength</a></div><div class="ttdeci">double getBondLength(Atom *a1, Atom *a2, bool silent=false) const</div><div class="ttdoc">Get the bond length for the bond between two atom types.</div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00856">forcefield.hpp:856</a></div></div>
<div class="ttc" id="aclassMolecule_html_aebc4ac8f4a68e24dbb0720402798ca4e"><div class="ttname"><a href="classMolecule.html#aebc4ac8f4a68e24dbb0720402798ca4e">Molecule::bondAtom</a></div><div class="ttdeci">bool bondAtom(Atom *natm, Atom *src)</div><div class="ttdoc">Add an atom to the molecule by bonding it to a pre-existing atom of the molecule.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01164">Molecule.hpp:1164</a></div></div>
<div class="ttc" id="aclassNoPositionAvailableException_html"><div class="ttname"><a href="classNoPositionAvailableException.html">NoPositionAvailableException</a></div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00065">Molecule.hpp:65</a></div></div>
<div class="ttc" id="aclassSystem_html_a9e485ee26141788c9f971a47703bb4a0"><div class="ttname"><a href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">System::ff</a></div><div class="ttdeci">const ForceField * ff</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00116">Molecule.hpp:116</a></div></div>
<div class="ttc" id="aclassSystem_html_ad9f7387804eeb148d60d439e9a8bd9b2"><div class="ttname"><a href="classSystem.html#ad9f7387804eeb148d60d439e9a8bd9b2">System::getProteinMolecule</a></div><div class="ttdeci">Protein * getProteinMolecule() const</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l03998">Molecule.hpp:3998</a></div></div>
<div class="ttc" id="anamespacechemtools_html_a330bbc0a28d98a7b8d22150d8e590050"><div class="ttname"><a href="namespacechemtools.html#a330bbc0a28d98a7b8d22150d8e590050">chemtools::getAngle</a></div><div class="ttdeci">static double getAngle(Atom *a1, Atom *a2, Atom *a3)</div><div class="ttdoc">Calculate the angle between any three atoms.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00471">Atom.hpp:471</a></div></div>
<div class="ttc" id="anamespacechemtools_html_af1bacba692469862a68fec24a291334e"><div class="ttname"><a href="namespacechemtools.html#af1bacba692469862a68fec24a291334e">chemtools::getDihedral</a></div><div class="ttdeci">static double getDihedral(Atom *a1, Atom *a2, Atom *a3, Atom *a4)</div><div class="ttdoc">Calculate the dihedral between any four atoms.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00473">Atom.hpp:473</a></div></div>
<div class="ttc" id="anamespacequickgeom_html_af60aae27d8f525f83c7088e81fcda69f"><div class="ttname"><a href="namespacequickgeom.html#af60aae27d8f525f83c7088e81fcda69f">quickgeom::getArcPositions</a></div><div class="ttdeci">static std::vector&lt; Eigen::Vector3d &gt; getArcPositions(const Eigen::Vector3d &amp;fixed, const Eigen::Vector3d &amp;def, double length, double angle, const std::vector&lt; double &gt; &amp;dihedral, int num=10, int devid=0)</div><div class="ttdoc">The function used for generating trial positions with a given length, angle and set of allowed dihedr...</div><div class="ttdef"><b>Definition:</b> <a href="commons_8h_source.html#l00559">commons.h:559</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af86a46bfed0f76534eb11a2016371f13" name="af86a46bfed0f76534eb11a2016371f13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af86a46bfed0f76534eb11a2016371f13">&#9670;&nbsp;</a></span>rollback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::rollback </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSystem.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Restore original molecule. All changes from the last call of <a class="el" href="classMolecule.html#ab89456b4f7e16d7cbf6025f0389f5d10" title="Start trial mode.">startTrials()</a> will be deleted. </p>
<p >This method marks the end of "trial mode". All changes are reverted back and trial mode is switched off.<br  />
See Also: <a class="el" href="classMolecule.html#a04b2de48ba4c22b9bef6ca8aec90c1f9" title="Save all changes and end trial mode.">commit()</a> </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l04092">4092</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l04093" name="l04093"></a><span class="lineno"> 4093</span>{</div>
<div class="line"><a id="l04094" name="l04094"></a><span class="lineno"> 4094</span>  <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : atoms)</div>
<div class="line"><a id="l04095" name="l04095"></a><span class="lineno"> 4095</span>    {</div>
<div class="line"><a id="l04096" name="l04096"></a><span class="lineno"> 4096</span>        <span class="keywordflow">if</span>(!contains(oldatoms,a))</div>
<div class="line"><a id="l04097" name="l04097"></a><span class="lineno"> 4097</span>        {</div>
<div class="line"><a id="l04098" name="l04098"></a><span class="lineno"> 4098</span>            <span class="keywordflow">if</span>(!QUIET) cout &lt;&lt; <span class="stringliteral">&quot;Deleting: &quot;</span>&lt;&lt;a-&gt;toString()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l04099" name="l04099"></a><span class="lineno"> 4099</span>            <span class="keyword">delete</span> a;</div>
<div class="line"><a id="l04100" name="l04100"></a><span class="lineno"> 4100</span>        }</div>
<div class="line"><a id="l04101" name="l04101"></a><span class="lineno"> 4101</span>    } <span class="comment">//Freeing memory</span></div>
<div class="line"><a id="l04102" name="l04102"></a><span class="lineno"> 4102</span>  atoms=oldatoms;</div>
<div class="line"><a id="l04103" name="l04103"></a><span class="lineno"> 4103</span>  bonds=oldbonds;</div>
<div class="line"><a id="l04104" name="l04104"></a><span class="lineno"> 4104</span>  freeatoms=oldfreeatoms;</div>
<div class="line"><a id="l04105" name="l04105"></a><span class="lineno"> 4105</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++) atoms[i]-&gt;setValency(valencies[i]);</div>
<div class="line"><a id="l04106" name="l04106"></a><span class="lineno"> 4106</span>    <a class="code hl_variable" href="classMolecule.html#adebb2c740099c5db4f14137bb1609877">myBE</a>=oldbe; <a class="code hl_variable" href="classMolecule.html#a6647358091d946bb02dbcf3ce35b7d5e">myHBE</a>=oldhbe;</div>
<div class="line"><a id="l04107" name="l04107"></a><span class="lineno"> 4107</span>    <a class="code hl_variable" href="classMolecule.html#a6b1f799908a9d52d7194d07ac6bb28d3">errBE</a>=olderrbe; <a class="code hl_variable" href="classMolecule.html#a32075500340345439d0d4912e26fb44f">errHBE</a>=olderrhbe;</div>
<div class="line"><a id="l04108" name="l04108"></a><span class="lineno"> 4108</span>    <a class="code hl_variable" href="classMolecule.html#ab9512050a395e0ebb8fbba92f0a91222">HC</a>=oldHC;</div>
<div class="line"><a id="l04109" name="l04109"></a><span class="lineno"> 4109</span>    <span class="keywordflow">if</span>(VARIEDCOUNT) HAC=oldHAC;</div>
<div class="line"><a id="l04110" name="l04110"></a><span class="lineno"> 4110</span>    cycles=oldcycles;</div>
<div class="line"><a id="l04111" name="l04111"></a><span class="lineno"> 4111</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : atoms)</div>
<div class="line"><a id="l04112" name="l04112"></a><span class="lineno"> 4112</span>    {</div>
<div class="line"><a id="l04113" name="l04113"></a><span class="lineno"> 4113</span>        <span class="keywordflow">if</span>(!a-&gt;isCyclized() || a-&gt;isCycleStatic()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l04114" name="l04114"></a><span class="lineno"> 4114</span>        <span class="keywordtype">bool</span> fnd=<span class="keyword">false</span>;</div>
<div class="line"><a id="l04115" name="l04115"></a><span class="lineno"> 4115</span>        <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; cyc : cycles) {<span class="keywordflow">if</span>(contains(cyc,a)) {fnd=<span class="keyword">true</span>; <span class="keywordflow">break</span>;}}</div>
<div class="line"><a id="l04116" name="l04116"></a><span class="lineno"> 4116</span>        <span class="keywordflow">if</span>(!fnd) a-&gt;setCyclized(<span class="keyword">false</span>);</div>
<div class="line"><a id="l04117" name="l04117"></a><span class="lineno"> 4117</span>    }</div>
<div class="line"><a id="l04118" name="l04118"></a><span class="lineno"> 4118</span>  <span class="comment">/*double hse=0;</span></div>
<div class="line"><a id="l04119" name="l04119"></a><span class="lineno"> 4119</span><span class="comment">  for(Molecule* m : s.getMolecules())</span></div>
<div class="line"><a id="l04120" name="l04120"></a><span class="lineno"> 4120</span><span class="comment">  {</span></div>
<div class="line"><a id="l04121" name="l04121"></a><span class="lineno"> 4121</span><span class="comment">    if(m-&gt;type!=1) continue; //If not protein, ignore</span></div>
<div class="line"><a id="l04122" name="l04122"></a><span class="lineno"> 4122</span><span class="comment">    myBE=((Protein*)m)-&gt;calculateNonBondingEnergy(this);</span></div>
<div class="line"><a id="l04123" name="l04123"></a><span class="lineno"> 4123</span><span class="comment">    hse+=((Protein*)m)-&gt;getHotspotBindingEnergy();</span></div>
<div class="line"><a id="l04124" name="l04124"></a><span class="lineno"> 4124</span><span class="comment">  }</span></div>
<div class="line"><a id="l04125" name="l04125"></a><span class="lineno"> 4125</span><span class="comment">  myHBE=hse;*/</span></div>
<div class="line"><a id="l04126" name="l04126"></a><span class="lineno"> 4126</span>  <a class="code hl_variable" href="classMolecule.html#acf710157d0a2da0d5d7bab8d658c39be">trialmode</a>=<span class="keyword">false</span>;</div>
<div class="line"><a id="l04127" name="l04127"></a><span class="lineno"> 4127</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afa6fbeecd0df2fb5a8026895ab57bc60" name="afa6fbeecd0df2fb5a8026895ab57bc60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa6fbeecd0df2fb5a8026895ab57bc60">&#9670;&nbsp;</a></span>rotateDihedralTo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Molecule::rotateDihedralTo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dih</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rotate the dihedral to set it to a particular value. </p>
<p >Provided that the dihedral you have chosen is a bridge bond, the dihedral is rotated (via the smaller side of the dihedral) to match the given value.<br  />
 The algorithm malfunctions if the chosen bond is part of a cycle (i.e. not free to rotate). See <a class="el" href="classMolecule.html#a586d332662ebab7d9c3cdf667d39a901" title="Find all bridge-head atom index pairs for all possible bridges in this molecule.">Molecule::getAllBridgeHeads()</a> to find bridge-head atoms to use for finding freely rotable dihedrals. </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01840">1840</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span>    {</div>
<div class="line"><a id="l01842" name="l01842"></a><span class="lineno"> 1842</span>        <span class="keywordtype">int</span> i1=-1,i2=-1,i3=-1,i4=-1;</div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++)</div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span>        {</div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span>            <span class="keywordflow">if</span>(atoms[i]==a1) i1=i;</div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(atoms[i]==a2) i2=i;</div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(atoms[i]==a3) i3=i;</div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(atoms[i]==a4) i4=i;</div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span>        }</div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span>        <span class="keywordflow">if</span>(i1&gt;=0 &amp;&amp; i2&gt;=0 &amp;&amp; i3&gt;=0 &amp;&amp; i4&gt;=0) <span class="keywordflow">return</span> <a class="code hl_function" href="classMolecule.html#afa6fbeecd0df2fb5a8026895ab57bc60">rotateDihedralTo</a>(i1,i2,i3,i4,dih);</div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span>        <span class="keywordflow">else</span> {cout &lt;&lt; <span class="stringliteral">&quot;In rotateDihedralTo(): Atom chosen is not in given Molecule\n&quot;</span>; cout &lt;&lt; i1&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;i2&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;i3&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;i4&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>; <span class="keywordflow">throw</span> <a class="code hl_class" href="classAtomNotInMoleculeException.html">AtomNotInMoleculeException</a>();}</div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span>    }</div>
<div class="ttc" id="aclassMolecule_html_afa6fbeecd0df2fb5a8026895ab57bc60"><div class="ttname"><a href="classMolecule.html#afa6fbeecd0df2fb5a8026895ab57bc60">Molecule::rotateDihedralTo</a></div><div class="ttdeci">bool rotateDihedralTo(Atom *a1, Atom *a2, Atom *a3, Atom *a4, double dih)</div><div class="ttdoc">Rotate the dihedral to set it to a particular value.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01840">Molecule.hpp:1840</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adbbc84419964e42f958f78219a92b556" name="adbbc84419964e42f958f78219a92b556"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbbc84419964e42f958f78219a92b556">&#9670;&nbsp;</a></span>rotateMolecule()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::rotateMolecule </td>
          <td>(</td>
          <td class="paramtype">const Eigen::Vector3d &amp;&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::Vector3d&#160;</td>
          <td class="paramname"><em>com</em> = <code>Eigen::Vector3d(0,0,0)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rotate the molecule about a given vector by a given angle (in radians). The angle is given by the norm of the vector. </p>
<p >The rotation is by default around the COM. However, you can choose another center, which will remain fixed during rotation.<br  />
 If the COM (i.e. centre for the rotation) is chosen to be an atom's position, that atom remains in the same position (useful for rotating around pivotal atoms). </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01825">1825</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span>    {</div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span>        <span class="keywordflow">if</span>(com(0)==0 &amp;&amp; com(1)==0 &amp;&amp; com(2)==0) com=this-&gt;<a class="code hl_function" href="classMolecule.html#af4ee33c60073cc39d50f316576275a69">getCentreOfMass</a>();</div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span>        <span class="keyword">auto</span> rmat=<a class="code hl_function" href="namespacequickgeom.html#a0c722fa92ca4d7948501f81c1de9f17f">quickgeom::getRotationMatrix</a>(n/n.norm(),n.norm());</div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span>        <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : atoms)</div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>        {</div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span>            Eigen::Vector3d r=a-&gt;getPosition()-com;</div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>            r=rmat*r;</div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>            a-&gt;setPosition(com+r);</div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span>        }</div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span>    }</div>
<div class="ttc" id="aclassMolecule_html_af4ee33c60073cc39d50f316576275a69"><div class="ttname"><a href="classMolecule.html#af4ee33c60073cc39d50f316576275a69">Molecule::getCentreOfMass</a></div><div class="ttdeci">Eigen::Vector3d getCentreOfMass(bool inch=true) const</div><div class="ttdoc">Get the center-of-mass for this molecule. Important when handling the system for mechanics.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01742">Molecule.hpp:1742</a></div></div>
<div class="ttc" id="anamespacequickgeom_html_a0c722fa92ca4d7948501f81c1de9f17f"><div class="ttname"><a href="namespacequickgeom.html#a0c722fa92ca4d7948501f81c1de9f17f">quickgeom::getRotationMatrix</a></div><div class="ttdeci">static auto getRotationMatrix(const Eigen::Vector3d &amp;axis, double angle)</div><div class="ttdoc">Get a rotation matrix for rotation about a particular axis, by a given angle.</div><div class="ttdef"><b>Definition:</b> <a href="commons_8h_source.html#l00519">commons.h:519</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adc8c0ae7c7ce4f851344d9b4b6479602" name="adc8c0ae7c7ce4f851344d9b4b6479602"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc8c0ae7c7ce4f851344d9b4b6479602">&#9670;&nbsp;</a></span>samplegrow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::samplegrow </td>
          <td>(</td>
          <td class="paramtype">ostream &amp;&#160;</td>
          <td class="paramname"><em>logfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSystem.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trials</em> = <code>15</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nupper</em> = <code>90</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>levellim</em> = <code>LEVELLIMIT</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>restr</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>superseed</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>reseed</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>deseed</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMolecule.html">Molecule</a> *&amp;&#160;</td>
          <td class="paramname"><em>common_newroot</em> = <code>NULLMOL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>common_seedlength</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>devid</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The internal growth function which guided the molecule growth. </p>
<p >This function takes in all the necessary parameters to grow one complete molecule. It is this method which is called multiple times by other functions such as generateLigands(), quickPrune(), etc. to complete one generation.<br  />
 It grows one molecule to the given receptor (which must be part of the <a class="el" href="classSystem.html">System</a>), and also stores the interaction energy of the molecule in it. <br  />
 Also, it is this function which starts (and ends) the trial mode. Refer to the algorithm flowchart for complete details of the growth algorithm. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">logfile</td><td>The output stream to write the log to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>The <a class="el" href="classSystem.html">System</a> within which this generation is placed. This provides the temperature for growth, and must also constain this molecule and the receptor. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>The The minimum size upto which to continue growth. <br  />
For other parameters, refer Protein::generateLigands(const ForceField&amp;,int,int,const std::string&amp;,std::vector&lt;Molecule*&gt;,double,double,int,int,int,double,bool,bool,bool,bool,Molecule*,bool,int) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01379">1379</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>  {</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span><span class="preprocessor">        #ifdef REALTIME</span></div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>            this-&gt;<a class="code hl_function" href="classMolecule.html#a72616aa9d293190a9a0372a735f76966">dumpMol</a>(<span class="stringliteral">&quot;seed.pdb&quot;</span>,s.<a class="code hl_variable" href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">ff</a>);</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span><span class="preprocessor">        #endif</span></div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>    <span class="keywordtype">int</span> t=0;</div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>    cout &lt;&lt; <span class="stringliteral">&quot;samplegrow(rigid) begins\n&quot;</span>;</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>    logfile &lt;&lt; <span class="stringliteral">&quot;samplegrow(rigid) begins\n&quot;</span>;</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>    <span class="keywordtype">bool</span> acc=<span class="keyword">true</span>;</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>    <a class="code hl_class" href="classAtom.html">Atom</a>* gP=<span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>    <span class="keywordflow">while</span>(<a class="code hl_function" href="classMolecule.html#a4c6228c3225bd9571ba276841caa7c90">getEffectiveSize</a>()&lt;n)</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>    {</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>      acc=<span class="keyword">true</span>;</div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>      <a class="code hl_function" href="classMolecule.html#ab89456b4f7e16d7cbf6025f0389f5d10">startTrials</a>();</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>        <span class="keywordflow">if</span>(t&gt;trials)</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>            {</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>                cout &lt;&lt; <span class="stringliteral">&quot;Too many failures: \n&quot;</span>; logfile &lt;&lt; <span class="stringliteral">&quot;Too many failures: \n&quot;</span>;</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>            }</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>            <span class="keywordflow">if</span>(superseed &amp;&amp; common_newroot &amp;&amp; freeatoms.size() &amp;&amp; this-&gt;getEffectiveSize()==common_newroot-&gt;<a class="code hl_function" href="classMolecule.html#a4c6228c3225bd9571ba276841caa7c90">getEffectiveSize</a>()) gP=this-&gt;freeatoms[freeatoms.size()-1];</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>        <span class="keywordflow">else</span> gP=<a class="code hl_function" href="classMolecule.html#a50d2a2068fcda1e9676eb5d8e3aac9f2">getRandomBondableAtom</a>();</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>      <span class="keywordflow">if</span>(!gP)</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>            {</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>                cout &lt;&lt; <span class="stringliteral">&quot;Out of valencies\n&quot;</span>;</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span>                logfile &lt;&lt; <span class="stringliteral">&quot;Ended: Out of valencies\n&quot;</span>;</div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>                <a class="code hl_function" href="classMolecule.html#a04b2de48ba4c22b9bef6ca8aec90c1f9">commit</a>();</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>            }</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>      cout &lt;&lt; <span class="stringliteral">&quot;New begin: &quot;</span>; <a class="code hl_function" href="classMolecule.html#a728fa63d31ed43876593086571e82cf6">describeStructure</a>();</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>      <span class="keywordflow">if</span>(<a class="code hl_function" href="classMolecule.html#a2c2caa1e42988fec83ed9101383c2f19">completeAttempt</a>(logfile,s,gP,ATTEMPTTRIALS,nupper,0,levellim,restr,superseed,reseed,deseed,common_newroot,common_seedlength,devid))</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>            {</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>                cout &lt;&lt; <span class="stringliteral">&quot;Commiting: &quot;</span>&lt;&lt;gP-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>                <a class="code hl_function" href="classMolecule.html#a04b2de48ba4c22b9bef6ca8aec90c1f9">commit</a>(); t=0;</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>            }</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>      {</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>        cout &lt;&lt; <span class="stringliteral">&quot;Rollback\n&quot;</span>;</div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>        <span class="comment">//this-&gt;dumpMol(&quot;pre_rolledback.pdb&quot;);</span></div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span>        <a class="code hl_function" href="classMolecule.html#af86a46bfed0f76534eb11a2016371f13">rollback</a>(s);</div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span><span class="preprocessor">                #ifdef REALTIME</span></div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>            this-&gt;<a class="code hl_function" href="classMolecule.html#a72616aa9d293190a9a0372a735f76966">dumpMol</a>(<span class="stringliteral">&quot;rolledback.pdb&quot;</span>,s.<a class="code hl_variable" href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">ff</a>);</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>                    this-&gt;<a class="code hl_function" href="classMolecule.html#a72616aa9d293190a9a0372a735f76966">dumpMol</a>(<span class="stringliteral">&quot;realtime.pdb&quot;</span>,s.<a class="code hl_variable" href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">ff</a>);</div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>                    usleep(REALTIME*2);</div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span><span class="preprocessor">                #endif</span></div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>        t++;</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>        cout &lt;&lt; <span class="stringliteral">&quot;Rolled back: &quot;</span>;</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>        logfile &lt;&lt; <span class="stringliteral">&quot;Rolled back: &quot;</span>;</div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>        this-&gt;<a class="code hl_function" href="classMolecule.html#a728fa63d31ed43876593086571e82cf6">describeStructure</a>(logfile);</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>      }</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>    }</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span>        <span class="keywordflow">if</span>(this-&gt;<a class="code hl_function" href="classMolecule.html#a4c6228c3225bd9571ba276841caa7c90">getEffectiveSize</a>()&lt;n) <span class="keywordflow">return</span>; <span class="comment">//Don&#39;t waste optimization time on &quot;small&quot; molecules which will be rejected mostly anyway.</span></div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>    <span class="comment">//this-&gt;dumpMol(&quot;pre_reduction.pdb&quot;);</span></div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>        <span class="keywordflow">if</span>(USE_PHYSICS)</div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>        {</div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>            physics::optimizeMolecule(<span class="keyword">this</span>,*s.<a class="code hl_variable" href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">ff</a>,250);</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>            cout &lt;&lt; <span class="stringliteral">&quot;Short Geomtery-optimized molecule!\n&quot;</span>;</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>        }</div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>    <span class="keywordflow">try</span></div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>        {</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>            this-&gt;<a class="code hl_function" href="classMolecule.html#ab0beb758c9101529938d5fdab3ed3f86">reduce</a>(s,trials,<span class="keyword">true</span>,devid);</div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>            <span class="keywordflow">if</span>(FORCE_CHARGES) this-&gt;<a class="code hl_function" href="classMolecule.html#a6b91da44d6681118424a20a4a8ea2b24">uniformChargeAdjustments</a>(this-&gt;<a class="code hl_function" href="classMolecule.html#a69594b093fbb60eabc373d6860f19a87">getNetCharge</a>(*s.<a class="code hl_variable" href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">ff</a>));</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>        }</div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>    <span class="keywordflow">catch</span>(<a class="code hl_class" href="classAtomNotInMoleculeException.html">AtomNotInMoleculeException</a> ex) {this-&gt;<a class="code hl_function" href="classMolecule.html#a72616aa9d293190a9a0372a735f76966">dumpMol</a>(<span class="stringliteral">&quot;pre_reduction.pdb&quot;</span>); std::cout &lt;&lt; <span class="stringliteral">&quot;Crashed with AtomNotInMoleculeException\n&quot;</span>; <span class="keywordflow">throw</span> std::exception();}</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>        <span class="keywordflow">if</span>(USE_PHYSICS)</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>        {</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>        <span class="comment">//physics::gradientDescentPhysics(this);</span></div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span>            physics::optimizeMolecule(<span class="keyword">this</span>,*s.<a class="code hl_variable" href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">ff</a>);</div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>            cout &lt;&lt; <span class="stringliteral">&quot;Well Geomtery-optimized molecule!\n&quot;</span>;</div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>        }</div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>  }</div>
<div class="ttc" id="aclassMolecule_html_a04b2de48ba4c22b9bef6ca8aec90c1f9"><div class="ttname"><a href="classMolecule.html#a04b2de48ba4c22b9bef6ca8aec90c1f9">Molecule::commit</a></div><div class="ttdeci">void commit()</div><div class="ttdoc">Save all changes and end trial mode.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01127">Molecule.hpp:1127</a></div></div>
<div class="ttc" id="aclassMolecule_html_a2c2caa1e42988fec83ed9101383c2f19"><div class="ttname"><a href="classMolecule.html#a2c2caa1e42988fec83ed9101383c2f19">Molecule::completeAttempt</a></div><div class="ttdeci">bool completeAttempt(ostream &amp;logfile, const System &amp;s, Atom *src, int trials=25, int nupper=90, int level=0, int levellim=LEVELLIMIT, bool restr=false, bool superseed=false, bool reseed=false, bool deseed=false, Molecule *&amp;common_newroot=NULLMOL, int common_seedlength=0, int devid=0)</div><div class="ttdoc">Try to satisfy all atom-type requirements. See algorithm details in the PDF containing the flowchart.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01288">Molecule.hpp:1288</a></div></div>
<div class="ttc" id="aclassMolecule_html_a50d2a2068fcda1e9676eb5d8e3aac9f2"><div class="ttname"><a href="classMolecule.html#a50d2a2068fcda1e9676eb5d8e3aac9f2">Molecule::getRandomBondableAtom</a></div><div class="ttdeci">Atom * getRandomBondableAtom() const</div><div class="ttdoc">Randomly select an atom with free valencies.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01134">Molecule.hpp:1134</a></div></div>
<div class="ttc" id="aclassMolecule_html_a69594b093fbb60eabc373d6860f19a87"><div class="ttname"><a href="classMolecule.html#a69594b093fbb60eabc373d6860f19a87">Molecule::getNetCharge</a></div><div class="ttdeci">double getNetCharge(const ForceField &amp;ff) const</div><div class="ttdoc">Get expected charge of a molecule.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01553">Molecule.hpp:1553</a></div></div>
<div class="ttc" id="aclassMolecule_html_a6b91da44d6681118424a20a4a8ea2b24"><div class="ttname"><a href="classMolecule.html#a6b91da44d6681118424a20a4a8ea2b24">Molecule::uniformChargeAdjustments</a></div><div class="ttdeci">void uniformChargeAdjustments(double tchg=0)</div><div class="ttdoc">Sets the net charge of the Molecule by uniformly modifying the charges of all atoms (usually by a sma...</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01539">Molecule.hpp:1539</a></div></div>
<div class="ttc" id="aclassMolecule_html_ab0beb758c9101529938d5fdab3ed3f86"><div class="ttname"><a href="classMolecule.html#ab0beb758c9101529938d5fdab3ed3f86">Molecule::reduce</a></div><div class="ttdeci">bool reduce(const System &amp;s, int trials=15, bool forced=false, int devid=0)</div><div class="ttdoc">Complete all valencies by adding hydrogens.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l04575">Molecule.hpp:4575</a></div></div>
<div class="ttc" id="aclassMolecule_html_ab89456b4f7e16d7cbf6025f0389f5d10"><div class="ttname"><a href="classMolecule.html#ab89456b4f7e16d7cbf6025f0389f5d10">Molecule::startTrials</a></div><div class="ttdeci">void startTrials()</div><div class="ttdoc">Start trial mode.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01018">Molecule.hpp:1018</a></div></div>
<div class="ttc" id="aclassMolecule_html_af86a46bfed0f76534eb11a2016371f13"><div class="ttname"><a href="classMolecule.html#af86a46bfed0f76534eb11a2016371f13">Molecule::rollback</a></div><div class="ttdeci">void rollback(const System &amp;s)</div><div class="ttdoc">Restore original molecule. All changes from the last call of startTrials() will be deleted.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l04092">Molecule.hpp:4092</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a28fd8a15cac9bf3f9df358af8ee07ff0" name="a28fd8a15cac9bf3f9df358af8ee07ff0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28fd8a15cac9bf3f9df358af8ee07ff0">&#9670;&nbsp;</a></span>samplegrowimpartial()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::samplegrowimpartial </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSystem.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trials</em> = <code>15</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000046">Deprecated:</a></b></dt><dd>An old trial method for growth </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01187">1187</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>    {</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>        <span class="keywordtype">int</span> t=0;</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>        <span class="keywordflow">while</span>(<a class="code hl_function" href="classMolecule.html#a4c6228c3225bd9571ba276841caa7c90">getEffectiveSize</a>()&lt;n)</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>        {</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>            <span class="keywordflow">if</span>(t&gt;trials)</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>            {</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>                cout &lt;&lt; <span class="stringliteral">&quot;Too many failures: \n&quot;</span>;</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>            }</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>            <a class="code hl_class" href="classAtom.html">Atom</a>* gP=<a class="code hl_function" href="classMolecule.html#a50d2a2068fcda1e9676eb5d8e3aac9f2">getRandomBondableAtom</a>();</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>            <span class="keyword">auto</span> nbs=s.<a class="code hl_variable" href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">ff</a>-&gt;<a class="code hl_function" href="classForceField.html#a11ef1ec5670fc1755a3ad4618d63d734">getAllowedBonds</a>(gP);</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>            <a class="code hl_class" href="classBondData.html">BondData</a> nb=randomSelect(nbs);</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>            <a class="code hl_class" href="classAtom.html">Atom</a>* nat=nb.<a class="code hl_function" href="classBondData.html#a4a355fdee6e86a2d9906fc880f06082f">getSecond</a>(gP,*s.<a class="code hl_variable" href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">ff</a>);</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>            <span class="comment">//std::vector&lt;Eigen::Vector3d&gt; alposes=</span></div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>            <span class="comment">//if(!alposes.size()) {t++; continue;}</span></div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>            Eigen::Vector3d pos;</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>      <span class="keywordflow">try</span>{pos=get&lt;0&gt;(<a class="code hl_function" href="namespacechemtools.html#ad2f246d4cc40979950344b2e6465fa73">chemtools::getAllowedPositions</a>(gP,<span class="keyword">this</span>,nat,s,15,5)); t=0;}</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>      <span class="keywordflow">catch</span>(<a class="code hl_class" href="classNoPositionAvailableException.html">NoPositionAvailableException</a> ex) {t++; <span class="keywordflow">continue</span>;}</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>            nat-&gt;<a class="code hl_function" href="classAtom.html#a34fc2756d0f817a9ee6cf91c797d8bcc">setPosition</a>(pos);</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>            <a class="code hl_function" href="classMolecule.html#aebc4ac8f4a68e24dbb0720402798ca4e">bondAtom</a>(nat,gP);</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>            <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : atoms)</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>            {</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>                cout &lt;&lt; a-&gt;toString() &lt;&lt; <span class="stringliteral">&quot;(&quot;</span>&lt;&lt;a-&gt;seek_valency()&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>            }</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>            cout &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>            <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : freeatoms)</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>            {</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>                cout &lt;&lt; a-&gt;toString() &lt;&lt; <span class="stringliteral">&quot;(&quot;</span>&lt;&lt;a-&gt;seek_valency()&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>            }</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>            cout &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>        }</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>  }</div>
<div class="ttc" id="aclassBondData_html"><div class="ttname"><a href="classBondData.html">BondData</a></div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00127">forcefield.hpp:128</a></div></div>
<div class="ttc" id="aclassBondData_html_a4a355fdee6e86a2d9906fc880f06082f"><div class="ttname"><a href="classBondData.html#a4a355fdee6e86a2d9906fc880f06082f">BondData::getSecond</a></div><div class="ttdeci">const std::string &amp; getSecond(const std::string &amp;s) const</div><div class="ttdoc">Get the second atom in the pair forming this bond (given one of the two)</div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00147">forcefield.hpp:147</a></div></div>
<div class="ttc" id="aclassForceField_html_a11ef1ec5670fc1755a3ad4618d63d734"><div class="ttname"><a href="classForceField.html#a11ef1ec5670fc1755a3ad4618d63d734">ForceField::getAllowedBonds</a></div><div class="ttdeci">const std::vector&lt; BondData &gt; &amp; getAllowedBonds(Atom *a) const</div><div class="ttdoc">Get a list of all the bonds (as BondData objects) that this atom is allowed to make.</div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00786">forcefield.hpp:786</a></div></div>
<div class="ttc" id="anamespacechemtools_html_ad2f246d4cc40979950344b2e6465fa73"><div class="ttname"><a href="namespacechemtools.html#ad2f246d4cc40979950344b2e6465fa73">chemtools::getAllowedPositions</a></div><div class="ttdeci">static std::pair&lt; Eigen::Vector3d, std::pair&lt; double, double &gt; &gt; getAllowedPositions(Atom *src, Molecule *mol, Atom *natom, const System &amp;ff, int num=10, int tries=10, bool restr=false, const Category *aromcat=nullptr, int devid=0)</div><div class="ttdoc">Get a (boltzmann-factor weighted) random positions from all the trialled positions....</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l04419">Molecule.hpp:4419</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6fb016cb3c6871904bd1e856e40f9fd1" name="a6fb016cb3c6871904bd1e856e40f9fd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fb016cb3c6871904bd1e856e40f9fd1">&#9670;&nbsp;</a></span>samplegrowunrigid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::samplegrowunrigid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSystem.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trials</em> = <code>15</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000048">Deprecated:</a></b></dt><dd>An old trial method for growth </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01237">1237</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>  {</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>    <span class="keywordtype">int</span> t=0;</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>    <a class="code hl_function" href="classMolecule.html#ab89456b4f7e16d7cbf6025f0389f5d10">startTrials</a>();</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>    cout &lt;&lt; <span class="stringliteral">&quot;Samplegrow begins\n&quot;</span>;</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>    <span class="keywordflow">while</span>(<a class="code hl_function" href="classMolecule.html#a4c6228c3225bd9571ba276841caa7c90">getEffectiveSize</a>()&lt;n)</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>    {</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>        <span class="keywordflow">if</span>(t&gt;trials)</div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>            {</div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>                cout &lt;&lt; <span class="stringliteral">&quot;Too many failures: \n&quot;</span>;</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>            }</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>        <a class="code hl_class" href="classAtom.html">Atom</a>* gP=<a class="code hl_function" href="classMolecule.html#a50d2a2068fcda1e9676eb5d8e3aac9f2">getRandomBondableAtom</a>();</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>      <span class="keywordflow">if</span>(!gP)</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>            {</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>                cout &lt;&lt; <span class="stringliteral">&quot;Out of valencies\n&quot;</span>;</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>            }</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>      cout &lt;&lt; gP-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>()&lt;&lt;<span class="stringliteral">&quot;(&quot;</span>&lt;&lt;gP-&gt;<a class="code hl_function" href="classAtom.html#ae2ac3a6ffdc90898d06d05eaf374960e">seek_valency</a>()&lt;&lt;<span class="stringliteral">&quot;) chosen\n&quot;</span>;</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>        <a class="code hl_class" href="classAtom.html">Atom</a>* nat=s.<a class="code hl_variable" href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">ff</a>-&gt;selectAtomByRule(gP,<a class="code hl_function" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a>(gP));</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>        <span class="comment">//if(!alposes.size()) {t++; continue;}</span></div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>      <a class="code hl_class" href="classAtom.html">Atom</a>* nxt;</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>      <span class="keywordflow">if</span>(!<a class="code hl_function" href="classMolecule.html#aaa3f24a1ea27312d39f72d8b4f277058">attempt</a>(s,gP,nat,nxt)) {t++; <span class="keywordflow">continue</span>;}</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>      <a class="code hl_function" href="classMolecule.html#aebc4ac8f4a68e24dbb0720402798ca4e">bondAtom</a>(nat,gP);</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>      <span class="keywordflow">if</span>(nxt)</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>      {</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>        cout &lt;&lt; nat-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>()&lt;&lt; <span class="stringliteral">&quot;-&quot;</span>&lt;&lt;nxt-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>        <a class="code hl_function" href="classMolecule.html#a04b3beb3e333664d6421e9f0ee46dd73">makeBond</a>(nxt,nat);</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>      }</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>      t=0;</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>        <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : atoms)</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>            {</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>                cout &lt;&lt; a-&gt;toString() &lt;&lt; <span class="stringliteral">&quot;(&quot;</span>&lt;&lt;a-&gt;seek_valency()&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>            }</div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>        cout &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>        <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : freeatoms)</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>            {</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>                cout &lt;&lt; a-&gt;toString() &lt;&lt; <span class="stringliteral">&quot;(&quot;</span>&lt;&lt;a-&gt;seek_valency()&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>            }</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>        cout &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>    }</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>    ofstream prf; prf.open(<span class="stringliteral">&quot;prereduction.pdb&quot;</span>,ios::out);</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>    <a class="code hl_function" href="classMolecule.html#a72616aa9d293190a9a0372a735f76966">dumpMol</a>(prf);</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>    prf.close();</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>    <a class="code hl_function" href="classMolecule.html#ab0beb758c9101529938d5fdab3ed3f86">reduce</a>(s);</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>    ofstream rf; rf.open(<span class="stringliteral">&quot;postreduction.pdb&quot;</span>,ios::out);</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>    <a class="code hl_function" href="classMolecule.html#a72616aa9d293190a9a0372a735f76966">dumpMol</a>(rf);</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>    rf.close();</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>    <a class="code hl_function" href="classMolecule.html#ac178106e85c4a667d2c7faa57765d0fb">miniRollback</a>(*s.<a class="code hl_variable" href="classSystem.html#a9e485ee26141788c9f971a47703bb4a0">ff</a>);</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>    }</div>
<div class="ttc" id="aclassAtom_html_ae2ac3a6ffdc90898d06d05eaf374960e"><div class="ttname"><a href="classAtom.html#ae2ac3a6ffdc90898d06d05eaf374960e">Atom::seek_valency</a></div><div class="ttdeci">int seek_valency() const</div><div class="ttdoc">Get the number of free valencies this atom has.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00378">Atom.hpp:378</a></div></div>
<div class="ttc" id="aclassMolecule_html_a04b3beb3e333664d6421e9f0ee46dd73"><div class="ttname"><a href="classMolecule.html#a04b3beb3e333664d6421e9f0ee46dd73">Molecule::makeBond</a></div><div class="ttdeci">void makeBond(Atom *a1, Atom *a2)</div><div class="ttdoc">Join two atoms to make a bond.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01143">Molecule.hpp:1143</a></div></div>
<div class="ttc" id="aclassMolecule_html_aaa3f24a1ea27312d39f72d8b4f277058"><div class="ttname"><a href="classMolecule.html#aaa3f24a1ea27312d39f72d8b4f277058">Molecule::attempt</a></div><div class="ttdeci">bool attempt(const System &amp;s, Atom *gP, Atom *nat, Atom *&amp;nxt, int trials=10, bool restr=false, int nps=0, int devid=0)</div><div class="ttdoc">Attempts to add a new atom to a source atom. See flowchart of algorithm in PDF for more details.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l04138">Molecule.hpp:4138</a></div></div>
<div class="ttc" id="aclassMolecule_html_ac178106e85c4a667d2c7faa57765d0fb"><div class="ttname"><a href="classMolecule.html#ac178106e85c4a667d2c7faa57765d0fb">Molecule::miniRollback</a></div><div class="ttdeci">void miniRollback(const ForceField &amp;ff)</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01033">Molecule.hpp:1033</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa3b73777e17fa7a34d15866fab326cfc" name="aa3b73777e17fa7a34d15866fab326cfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3b73777e17fa7a34d15866fab326cfc">&#9670;&nbsp;</a></span>sealAll()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::sealAll </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>"Caps" all the atoms of this molecule </p>
<p >This method forcibly sets the free-valency count of each atom to 0, rejecting any remaining valencies. This process is referred to (here and later) as "capping"<br  />
It is useful when using a seed molecule which as a lot of free valecies, but the growth is to be targetted from a particular atom<br  />
See also: <a class="el" href="classAtom.html#a1d20924773ee1da9d94477d8917da147" title="Do not allow this atom to make further bonds.">Atom::seal()</a>, <a class="el" href="classMolecule.html#ab6c1f0207db1069de8e3a49a1881e880" title="Manually &quot;frees&quot; a capped or completely valency satisfied atom.">Molecule::free(Atom*,int)</a> </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00958">958</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>    {</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>        <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : freeatoms) a-&gt;seal();</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>        freeatoms=std::vector&lt;Atom*&gt;();</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b70c9d0397e77a4d7305b9dce395887" name="a6b70c9d0397e77a4d7305b9dce395887"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b70c9d0397e77a4d7305b9dce395887">&#9670;&nbsp;</a></span>squareDistance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double Molecule::squareDistance </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>plane</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the sum of squares distances of each atom (including hydrogen atoms) of this molecule to a given plane. </p>
<p >The plane is taken as input in form of a vector (a,b,c,d) which corresponds to the plane "&lt;b&gt;a&lt;/b&gt;x +&lt;b&gt;b&lt;/b&gt;y +&lt;b&gt;c&lt;/b&gt;z = &lt;b&gt;d&lt;/b&gt;".<br  />
 It is a static function which requires the global variable, "Molecule* currmol" to be set to point to the molecule for which this calculation is to be done. </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01807">1807</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span>  {</div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span>    <span class="keywordtype">double</span> d=0,n=plane[0]*plane[0]+plane[1]*plane[1]+plane[2]*plane[2];</div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : currMol-&gt;atoms) d+=sqr(plane[0]*a-&gt;seek_x()+plane[1]*a-&gt;seek_y()+plane[2]*a-&gt;seek_z()-plane[3]);</div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span>    <span class="keywordflow">return</span> d/n;</div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab89456b4f7e16d7cbf6025f0389f5d10" name="ab89456b4f7e16d7cbf6025f0389f5d10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab89456b4f7e16d7cbf6025f0389f5d10">&#9670;&nbsp;</a></span>startTrials()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::startTrials </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Start trial mode. </p>
<p >This method marks the beginning of trial mode. It backs-up the current state of the <a class="el" href="classMolecule.html">Molecule</a> object, and all modifications made from this point are subject to be lost (see <a class="el" href="classMolecule.html#af86a46bfed0f76534eb11a2016371f13" title="Restore original molecule. All changes from the last call of startTrials() will be deleted.">rollback()</a>)<br  />
Trial mode is actively used during generation to allow recoiling when the growth reaches a stage from where it cannot proceed. (See algorithm PDF for more details)<br  />
You cannot use this method twice in a row. This method must be paired with either <a class="el" href="classMolecule.html#a04b2de48ba4c22b9bef6ca8aec90c1f9" title="Save all changes and end trial mode.">commit()</a> or <a class="el" href="classMolecule.html#af86a46bfed0f76534eb11a2016371f13" title="Restore original molecule. All changes from the last call of startTrials() will be deleted.">rollback()</a>, and only after either of these is executed can this function be re-used. Not doing so may lead to an <a class="el" href="classAlreadyInTrialModeException.html">AlreadyInTrialModeException</a> being thrown </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01018">1018</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>    {</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMolecule.html#acf710157d0a2da0d5d7bab8d658c39be">trialmode</a>) <span class="keywordflow">throw</span> <a class="code hl_class" href="classAlreadyInTrialModeException.html">AlreadyInTrialModeException</a>();</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>        oldatoms=atoms; oldbonds=bonds; oldfreeatoms=freeatoms; oldHC=<a class="code hl_variable" href="classMolecule.html#ab9512050a395e0ebb8fbba92f0a91222">HC</a>;</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>        <span class="keywordflow">if</span>(VARIEDCOUNT) oldHAC=HAC;</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>        oldbe=<a class="code hl_variable" href="classMolecule.html#adebb2c740099c5db4f14137bb1609877">myBE</a>; oldhbe=<a class="code hl_variable" href="classMolecule.html#a6647358091d946bb02dbcf3ce35b7d5e">myHBE</a>; olderrbe=<a class="code hl_variable" href="classMolecule.html#a6b1f799908a9d52d7194d07ac6bb28d3">errBE</a>; olderrhbe=<a class="code hl_variable" href="classMolecule.html#a32075500340345439d0d4912e26fb44f">errHBE</a>; oldcycles=cycles; valencies=std::vector&lt;int&gt;(); <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : oldatoms) valencies.push_back(a-&gt;seek_valency());</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>        <a class="code hl_variable" href="classMolecule.html#acf710157d0a2da0d5d7bab8d658c39be">trialmode</a>=<span class="keyword">true</span>;</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>    }</div>
<div class="ttc" id="aclassAlreadyInTrialModeException_html"><div class="ttname"><a href="classAlreadyInTrialModeException.html">AlreadyInTrialModeException</a></div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00063">Molecule.hpp:63</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b91da44d6681118424a20a4a8ea2b24" name="a6b91da44d6681118424a20a4a8ea2b24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b91da44d6681118424a20a4a8ea2b24">&#9670;&nbsp;</a></span>uniformChargeAdjustments()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Molecule::uniformChargeAdjustments </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tchg</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the net charge of the <a class="el" href="classMolecule.html">Molecule</a> by uniformly modifying the charges of all atoms (usually by a small quantity for large enough molecules) </p>
<p >Some atom-types are not perfect in the charge values (especially when repuroposed in two different cases). In this cases there is a minor deviation from the usual charge (0 for neutral molecule), etc.<br  />
 This minor deviation can build up over multiple such atom-types placed over the molecule. This method corrects for it. </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l01539">1539</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>    {</div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span>        <span class="keywordtype">double</span> chg=0; <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++) chg+=atoms[i]-&gt;seek_charge();</div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span>        <span class="keywordflow">if</span>(!QUIET)</div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span>        {</div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>            cout &lt;&lt; <span class="stringliteral">&quot;Net charge on system: &quot;</span>&lt;&lt;chg&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span>            cout &lt;&lt; <span class="stringliteral">&quot;Setting net charge on system to &quot;</span>&lt;&lt;tchg&lt;&lt;<span class="stringliteral">&quot; by uniform charge modification\n&quot;</span>;</div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>        }</div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>        chg=(tchg-chg)/atoms.size();</div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;atoms.size();i++) atoms[i]-&gt;setCharge(atoms[i]-&gt;seek_charge()+chg);</div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a13f21a69f0d90e36bffdc2236e75fff3" name="a13f21a69f0d90e36bffdc2236e75fff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13f21a69f0d90e36bffdc2236e75fff3">&#9670;&nbsp;</a></span>merge</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMolecule.html">Molecule</a> * merge </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMolecule.html">Molecule</a> *&#160;</td>
          <td class="paramname"><em>m1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMolecule.html">Molecule</a> *&#160;</td>
          <td class="paramname"><em>m2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Still under development. Merge two molecules into a single one </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l04190">4190</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l04191" name="l04191"></a><span class="lineno"> 4191</span>{</div>
<div class="line"><a id="l04192" name="l04192"></a><span class="lineno"> 4192</span>  <span class="keywordflow">if</span>(!m1) <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_function" href="classMolecule.html#a7e7d290ae641518ad4c4d5303b519d0f">Molecule</a>(m2);</div>
<div class="line"><a id="l04193" name="l04193"></a><span class="lineno"> 4193</span>  <span class="keywordflow">if</span>(!m2) <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_function" href="classMolecule.html#a7e7d290ae641518ad4c4d5303b519d0f">Molecule</a>(m1);</div>
<div class="line"><a id="l04194" name="l04194"></a><span class="lineno"> 4194</span>  <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_function" href="classMolecule.html#a7e7d290ae641518ad4c4d5303b519d0f">Molecule</a>(m1);</div>
<div class="line"><a id="l04195" name="l04195"></a><span class="lineno"> 4195</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a6b1f799908a9d52d7194d07ac6bb28d3" name="a6b1f799908a9d52d7194d07ac6bb28d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b1f799908a9d52d7194d07ac6bb28d3">&#9670;&nbsp;</a></span>errBE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Molecule::errBE =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Stored binding energy error </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00506">506</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>

</div>
</div>
<a id="a32075500340345439d0d4912e26fb44f" name="a32075500340345439d0d4912e26fb44f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32075500340345439d0d4912e26fb44f">&#9670;&nbsp;</a></span>errHBE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Molecule::errHBE =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Stored binding energy error (specific to hotspot - see <a class="el" href="classProtein.html">Protein</a>) </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00507">507</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>

</div>
</div>
<a id="ab9512050a395e0ebb8fbba92f0a91222" name="ab9512050a395e0ebb8fbba92f0a91222"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9512050a395e0ebb8fbba92f0a91222">&#9670;&nbsp;</a></span>HC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Molecule::HC =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Hydrogen atom count </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00487">487</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>

</div>
</div>
<a id="a87674f540b98a33b4921c4d57b3982fc" name="a87674f540b98a33b4921c4d57b3982fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87674f540b98a33b4921c4d57b3982fc">&#9670;&nbsp;</a></span>ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Molecule::ID =-1</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000041">Deprecated:</a></b></dt><dd>Unique ID of this molecule </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00502">502</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>

</div>
</div>
<a id="adebb2c740099c5db4f14137bb1609877" name="adebb2c740099c5db4f14137bb1609877"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adebb2c740099c5db4f14137bb1609877">&#9670;&nbsp;</a></span>myBE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Molecule::myBE =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Stored binding energy value </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00504">504</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>

</div>
</div>
<a id="a6647358091d946bb02dbcf3ce35b7d5e" name="a6647358091d946bb02dbcf3ce35b7d5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6647358091d946bb02dbcf3ce35b7d5e">&#9670;&nbsp;</a></span>myHBE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Molecule::myHBE =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Stored binding energy value (specific to hotspot - see <a class="el" href="classProtein.html">Protein</a>) </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00505">505</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>

</div>
</div>
<a id="abf3e45c79a7ae3fbb0fc174544debc1e" name="abf3e45c79a7ae3fbb0fc174544debc1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf3e45c79a7ae3fbb0fc174544debc1e">&#9670;&nbsp;</a></span>pE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Molecule::pE =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000042">Deprecated:</a></b></dt><dd>Extra penalization (in same units as energy) </dd></dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00512">512</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>

</div>
</div>
<a id="acf710157d0a2da0d5d7bab8d658c39be" name="acf710157d0a2da0d5d7bab8d658c39be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf710157d0a2da0d5d7bab8d658c39be">&#9670;&nbsp;</a></span>trialmode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Molecule::trialmode =false</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Is it in "trial mode" (See flowchart in algorithm document and <a class="el" href="classMolecule.html#ab89456b4f7e16d7cbf6025f0389f5d10" title="Start trial mode.">startTrials()</a>) </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00503">503</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>

</div>
</div>
<a id="a3e459e9ae52f281073d4821b9af72b60" name="a3e459e9ae52f281073d4821b9af72b60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e459e9ae52f281073d4821b9af72b60">&#9670;&nbsp;</a></span>type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Molecule::type =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Type identifier. 0 is blank (default). 1 is protein/macromolecule </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00501">501</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>graph/<a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
