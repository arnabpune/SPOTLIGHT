<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Denovo omega: chemtools Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Denovo omega<span id="projectnumber">&#160;0.0</span>
   </div>
   <div id="projectbrief">A de-novo optimum-binder molecule-design program.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">chemtools Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classchemtools_1_1Rule.html">Rule</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6c73fdd6c186f091225ee45907fe6b66"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">Rule</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66">buildRules</a> (const std::string &amp;def, const <a class="el" href="classForceField.html">ForceField</a> *ff=nullptr)</td></tr>
<tr class="memdesc:a6c73fdd6c186f091225ee45907fe6b66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a set of <a class="el" href="classchemtools_1_1Rule.html">Rule</a> objects by parsing a line from the definitions file (See PDF for definition format)  <a href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66">More...</a><br /></td></tr>
<tr class="separator:a6c73fdd6c186f091225ee45907fe6b66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0566d6420d090a2cd4d9530bca1b769"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; std::pair&lt; std::string, std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">Rule</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacechemtools.html#ac0566d6420d090a2cd4d9530bca1b769">getRuleset</a> (const std::string &amp;file, const <a class="el" href="classForceField.html">ForceField</a> *ff=nullptr)</td></tr>
<tr class="memdesc:ac0566d6420d090a2cd4d9530bca1b769"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load all rules from a file.  <a href="namespacechemtools.html#ac0566d6420d090a2cd4d9530bca1b769">More...</a><br /></td></tr>
<tr class="separator:ac0566d6420d090a2cd4d9530bca1b769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c73fdd6c186f091225ee45907fe6b66"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">Rule</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66">buildRules</a> (const std::string &amp;def, const <a class="el" href="classForceField.html">ForceField</a> *ff=nullptr)</td></tr>
<tr class="memdesc:a6c73fdd6c186f091225ee45907fe6b66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a set of <a class="el" href="classchemtools_1_1Rule.html">Rule</a> objects by parsing a line from the definitions file (See PDF for definition format)  <a href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66">More...</a><br /></td></tr>
<tr class="separator:a6c73fdd6c186f091225ee45907fe6b66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0566d6420d090a2cd4d9530bca1b769"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; std::pair&lt; std::string, std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">Rule</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacechemtools.html#ac0566d6420d090a2cd4d9530bca1b769">getRuleset</a> (const std::string &amp;file, const <a class="el" href="classForceField.html">ForceField</a> *ff=nullptr)</td></tr>
<tr class="memdesc:ac0566d6420d090a2cd4d9530bca1b769"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load all rules from a file.  <a href="namespacechemtools.html#ac0566d6420d090a2cd4d9530bca1b769">More...</a><br /></td></tr>
<tr class="separator:ac0566d6420d090a2cd4d9530bca1b769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c73fdd6c186f091225ee45907fe6b66"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">Rule</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66">buildRules</a> (const std::string &amp;def, const <a class="el" href="classForceField.html">ForceField</a> *ff=nullptr)</td></tr>
<tr class="memdesc:a6c73fdd6c186f091225ee45907fe6b66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a set of <a class="el" href="classchemtools_1_1Rule.html">Rule</a> objects by parsing a line from the definitions file (See PDF for definition format)  <a href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66">More...</a><br /></td></tr>
<tr class="separator:a6c73fdd6c186f091225ee45907fe6b66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0566d6420d090a2cd4d9530bca1b769"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; std::pair&lt; std::string, std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">Rule</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacechemtools.html#ac0566d6420d090a2cd4d9530bca1b769">getRuleset</a> (const std::string &amp;file, const <a class="el" href="classForceField.html">ForceField</a> *ff=nullptr)</td></tr>
<tr class="memdesc:ac0566d6420d090a2cd4d9530bca1b769"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load all rules from a file.  <a href="namespacechemtools.html#ac0566d6420d090a2cd4d9530bca1b769">More...</a><br /></td></tr>
<tr class="separator:ac0566d6420d090a2cd4d9530bca1b769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c73fdd6c186f091225ee45907fe6b66"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">Rule</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66">buildRules</a> (const std::string &amp;def, const <a class="el" href="classForceField.html">ForceField</a> *ff=nullptr)</td></tr>
<tr class="memdesc:a6c73fdd6c186f091225ee45907fe6b66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a set of <a class="el" href="classchemtools_1_1Rule.html">Rule</a> objects by parsing a line from the definitions file (See PDF for definition format)  <a href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66">More...</a><br /></td></tr>
<tr class="separator:a6c73fdd6c186f091225ee45907fe6b66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0566d6420d090a2cd4d9530bca1b769"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; std::pair&lt; std::string, std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">Rule</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacechemtools.html#ac0566d6420d090a2cd4d9530bca1b769">getRuleset</a> (const std::string &amp;file, const <a class="el" href="classForceField.html">ForceField</a> *ff=nullptr)</td></tr>
<tr class="memdesc:ac0566d6420d090a2cd4d9530bca1b769"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load all rules from a file.  <a href="namespacechemtools.html#ac0566d6420d090a2cd4d9530bca1b769">More...</a><br /></td></tr>
<tr class="separator:ac0566d6420d090a2cd4d9530bca1b769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a330bbc0a28d98a7b8d22150d8e590050"><td class="memItemLeft" align="right" valign="top"><a id="a330bbc0a28d98a7b8d22150d8e590050" name="a330bbc0a28d98a7b8d22150d8e590050"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><b>getAngle</b> (<a class="el" href="classAtom.html">Atom</a> *a1, <a class="el" href="classAtom.html">Atom</a> *a2, <a class="el" href="classAtom.html">Atom</a> *a3)</td></tr>
<tr class="memdesc:a330bbc0a28d98a7b8d22150d8e590050"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the angle between any three atoms. <br /></td></tr>
<tr class="separator:a330bbc0a28d98a7b8d22150d8e590050"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1bacba692469862a68fec24a291334e"><td class="memItemLeft" align="right" valign="top"><a id="af1bacba692469862a68fec24a291334e" name="af1bacba692469862a68fec24a291334e"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><b>getDihedral</b> (<a class="el" href="classAtom.html">Atom</a> *a1, <a class="el" href="classAtom.html">Atom</a> *a2, <a class="el" href="classAtom.html">Atom</a> *a3, <a class="el" href="classAtom.html">Atom</a> *a4)</td></tr>
<tr class="memdesc:af1bacba692469862a68fec24a291334e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the dihedral between any four atoms. <br /></td></tr>
<tr class="separator:af1bacba692469862a68fec24a291334e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38aa10028ccaf681c4a1871c62f53597"><td class="memItemLeft" align="right" valign="top"><a id="a38aa10028ccaf681c4a1871c62f53597" name="a38aa10028ccaf681c4a1871c62f53597"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><b>getImproper</b> (<a class="el" href="classAtom.html">Atom</a> *a1, <a class="el" href="classAtom.html">Atom</a> *a2, <a class="el" href="classAtom.html">Atom</a> *a3, <a class="el" href="classAtom.html">Atom</a> *a4)</td></tr>
<tr class="memdesc:a38aa10028ccaf681c4a1871c62f53597"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the improper dihedral between any four atoms. The central atom is first. <br /></td></tr>
<tr class="separator:a38aa10028ccaf681c4a1871c62f53597"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc098d7eee6376b087ed6a8d0448eb00"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; std::pair&lt; Eigen::Vector3d, std::pair&lt; double, std::pair&lt; double, double &gt; &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacechemtools.html#abc098d7eee6376b087ed6a8d0448eb00">getAllAllowedPositions</a> (<a class="el" href="classAtom.html">Atom</a> *src, <a class="el" href="classMolecule.html">Molecule</a> *mol, <a class="el" href="classAtom.html">Atom</a> *natom, const <a class="el" href="classSystem.html">System</a> &amp;ff, int num=10, int tries=10, bool restr=false, const <a class="el" href="classCategory.html">Category</a> *aromcat=nullptr, int devid=0)</td></tr>
<tr class="memdesc:abc098d7eee6376b087ed6a8d0448eb00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predict allowed positions based on angle and dihedral parameters.  <a href="namespacechemtools.html#abc098d7eee6376b087ed6a8d0448eb00">More...</a><br /></td></tr>
<tr class="separator:abc098d7eee6376b087ed6a8d0448eb00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2f246d4cc40979950344b2e6465fa73"><td class="memItemLeft" align="right" valign="top"><a id="ad2f246d4cc40979950344b2e6465fa73" name="ad2f246d4cc40979950344b2e6465fa73"></a>
static std::pair&lt; Eigen::Vector3d, std::pair&lt; double, double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>getAllowedPositions</b> (<a class="el" href="classAtom.html">Atom</a> *src, <a class="el" href="classMolecule.html">Molecule</a> *mol, <a class="el" href="classAtom.html">Atom</a> *natom, const <a class="el" href="classSystem.html">System</a> &amp;ff, int num=10, int tries=10, bool restr=false, const <a class="el" href="classCategory.html">Category</a> *aromcat=nullptr, int devid=0)</td></tr>
<tr class="memdesc:ad2f246d4cc40979950344b2e6465fa73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a (boltzmann-factor weighted) random positions from all the trialled positions. See (<a class="el" href="namespacechemtools.html#abc098d7eee6376b087ed6a8d0448eb00" title="Predict allowed positions based on angle and dihedral parameters.">chemtools::getAllAllowedPositions</a>) <br /></td></tr>
<tr class="separator:ad2f246d4cc40979950344b2e6465fa73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add27111d98634ab1c1d9c68e93801700"><td class="memItemLeft" align="right" valign="top"><a id="add27111d98634ab1c1d9c68e93801700" name="add27111d98634ab1c1d9c68e93801700"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><b>getLJInteraction</b> (<a class="el" href="classAtom.html">Atom</a> *a1, <a class="el" href="classAtom.html">Atom</a> *a2)</td></tr>
<tr class="memdesc:add27111d98634ab1c1d9c68e93801700"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the L-J (Lennard Jones) interaction energy between two atoms. It uses the internal σ, ε from the atom-type data. <br /></td></tr>
<tr class="separator:add27111d98634ab1c1d9c68e93801700"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dd0e56186f6bc511d0dfc32cabfd10d"><td class="memItemLeft" align="right" valign="top"><a id="a2dd0e56186f6bc511d0dfc32cabfd10d" name="a2dd0e56186f6bc511d0dfc32cabfd10d"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><b>getLJForce</b> (<a class="el" href="classAtom.html">Atom</a> *a1, <a class="el" href="classAtom.html">Atom</a> *a2)</td></tr>
<tr class="memdesc:a2dd0e56186f6bc511d0dfc32cabfd10d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the L-J (Lennard Jones) force between two atoms. It uses the internal σ, ε from the atom-type data. <br /></td></tr>
<tr class="separator:a2dd0e56186f6bc511d0dfc32cabfd10d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f56c65c46b5d053ee327c5c8090cb32"><td class="memItemLeft" align="right" valign="top"><a id="a7f56c65c46b5d053ee327c5c8090cb32" name="a7f56c65c46b5d053ee327c5c8090cb32"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><b>getElectrostaticEnergy</b> (<a class="el" href="classAtom.html">Atom</a> *a1, <a class="el" href="classAtom.html">Atom</a> *a2)</td></tr>
<tr class="memdesc:a7f56c65c46b5d053ee327c5c8090cb32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the electrostatic interaction energy between two atoms. It uses the charges from the atom-type data. <br /></td></tr>
<tr class="separator:a7f56c65c46b5d053ee327c5c8090cb32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1793903a445a8d3082490a333f704476"><td class="memItemLeft" align="right" valign="top"><a id="a1793903a445a8d3082490a333f704476" name="a1793903a445a8d3082490a333f704476"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><b>getElectrostaticForce</b> (<a class="el" href="classAtom.html">Atom</a> *a1, <a class="el" href="classAtom.html">Atom</a> *a2)</td></tr>
<tr class="memdesc:a1793903a445a8d3082490a333f704476"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the electrostatic force between two atoms. It uses the charges from the atom-type data. <br /></td></tr>
<tr class="separator:a1793903a445a8d3082490a333f704476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0257a011fb4df690121cb9bf71cc67e8"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacechemtools.html#a0257a011fb4df690121cb9bf71cc67e8">getElectrostaticEnergy</a> (<a class="el" href="classAtom.html">Atom</a> *a1, <a class="el" href="classAtom.html">Atom</a> *a2, double r)</td></tr>
<tr class="memdesc:a0257a011fb4df690121cb9bf71cc67e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the electrostatic interaction energy between two atoms distance 'r' apart.  <a href="namespacechemtools.html#a0257a011fb4df690121cb9bf71cc67e8">More...</a><br /></td></tr>
<tr class="separator:a0257a011fb4df690121cb9bf71cc67e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79d7722db71286b1fe58858f47f72dbe"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacechemtools.html#a79d7722db71286b1fe58858f47f72dbe">getElectrostaticForce</a> (<a class="el" href="classAtom.html">Atom</a> *a1, <a class="el" href="classAtom.html">Atom</a> *a2, double r)</td></tr>
<tr class="memdesc:a79d7722db71286b1fe58858f47f72dbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the electrostatic force between two atoms distance 'r' apart.  <a href="namespacechemtools.html#a79d7722db71286b1fe58858f47f72dbe">More...</a><br /></td></tr>
<tr class="separator:a79d7722db71286b1fe58858f47f72dbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7437535dfce8aac7d0e53487331c5062"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacechemtools.html#a7437535dfce8aac7d0e53487331c5062">getLJInteraction</a> (<a class="el" href="classAtom.html">Atom</a> *a1, <a class="el" href="classAtom.html">Atom</a> *a2, double r)</td></tr>
<tr class="memdesc:a7437535dfce8aac7d0e53487331c5062"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the L-J (Lennard Jones) interaction energy between two atoms distance 'r' apart.  <a href="namespacechemtools.html#a7437535dfce8aac7d0e53487331c5062">More...</a><br /></td></tr>
<tr class="separator:a7437535dfce8aac7d0e53487331c5062"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a8750722bf7f58e4dd0539497527e7"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacechemtools.html#a56a8750722bf7f58e4dd0539497527e7">getLJForce</a> (<a class="el" href="classAtom.html">Atom</a> *a1, <a class="el" href="classAtom.html">Atom</a> *a2, double r)</td></tr>
<tr class="memdesc:a56a8750722bf7f58e4dd0539497527e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the L-J (Lennard Jones) force between two atoms distance 'r' apart.  <a href="namespacechemtools.html#a56a8750722bf7f58e4dd0539497527e7">More...</a><br /></td></tr>
<tr class="separator:a56a8750722bf7f58e4dd0539497527e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d736b938261879ac0c621cd97172a7a"><td class="memItemLeft" align="right" valign="top"><a id="a4d736b938261879ac0c621cd97172a7a" name="a4d736b938261879ac0c621cd97172a7a"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><b>getNonbondingPotential</b> (<a class="el" href="classAtom.html">Atom</a> *a1, <a class="el" href="classAtom.html">Atom</a> *a2)</td></tr>
<tr class="memdesc:a4d736b938261879ac0c621cd97172a7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">A wrapper that uses the stored parameters of <a class="el" href="classAtom.html">Atom</a> objects to calculate non-bonding interaction between two specific atoms (using their stored co-ordinates for distance calculation). See Also: <a class="el" href="namespacechemtools.html#aa816a9c13cb518b93a7bd0aca6d01ae8" title="A wrapper that uses the stored parameters of Atom objects to calculate non-bonding interaction betwee...">getNonbondingPotential(Atom*,Atom*,double)</a> <br /></td></tr>
<tr class="separator:a4d736b938261879ac0c621cd97172a7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa816a9c13cb518b93a7bd0aca6d01ae8"><td class="memItemLeft" align="right" valign="top"><a id="aa816a9c13cb518b93a7bd0aca6d01ae8" name="aa816a9c13cb518b93a7bd0aca6d01ae8"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><b>getNonbondingPotential</b> (<a class="el" href="classAtom.html">Atom</a> *a1, <a class="el" href="classAtom.html">Atom</a> *a2, double r)</td></tr>
<tr class="memdesc:aa816a9c13cb518b93a7bd0aca6d01ae8"><td class="mdescLeft">&#160;</td><td class="mdescRight">A wrapper that uses the stored parameters of <a class="el" href="classAtom.html">Atom</a> objects to calculate non-bonding interaction between two specific atom-types at a given distance. <br /></td></tr>
<tr class="separator:aa816a9c13cb518b93a7bd0aca6d01ae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >The chemtools namespace is a holder for quick functions to be used in the program (and outside if required). It basically contains wrapper functions to directly use <a class="el" href="classAtom.html">Atom</a> objects and accurately pass on their parameters to the correct candidate functions. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a6c73fdd6c186f091225ee45907fe6b66" name="a6c73fdd6c186f091225ee45907fe6b66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c73fdd6c186f091225ee45907fe6b66">&#9670;&nbsp;</a></span>buildRules() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">chemtools::Rule</a> &gt; chemtools::buildRules </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>def</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> *&#160;</td>
          <td class="paramname"><em>ff</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate a set of <a class="el" href="classchemtools_1_1Rule.html">Rule</a> objects by parsing a line from the definitions file (See PDF for definition format) </p>
<p >This function takes the raw line as input and splits the line into multiple rules (if present), and returns the entire list of rules. <br  />
Sample input lines look like this: </p><div class="fragment"><div class="line">H* 1 1;BRAL 0 1;CLAL 0 1</div>
<div class="line">[aromatic] 2;OH1|FA|CF3 1 1</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="forcefield_8hpp_source.html#l01273">1273</a> of file <a class="el" href="forcefield_8hpp_source.html">forcefield.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>{</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>    <span class="keywordtype">int</span> i=<a class="code hl_function" href="namespacestringfx.html#a39713d3c86433bb2f090df0c6c37a565">stringfx::indexOf</a>(<span class="charliteral">&#39; &#39;</span>,def);</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>    std::string c=def.substr(0,i);</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>    std::string r=def.substr(i+1,def.length()-(i+1));</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>    std::vector&lt;std::string&gt; rstr=<a class="code hl_function" href="namespacestringfx.html#ac6684d09027f7b4ad546ba4d7b3fe8a1">stringfx::split</a>(r,<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>    std::vector&lt;chemtools::Rule&gt; rules;</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>    <span class="keywordflow">for</span>(std::string&amp; s : rstr)</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>    {</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>        <span class="keywordflow">if</span>(ff) <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : ff-&gt;<a class="code hl_function" href="classForceField.html#a9902cf610a724e451d0f5d2a87934fa3">getCategories</a>()) <a class="code hl_function" href="namespacestringfx.html#a827b03090f77597d306efc02f5132d04">stringfx::replace</a>(s,<span class="stringliteral">&quot;[&quot;</span>+p.getCategoryName()+<span class="stringliteral">&quot;]&quot;</span>,p.toString());</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>        rules.push_back(<a class="code hl_class" href="classchemtools_1_1Rule.html">chemtools::Rule</a>(c,s,ff));</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>    }</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>    <span class="keywordflow">return</span> rules;</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>}</div>
<div class="ttc" id="aclassForceField_html_a9902cf610a724e451d0f5d2a87934fa3"><div class="ttname"><a href="classForceField.html#a9902cf610a724e451d0f5d2a87934fa3">ForceField::getCategories</a></div><div class="ttdeci">const auto &amp; getCategories() const</div><div class="ttdoc">Get the list of all Categories loaded into this ForceField.</div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00382">forcefield.hpp:382</a></div></div>
<div class="ttc" id="aclasschemtools_1_1Rule_html"><div class="ttname"><a href="classchemtools_1_1Rule.html">chemtools::Rule</a></div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00181">forcefield.hpp:182</a></div></div>
<div class="ttc" id="anamespacestringfx_html_a39713d3c86433bb2f090df0c6c37a565"><div class="ttname"><a href="namespacestringfx.html#a39713d3c86433bb2f090df0c6c37a565">stringfx::indexOf</a></div><div class="ttdeci">int indexOf(char c, const std::string &amp;s)</div><div class="ttdoc">Find the index of a character in a string.</div><div class="ttdef"><b>Definition:</b> <a href="commons_8h_source.html#l00323">commons.h:323</a></div></div>
<div class="ttc" id="anamespacestringfx_html_a827b03090f77597d306efc02f5132d04"><div class="ttname"><a href="namespacestringfx.html#a827b03090f77597d306efc02f5132d04">stringfx::replace</a></div><div class="ttdeci">std::string &amp; replace(std::string &amp;s, std::string val, std::string ns)</div><div class="ttdoc">Replace a substring with another.</div><div class="ttdef"><b>Definition:</b> <a href="commons_8h_source.html#l00399">commons.h:399</a></div></div>
<div class="ttc" id="anamespacestringfx_html_ac6684d09027f7b4ad546ba4d7b3fe8a1"><div class="ttname"><a href="namespacestringfx.html#ac6684d09027f7b4ad546ba4d7b3fe8a1">stringfx::split</a></div><div class="ttdeci">std::vector&lt; std::string &gt; split(const std::string &amp;s, char delim=' ', bool autotrim=false, char protB=(char) 0, char protE=(char) 0)</div><div class="ttdoc">split a string by a given delimiter and generate a std::vector of strings as output</div><div class="ttdef"><b>Definition:</b> <a href="commons_8h_source.html#l00375">commons.h:375</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c73fdd6c186f091225ee45907fe6b66" name="a6c73fdd6c186f091225ee45907fe6b66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c73fdd6c186f091225ee45907fe6b66">&#9670;&nbsp;</a></span>buildRules() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">chemtools::Rule</a> &gt; chemtools::buildRules </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>def</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> *&#160;</td>
          <td class="paramname"><em>ff</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate a set of <a class="el" href="classchemtools_1_1Rule.html">Rule</a> objects by parsing a line from the definitions file (See PDF for definition format) </p>
<p >This function takes the raw line as input and splits the line into multiple rules (if present), and returns the entire list of rules. <br  />
Sample input lines look like this: </p><div class="fragment"><div class="line">H* 1 1;BRAL 0 1;CLAL 0 1</div>
<div class="line">[aromatic] 2;OH1|FA|CF3 1 1</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="forcefield__precomp_8hpp_source.html#l01176">1176</a> of file <a class="el" href="forcefield__precomp_8hpp_source.html">forcefield_precomp.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>{</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>    <span class="keywordtype">int</span> i=<a class="code hl_function" href="namespacestringfx.html#a39713d3c86433bb2f090df0c6c37a565">stringfx::indexOf</a>(<span class="charliteral">&#39; &#39;</span>,def);</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>    std::string c=def.substr(0,i);</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>    std::string r=def.substr(i+1,def.length()-(i+1));</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>    std::vector&lt;std::string&gt; rstr=<a class="code hl_function" href="namespacestringfx.html#ac6684d09027f7b4ad546ba4d7b3fe8a1">stringfx::split</a>(r,<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>    std::vector&lt;chemtools::Rule&gt; rules;</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>    <span class="keywordflow">for</span>(std::string&amp; s : rstr)</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>    {</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>        <span class="keywordflow">if</span>(ff) <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : ff-&gt;<a class="code hl_function" href="classForceField.html#a9902cf610a724e451d0f5d2a87934fa3">getCategories</a>()) <a class="code hl_function" href="namespacestringfx.html#a827b03090f77597d306efc02f5132d04">stringfx::replace</a>(s,<span class="stringliteral">&quot;[&quot;</span>+p.getCategoryName()+<span class="stringliteral">&quot;]&quot;</span>,p.toString());</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>        rules.push_back(<a class="code hl_class" href="classchemtools_1_1Rule.html">chemtools::Rule</a>(c,s,ff));</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>    }</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>    <span class="keywordflow">return</span> rules;</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c73fdd6c186f091225ee45907fe6b66" name="a6c73fdd6c186f091225ee45907fe6b66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c73fdd6c186f091225ee45907fe6b66">&#9670;&nbsp;</a></span>buildRules() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">chemtools::Rule</a> &gt; chemtools::buildRules </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>def</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> *&#160;</td>
          <td class="paramname"><em>ff</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate a set of <a class="el" href="classchemtools_1_1Rule.html">Rule</a> objects by parsing a line from the definitions file (See PDF for definition format) </p>
<p >This function takes the raw line as input and splits the line into multiple rules (if present), and returns the entire list of rules. <br  />
Sample input lines look like this: </p><div class="fragment"><div class="line">H* 1 1;BRAL 0 1;CLAL 0 1</div>
<div class="line">[aromatic] 2;OH1|FA|CF3 1 1</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="forcefield__precomp__omega__stable_8hpp_source.html#l01081">1081</a> of file <a class="el" href="forcefield__precomp__omega__stable_8hpp_source.html">forcefield_precomp_omega_stable.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>{</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>    <span class="keywordtype">int</span> i=<a class="code hl_function" href="namespacestringfx.html#a39713d3c86433bb2f090df0c6c37a565">stringfx::indexOf</a>(<span class="charliteral">&#39; &#39;</span>,def);</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>    std::string c=def.substr(0,i);</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>    std::string r=def.substr(i+1,def.length()-(i+1));</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>    std::vector&lt;std::string&gt; rstr=<a class="code hl_function" href="namespacestringfx.html#ac6684d09027f7b4ad546ba4d7b3fe8a1">stringfx::split</a>(r,<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>    std::vector&lt;chemtools::Rule&gt; rules;</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>    <span class="keywordflow">for</span>(std::string&amp; s : rstr)</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>    {</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>        <span class="keywordflow">if</span>(ff) <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : ff-&gt;<a class="code hl_function" href="classForceField.html#a9902cf610a724e451d0f5d2a87934fa3">getCategories</a>()) <a class="code hl_function" href="namespacestringfx.html#a827b03090f77597d306efc02f5132d04">stringfx::replace</a>(s,<span class="stringliteral">&quot;[&quot;</span>+p.getCategoryName()+<span class="stringliteral">&quot;]&quot;</span>,p.toString());</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>        rules.push_back(<a class="code hl_class" href="classchemtools_1_1Rule.html">chemtools::Rule</a>(c,s,ff));</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>    }</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>    <span class="keywordflow">return</span> rules;</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c73fdd6c186f091225ee45907fe6b66" name="a6c73fdd6c186f091225ee45907fe6b66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c73fdd6c186f091225ee45907fe6b66">&#9670;&nbsp;</a></span>buildRules() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">chemtools::Rule</a> &gt; chemtools::buildRules </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>def</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> *&#160;</td>
          <td class="paramname"><em>ff</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate a set of <a class="el" href="classchemtools_1_1Rule.html">Rule</a> objects by parsing a line from the definitions file (See PDF for definition format) </p>
<p >This function takes the raw line as input and splits the line into multiple rules (if present), and returns the entire list of rules. <br  />
Sample input lines look like this: </p><div class="fragment"><div class="line">H* 1 1;BRAL 0 1;CLAL 0 1</div>
<div class="line">[aromatic] 2;OH1|FA|CF3 1 1</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="forcefield__precomp__omega__stable2_8hpp_source.html#l01174">1174</a> of file <a class="el" href="forcefield__precomp__omega__stable2_8hpp_source.html">forcefield_precomp_omega_stable2.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>{</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>    <span class="keywordtype">int</span> i=<a class="code hl_function" href="namespacestringfx.html#a39713d3c86433bb2f090df0c6c37a565">stringfx::indexOf</a>(<span class="charliteral">&#39; &#39;</span>,def);</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>    std::string c=def.substr(0,i);</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>    std::string r=def.substr(i+1,def.length()-(i+1));</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>    std::vector&lt;std::string&gt; rstr=<a class="code hl_function" href="namespacestringfx.html#ac6684d09027f7b4ad546ba4d7b3fe8a1">stringfx::split</a>(r,<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>    std::vector&lt;chemtools::Rule&gt; rules;</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>    <span class="keywordflow">for</span>(std::string&amp; s : rstr)</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>    {</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>        <span class="keywordflow">if</span>(ff) <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : ff-&gt;<a class="code hl_function" href="classForceField.html#a9902cf610a724e451d0f5d2a87934fa3">getCategories</a>()) <a class="code hl_function" href="namespacestringfx.html#a827b03090f77597d306efc02f5132d04">stringfx::replace</a>(s,<span class="stringliteral">&quot;[&quot;</span>+p.getCategoryName()+<span class="stringliteral">&quot;]&quot;</span>,p.toString());</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>        rules.push_back(<a class="code hl_class" href="classchemtools_1_1Rule.html">chemtools::Rule</a>(c,s,ff));</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>    }</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>    <span class="keywordflow">return</span> rules;</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abc098d7eee6376b087ed6a8d0448eb00" name="abc098d7eee6376b087ed6a8d0448eb00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc098d7eee6376b087ed6a8d0448eb00">&#9670;&nbsp;</a></span>getAllAllowedPositions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::vector&lt; std::pair&lt; Eigen::Vector3d, std::pair&lt; double, std::pair&lt; double, double &gt; &gt; &gt; &gt; chemtools::getAllAllowedPositions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMolecule.html">Molecule</a> *&#160;</td>
          <td class="paramname"><em>mol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>natom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSystem.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>ff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tries</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>restr</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCategory.html">Category</a> *&#160;</td>
          <td class="paramname"><em>aromcat</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>devid</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Predict allowed positions based on angle and dihedral parameters. </p>
<p >When a new atom if to be connected to an existing atom, and the trialling of the bond is being done, this function trials multiple positions, and provides a list of potential candidate posiitions, and the interaction energy at each spot. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">src</td><td>The source atom which is part of the newly forming bond. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mol</td><td>The source molecule (which must also contain src). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">natom</td><td>The new atom-type being trialled. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ff</td><td>The <a class="el" href="classSystem.html">System</a> under consideration. It is used only to get the working <a class="el" href="classForceField.html">ForceField</a>, and hence the name "ff". </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num</td><td>Number of trial positions to generate (may increase multiplicatively based on structure generated until now, and position of src in the molecule - See algorthim PDF for details on position trialling). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tries</td><td>If 'num' positions could not be generated in 'tries' trials, stop. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">restr</td><td>Restrain the positions? (See algorithm PDF, version σ++ for more details on restrained growth). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aromcat</td><td>A pointer to the aromatic category. Starting from DeNovo version θ2, the dihedral is forced to 0 if the source atom (src) is aromatic, but hasn't yet cyclized. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l04198">4198</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l04199" name="l04199"></a><span class="lineno"> 4199</span>{</div>
<div class="line"><a id="l04200" name="l04200"></a><span class="lineno"> 4200</span>    <span class="comment">//if(!mol) cout &lt;&lt; &quot;Null molecule pointer\n&quot;;</span></div>
<div class="line"><a id="l04201" name="l04201"></a><span class="lineno"> 4201</span>    <span class="comment">//cout &lt;&lt; &quot;Failing at: &quot;&lt;&lt;src-&gt;toString()&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l04202" name="l04202"></a><span class="lineno"> 4202</span>    mol-&gt;<a class="code hl_function" href="classMolecule.html#a728fa63d31ed43876593086571e82cf6">describeStructure</a>();</div>
<div class="line"><a id="l04203" name="l04203"></a><span class="lineno"> 4203</span>    std::vector&lt;Atom*&gt; bondcol=mol-&gt;<a class="code hl_function" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a>(src); <span class="comment">//,angcol;</span></div>
<div class="line"><a id="l04204" name="l04204"></a><span class="lineno"> 4204</span>    <span class="keywordtype">double</span> length=0,ang,tempen,proten=0;</div>
<div class="line"><a id="l04205" name="l04205"></a><span class="lineno"> 4205</span>  std::vector&lt;double&gt; dih;</div>
<div class="line"><a id="l04206" name="l04206"></a><span class="lineno"> 4206</span>  std::vector&lt;Eigen::Vector3d&gt; temp;</div>
<div class="line"><a id="l04207" name="l04207"></a><span class="lineno"> 4207</span>  <span class="keywordtype">bool</span> angex=<span class="keyword">true</span>;</div>
<div class="line"><a id="l04208" name="l04208"></a><span class="lineno"> 4208</span>  <span class="keywordflow">try</span> {length=get&lt;0&gt;(sys.ff-&gt;getLengthParameters(src-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>(),natom-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>()));}</div>
<div class="line"><a id="l04209" name="l04209"></a><span class="lineno"> 4209</span>  <span class="keywordflow">catch</span>(<a class="code hl_class" href="classDataNotAvailableException.html">DataNotAvailableException</a> ex)</div>
<div class="line"><a id="l04210" name="l04210"></a><span class="lineno"> 4210</span>    {</div>
<div class="line"><a id="l04211" name="l04211"></a><span class="lineno"> 4211</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;No data for bond &quot;</span>&lt;&lt;src-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>()&lt;&lt;<span class="stringliteral">&quot;-&quot;</span>&lt;&lt;natom-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l04212" name="l04212"></a><span class="lineno"> 4212</span>        <span class="keywordflow">throw</span> <a class="code hl_class" href="classNoPositionAvailableException.html">NoPositionAvailableException</a>();</div>
<div class="line"><a id="l04213" name="l04213"></a><span class="lineno"> 4213</span>    }</div>
<div class="line"><a id="l04214" name="l04214"></a><span class="lineno"> 4214</span>    <span class="comment">//if(!bondcol.size()) return make_pair(randomSelect(quickgeom::getRandomVectorsInShell(src-&gt;getPosition(),length,num*100)),make_pair(0.0,0.0));</span></div>
<div class="line"><a id="l04215" name="l04215"></a><span class="lineno"> 4215</span>  <span class="keywordflow">if</span>(!bondcol.size()) {angex=<span class="keyword">false</span>; temp=<a class="code hl_function" href="namespacequickgeom.html#a78c6886551455b71fe88580560aae508">quickgeom::getRandomVectorsInShell</a>(Eigen::Vector3d(0,0,0),length,num*20,devid);}</div>
<div class="line"><a id="l04216" name="l04216"></a><span class="lineno"> 4216</span>    std::vector&lt;std::pair&lt;Eigen::Vector3d,std::pair&lt;double,std::pair&lt;double,double&gt;&gt;&gt;&gt; ret;</div>
<div class="line"><a id="l04217" name="l04217"></a><span class="lineno"> 4217</span>  <span class="comment">//std::vector&lt;double&gt; diheners;</span></div>
<div class="line"><a id="l04218" name="l04218"></a><span class="lineno"> 4218</span>    <span class="keywordtype">bool</span> acc,ign=<span class="keyword">false</span>,cyc,dihexist=<span class="keyword">false</span>;</div>
<div class="line"><a id="l04219" name="l04219"></a><span class="lineno"> 4219</span>  <span class="keywordtype">double</span> dihe,intlje=0,hsben=0;</div>
<div class="line"><a id="l04220" name="l04220"></a><span class="lineno"> 4220</span>  <span class="keywordtype">double</span> vdis,ct,md=100;</div>
<div class="line"><a id="l04221" name="l04221"></a><span class="lineno"> 4221</span>  std::vector&lt;std::pair&lt;Atom*,std::vector&lt;Atom*&gt;&gt;&gt; atgeom;</div>
<div class="line"><a id="l04222" name="l04222"></a><span class="lineno"> 4222</span>  std::vector&lt;Atom*&gt; ignore;</div>
<div class="line"><a id="l04223" name="l04223"></a><span class="lineno"> 4223</span>  <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a : bondcol)</div>
<div class="line"><a id="l04224" name="l04224"></a><span class="lineno"> 4224</span>  {</div>
<div class="line"><a id="l04225" name="l04225"></a><span class="lineno"> 4225</span>    ignore.push_back(a);</div>
<div class="line"><a id="l04226" name="l04226"></a><span class="lineno"> 4226</span>    std::vector&lt;Atom*&gt; gats;</div>
<div class="line"><a id="l04227" name="l04227"></a><span class="lineno"> 4227</span>    <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* a2 : mol-&gt;<a class="code hl_function" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a>(a))</div>
<div class="line"><a id="l04228" name="l04228"></a><span class="lineno"> 4228</span>    {</div>
<div class="line"><a id="l04229" name="l04229"></a><span class="lineno"> 4229</span>      <span class="keywordflow">if</span>(a2==src) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l04230" name="l04230"></a><span class="lineno"> 4230</span>      gats.push_back(a2); ignore.push_back(a2);</div>
<div class="line"><a id="l04231" name="l04231"></a><span class="lineno"> 4231</span>    }</div>
<div class="line"><a id="l04232" name="l04232"></a><span class="lineno"> 4232</span>    atgeom.push_back(make_pair(a,gats));</div>
<div class="line"><a id="l04233" name="l04233"></a><span class="lineno"> 4233</span>  }</div>
<div class="line"><a id="l04234" name="l04234"></a><span class="lineno"> 4234</span>  std::pair&lt;Atom*,std::vector&lt;Atom*&gt;&gt; rs;</div>
<div class="line"><a id="l04235" name="l04235"></a><span class="lineno"> 4235</span>  Eigen::Vector3d fixedbond,defbond;</div>
<div class="line"><a id="l04236" name="l04236"></a><span class="lineno"> 4236</span>  <span class="keywordflow">if</span>(angex)</div>
<div class="line"><a id="l04237" name="l04237"></a><span class="lineno"> 4237</span>  {</div>
<div class="line"><a id="l04238" name="l04238"></a><span class="lineno"> 4238</span>    rs=randomSelect(atgeom);</div>
<div class="line"><a id="l04239" name="l04239"></a><span class="lineno"> 4239</span>    fixedbond=src-&gt;<a class="code hl_function" href="classAtom.html#a40e4a43205a24f5e64ea0d27994a3efb">bondVectorTo</a>(get&lt;0&gt;(rs));</div>
<div class="line"><a id="l04240" name="l04240"></a><span class="lineno"> 4240</span>    ang=sys.ff-&gt;getAngleParamtersFailsafe(get&lt;0&gt;(rs)-&gt;toString(),src-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>(),natom-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>())[0];</div>
<div class="line"><a id="l04241" name="l04241"></a><span class="lineno"> 4241</span>    <span class="keywordflow">if</span>(!(get&lt;1&gt;(rs).size())) {dihexist=<span class="keyword">false</span>;}</div>
<div class="line"><a id="l04242" name="l04242"></a><span class="lineno"> 4242</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l04243" name="l04243"></a><span class="lineno"> 4243</span>    {</div>
<div class="line"><a id="l04244" name="l04244"></a><span class="lineno"> 4244</span>      <a class="code hl_class" href="classAtom.html">Atom</a>* rs2=randomSelect(get&lt;1&gt;(rs));</div>
<div class="line"><a id="l04245" name="l04245"></a><span class="lineno"> 4245</span>      <span class="comment">//dih.push_back(sys.ff-&gt;getDihedralParametersFailsafe(rs2-&gt;toString(),get&lt;0&gt;(rs)-&gt;toString(),src-&gt;toString(),natom-&gt;toString())[0]);</span></div>
<div class="line"><a id="l04246" name="l04246"></a><span class="lineno"> 4246</span> </div>
<div class="line"><a id="l04247" name="l04247"></a><span class="lineno"> 4247</span>                <span class="comment">//if(!natom-&gt;isHydrogen() &amp;&amp; aromcat &amp;&amp; aromcat-&gt;contains(src) &amp;&amp; !src-&gt;isCyclized())</span></div>
<div class="line"><a id="l04248" name="l04248"></a><span class="lineno"> 4248</span>            <span class="keywordflow">if</span>(!natom-&gt;<a class="code hl_function" href="classAtom.html#a99ed78f1b94d694b0f3fac609fd92934">isHydrogen</a>() &amp;&amp; aromcat &amp;&amp; aromcat-&gt;<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(src) &amp;&amp; !src-&gt;<a class="code hl_function" href="classAtom.html#a1816a8312c1cd338b507522c6c1bde6b">isCyclized</a>() &amp;&amp; (!ALLOW_BIPHENYL || !rs2-&gt;<a class="code hl_function" href="classAtom.html#a1816a8312c1cd338b507522c6c1bde6b">isCyclized</a>()))</div>
<div class="line"><a id="l04249" name="l04249"></a><span class="lineno"> 4249</span>            {</div>
<div class="line"><a id="l04250" name="l04250"></a><span class="lineno"> 4250</span>                <span class="keywordflow">if</span>(aromcat-&gt;<a class="code hl_function" href="classCategory.html#a3ffa41a593852318c167862171166f1b">contains</a>(rs2)) {cout &lt;&lt; <span class="stringliteral">&quot;Forcing 0 dihedral for aromatic atom\n&quot;</span>; dih=std::vector&lt;double&gt;(1,0.0);}</div>
<div class="line"><a id="l04251" name="l04251"></a><span class="lineno"> 4251</span>                <span class="keywordflow">else</span> {cout &lt;&lt; <span class="stringliteral">&quot;Forcing 180 (degree) dihedral for aromatic atom wrt to non-aromatic atom\n&quot;</span>; dih=std::vector&lt;double&gt;(1,PI);}</div>
<div class="line"><a id="l04252" name="l04252"></a><span class="lineno"> 4252</span>            }</div>
<div class="line"><a id="l04253" name="l04253"></a><span class="lineno"> 4253</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l04254" name="l04254"></a><span class="lineno"> 4254</span>            {</div>
<div class="line"><a id="l04255" name="l04255"></a><span class="lineno"> 4255</span>        <span class="keyword">auto</span> pars=sys.ff-&gt;getDihedralParametersFailsafe(rs2-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>(),get&lt;0&gt;(rs)-&gt;toString(),src-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>(),natom-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>());</div>
<div class="line"><a id="l04256" name="l04256"></a><span class="lineno"> 4256</span>        <span class="comment">//dih=std::vector&lt;double&gt;(1,pars[0]*pars[2]);</span></div>
<div class="line"><a id="l04257" name="l04257"></a><span class="lineno"> 4257</span>        <span class="comment">//cout&lt;&lt;&quot;\t&quot;&lt;&lt;dih[0]&lt;&lt;&quot;\t&quot;&lt;&lt; rs2-&gt;toString()&lt;&lt;&quot;,&quot;&lt;&lt;get&lt;0&gt;(rs)-&gt;toString()&lt;&lt;&quot;,&quot;&lt;&lt;src-&gt;toString()&lt;&lt;&quot;,&quot;&lt;&lt;natom-&gt;toString()&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l04258" name="l04258"></a><span class="lineno"> 4258</span>        dih=<a class="code hl_function" href="classForceField.html#a0b53370d39b444980839b0b6181ee0cf">ForceField::expandMultiplicity</a>(pars[0],pars[2]);</div>
<div class="line"><a id="l04259" name="l04259"></a><span class="lineno"> 4259</span>            }</div>
<div class="line"><a id="l04260" name="l04260"></a><span class="lineno"> 4260</span>      <span class="comment">//cout &lt;&lt; dih &lt;&lt;&quot;:\tchosen for &quot;&lt;&lt;rs2-&gt;toString()&lt;&lt;&quot;,&quot;&lt;&lt;get&lt;0&gt;(rs)-&gt;toString()&lt;&lt;&quot;,&quot;&lt;&lt;src-&gt;toString()&lt;&lt;&quot;,&quot;&lt;&lt;natom-&gt;toString()&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l04261" name="l04261"></a><span class="lineno"> 4261</span>      defbond=get&lt;0&gt;(rs)-&gt;bondVectorTo(rs2);</div>
<div class="line"><a id="l04262" name="l04262"></a><span class="lineno"> 4262</span>      dihexist=<span class="keyword">true</span>;</div>
<div class="line"><a id="l04263" name="l04263"></a><span class="lineno"> 4263</span>    }</div>
<div class="line"><a id="l04264" name="l04264"></a><span class="lineno"> 4264</span>  }</div>
<div class="line"><a id="l04265" name="l04265"></a><span class="lineno"> 4265</span>    <span class="comment">//cout &lt;&lt; &quot;Found parameters: Length=&quot;&lt;&lt;length&lt;&lt;&quot;, Angle=&quot;&lt;&lt;(ang*57.28)&lt;&lt;&quot;, Dihedral=&quot;&lt;&lt;dih&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l04266" name="l04266"></a><span class="lineno"> 4266</span>  <span class="comment">//cout &lt;&lt; &quot;Required angle: &quot;&lt;&lt;ang&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l04267" name="l04267"></a><span class="lineno"> 4267</span>    <span class="keywordflow">while</span>(ret.size()&lt;num)</div>
<div class="line"><a id="l04268" name="l04268"></a><span class="lineno"> 4268</span>    {</div>
<div class="line"><a id="l04269" name="l04269"></a><span class="lineno"> 4269</span>    <span class="comment">//ang=rule-&gt;predictAngle(randomSelect(bondcol),src,natom);</span></div>
<div class="line"><a id="l04270" name="l04270"></a><span class="lineno"> 4270</span>    <span class="keywordflow">if</span>(angex)</div>
<div class="line"><a id="l04271" name="l04271"></a><span class="lineno"> 4271</span>    {</div>
<div class="line"><a id="l04272" name="l04272"></a><span class="lineno"> 4272</span>      <span class="keywordflow">if</span>(!dihexist) {<span class="comment">/*cout &lt;&lt; &quot;No dihedral constraints\n&quot;;*/</span> temp=<a class="code hl_function" href="namespacequickgeom.html#aa2a985eca968dd07d69c6460717c1d1c">quickgeom::getConePositions</a>(fixedbond,length,ang,num*10,devid);} <span class="comment">//Checked that angle is in radians.</span></div>
<div class="line"><a id="l04273" name="l04273"></a><span class="lineno"> 4273</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l04274" name="l04274"></a><span class="lineno"> 4274</span>      {</div>
<div class="line"><a id="l04275" name="l04275"></a><span class="lineno"> 4275</span>        <span class="comment">//cout &lt;&lt; &quot;\ttemp = &quot;&lt;&lt;&quot;quickgeom::getArcPositions(&quot;&lt;&lt;fixedbond.transpose()&lt;&lt;&quot;,&quot;&lt;&lt;defbond.transpose()&lt;&lt;&quot;,&quot;&lt;&lt;length&lt;&lt;&quot;,&quot;&lt;&lt;ang&lt;&lt;&quot;,&quot;&lt;&lt;dih&lt;&lt;&quot;,&quot;&lt;&lt;num&lt;&lt;&quot;);\n&quot;;</span></div>
<div class="line"><a id="l04276" name="l04276"></a><span class="lineno"> 4276</span>        temp=<a class="code hl_function" href="namespacequickgeom.html#af60aae27d8f525f83c7088e81fcda69f">quickgeom::getArcPositions</a>(fixedbond,defbond,length,ang,dih,num,devid);</div>
<div class="line"><a id="l04277" name="l04277"></a><span class="lineno"> 4277</span>      }</div>
<div class="line"><a id="l04278" name="l04278"></a><span class="lineno"> 4278</span>    }</div>
<div class="line"><a id="l04279" name="l04279"></a><span class="lineno"> 4279</span>        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; v : temp)</div>
<div class="line"><a id="l04280" name="l04280"></a><span class="lineno"> 4280</span>        {</div>
<div class="line"><a id="l04281" name="l04281"></a><span class="lineno"> 4281</span>            acc=<span class="keyword">true</span>;</div>
<div class="line"><a id="l04282" name="l04282"></a><span class="lineno"> 4282</span>      cyc=<span class="keyword">false</span>;</div>
<div class="line"><a id="l04283" name="l04283"></a><span class="lineno"> 4283</span>      dihe=0; intlje=0; hsben=0;</div>
<div class="line"><a id="l04284" name="l04284"></a><span class="lineno"> 4284</span>            natom-&gt;<a class="code hl_function" href="classAtom.html#a34fc2756d0f817a9ee6cf91c797d8bcc">setPosition</a>(v+src-&gt;<a class="code hl_function" href="classAtom.html#a73b92d7b24611f250127856e3b52ed31">getPosition</a>());</div>
<div class="line"><a id="l04285" name="l04285"></a><span class="lineno"> 4285</span>      <span class="comment">//cout &lt;&lt; &quot;Position: &quot;&lt;&lt;natom-&gt;getPosition().transpose()&lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l04286" name="l04286"></a><span class="lineno"> 4286</span>      <span class="keywordflow">if</span>(angex &amp;&amp; abs(<a class="code hl_function" href="namespacechemtools.html#a330bbc0a28d98a7b8d22150d8e590050">chemtools::getAngle</a>(natom,src,get&lt;0&gt;(rs))-ang)&gt;THETACUT) {acc=<span class="keyword">false</span>; <span class="keywordflow">break</span>;} <span class="comment">//The positions are very closely clustered so don&#39;t even try the rest.</span></div>
<div class="line"><a id="l04287" name="l04287"></a><span class="lineno"> 4287</span>      intlje=0;</div>
<div class="line"><a id="l04288" name="l04288"></a><span class="lineno"> 4288</span>      hsben=0;</div>
<div class="line"><a id="l04289" name="l04289"></a><span class="lineno"> 4289</span>      <span class="keywordflow">if</span>(!natom-&gt;<a class="code hl_function" href="classAtom.html#a99ed78f1b94d694b0f3fac609fd92934">isHydrogen</a>())</div>
<div class="line"><a id="l04290" name="l04290"></a><span class="lineno"> 4290</span>      {</div>
<div class="line"><a id="l04291" name="l04291"></a><span class="lineno"> 4291</span>        <span class="keywordflow">for</span>(<a class="code hl_class" href="classMolecule.html">Molecule</a>* m : sys.getMolecules())</div>
<div class="line"><a id="l04292" name="l04292"></a><span class="lineno"> 4292</span>        {</div>
<div class="line"><a id="l04293" name="l04293"></a><span class="lineno"> 4293</span>          <span class="keywordflow">if</span>(m-&gt;type==1) <span class="keywordflow">continue</span>; <span class="comment">//calculated below</span></div>
<div class="line"><a id="l04294" name="l04294"></a><span class="lineno"> 4294</span>          <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* c : m-&gt;getAtoms())</div>
<div class="line"><a id="l04295" name="l04295"></a><span class="lineno"> 4295</span>          {</div>
<div class="line"><a id="l04296" name="l04296"></a><span class="lineno"> 4296</span>            <span class="keywordflow">if</span>(c==src) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l04297" name="l04297"></a><span class="lineno"> 4297</span>            vdis=c-&gt;distanceFrom(natom);</div>
<div class="line"><a id="l04298" name="l04298"></a><span class="lineno"> 4298</span>            <span class="keywordflow">if</span>(vdis&lt;RCUT) {acc=<span class="keyword">false</span>; <span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l04299" name="l04299"></a><span class="lineno"> 4299</span>            <span class="comment">//if(vdis&lt;md) md=vdis;</span></div>
<div class="line"><a id="l04300" name="l04300"></a><span class="lineno"> 4300</span>            <span class="keywordflow">if</span>(c-&gt;isHydrogen()) {<span class="keywordflow">if</span>(!ign) intlje+=<a class="code hl_function" href="namespacechemtools.html#a4d736b938261879ac0c621cd97172a7a">getNonbondingPotential</a>(c,natom); <span class="keywordflow">continue</span>;}</div>
<div class="line"><a id="l04301" name="l04301"></a><span class="lineno"> 4301</span>            <span class="keywordflow">try</span> {ct=sys.ff-&gt;getBondLength(c,natom,<span class="keyword">true</span>);} <span class="keywordflow">catch</span>(<a class="code hl_class" href="classDataNotAvailableException.html">DataNotAvailableException</a> ex) {ct=0;}</div>
<div class="line"><a id="l04302" name="l04302"></a><span class="lineno"> 4302</span>                        <span class="comment">//if(vdis&lt;md) {acc=false; break;}</span></div>
<div class="line"><a id="l04303" name="l04303"></a><span class="lineno"> 4303</span>            ign=contains(ignore,c);</div>
<div class="line"><a id="l04304" name="l04304"></a><span class="lineno"> 4304</span>            <span class="keywordflow">if</span>(vdis&lt;CYCCUT) <span class="comment">//How about replacing with energy criteria?</span></div>
<div class="line"><a id="l04305" name="l04305"></a><span class="lineno"> 4305</span>            {</div>
<div class="line"><a id="l04306" name="l04306"></a><span class="lineno"> 4306</span>              <span class="comment">//cout &lt;&lt; &quot;Too close\n&quot;;</span></div>
<div class="line"><a id="l04307" name="l04307"></a><span class="lineno"> 4307</span>                            <span class="keywordflow">if</span>(cyc)</div>
<div class="line"><a id="l04308" name="l04308"></a><span class="lineno"> 4308</span>                            {</div>
<div class="line"><a id="l04309" name="l04309"></a><span class="lineno"> 4309</span>                                <span class="keywordflow">if</span>(!QUIET) cout &lt;&lt; <span class="stringliteral">&quot;RINGREJ\t&quot;</span>&lt;&lt;natom-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>()&lt;&lt;<span class="stringliteral">&quot; with &quot;</span>&lt;&lt;c-&gt;toString()&lt;&lt;<span class="stringliteral">&quot;: Clashing Rings\n&quot;</span>;</div>
<div class="line"><a id="l04310" name="l04310"></a><span class="lineno"> 4310</span>                                acc=<span class="keyword">false</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l04311" name="l04311"></a><span class="lineno"> 4311</span>                            }</div>
<div class="line"><a id="l04312" name="l04312"></a><span class="lineno"> 4312</span>              <span class="keywordflow">if</span>(!ct)</div>
<div class="line"><a id="l04313" name="l04313"></a><span class="lineno"> 4313</span>                            {</div>
<div class="line"><a id="l04314" name="l04314"></a><span class="lineno"> 4314</span>                                <span class="keywordflow">if</span>(!QUIET) cout &lt;&lt; <span class="stringliteral">&quot;RINGREJ\t&quot;</span>&lt;&lt;natom-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>()&lt;&lt;<span class="stringliteral">&quot; with &quot;</span>&lt;&lt;c-&gt;toString()&lt;&lt;<span class="stringliteral">&quot;: No bond defined\n&quot;</span>;</div>
<div class="line"><a id="l04315" name="l04315"></a><span class="lineno"> 4315</span>                                acc=<span class="keyword">false</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l04316" name="l04316"></a><span class="lineno"> 4316</span>                            }</div>
<div class="line"><a id="l04317" name="l04317"></a><span class="lineno"> 4317</span>              <span class="keywordflow">if</span>(!sys.ff-&gt;acceptNewBond(src,bondcol,natom) &amp;&amp; !ign) {acc=<span class="keyword">false</span>; <span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l04318" name="l04318"></a><span class="lineno"> 4318</span>              <span class="keywordflow">if</span>((!c-&gt;canBond() &amp;&amp; !ign) || natom-&gt;<a class="code hl_function" href="classAtom.html#ae2ac3a6ffdc90898d06d05eaf374960e">seek_valency</a>()&lt;2) {acc=<span class="keyword">false</span>; <span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l04319" name="l04319"></a><span class="lineno"> 4319</span> </div>
<div class="line"><a id="l04320" name="l04320"></a><span class="lineno"> 4320</span>              <span class="keywordflow">if</span>(!ign &amp;&amp; abs(vdis-ct)&gt;CYCLENVAR)</div>
<div class="line"><a id="l04321" name="l04321"></a><span class="lineno"> 4321</span>                            {</div>
<div class="line"><a id="l04322" name="l04322"></a><span class="lineno"> 4322</span>                                <span class="keywordflow">if</span>(!QUIET) cout &lt;&lt; <span class="stringliteral">&quot;RINGREJ\t&quot;</span>&lt;&lt;natom-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>()&lt;&lt;<span class="stringliteral">&quot; with &quot;</span>&lt;&lt;c-&gt;toString()&lt;&lt;<span class="stringliteral">&quot;: Bad bond-length\n&quot;</span>;</div>
<div class="line"><a id="l04323" name="l04323"></a><span class="lineno"> 4323</span>                                acc=<span class="keyword">false</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l04324" name="l04324"></a><span class="lineno"> 4324</span>                            }</div>
<div class="line"><a id="l04325" name="l04325"></a><span class="lineno"> 4325</span>              <span class="keyword">auto</span> bats=mol-&gt;<a class="code hl_function" href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">getBondedAtoms</a>(c);</div>
<div class="line"><a id="l04326" name="l04326"></a><span class="lineno"> 4326</span>              <span class="keywordflow">if</span>(!ign &amp;&amp; (!sys.ff-&gt;isSatisfied(c,natom,bats) || !sys.ff-&gt;isSatisfied(natom,c,std::vector&lt;Atom*&gt;(1,src))))</div>
<div class="line"><a id="l04327" name="l04327"></a><span class="lineno"> 4327</span>                            {</div>
<div class="line"><a id="l04328" name="l04328"></a><span class="lineno"> 4328</span>                                <span class="keywordflow">if</span>(!QUIET) cout &lt;&lt; <span class="stringliteral">&quot;RINGREJ\t&quot;</span>&lt;&lt;natom-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>()&lt;&lt;<span class="stringliteral">&quot; with &quot;</span>&lt;&lt;c-&gt;toString()&lt;&lt;<span class="stringliteral">&quot;: Unsatisfied atom type\n&quot;</span>;</div>
<div class="line"><a id="l04329" name="l04329"></a><span class="lineno"> 4329</span>                                acc=<span class="keyword">false</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l04330" name="l04330"></a><span class="lineno"> 4330</span>                            }</div>
<div class="line"><a id="l04331" name="l04331"></a><span class="lineno"> 4331</span>              <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* n : bats)</div>
<div class="line"><a id="l04332" name="l04332"></a><span class="lineno"> 4332</span>                            {</div>
<div class="line"><a id="l04333" name="l04333"></a><span class="lineno"> 4333</span>                                <span class="keywordflow">if</span>(sys.ff-&gt;calculateAngleEnergy(n,c,natom,<span class="keyword">true</span>,1.5*THETACUT)!=0)</div>
<div class="line"><a id="l04334" name="l04334"></a><span class="lineno"> 4334</span>                                {</div>
<div class="line"><a id="l04335" name="l04335"></a><span class="lineno"> 4335</span>                                    <span class="keywordflow">if</span>(!QUIET) cout &lt;&lt; <span class="stringliteral">&quot;RINGREJ\t&quot;</span>&lt;&lt;natom-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>()&lt;&lt;<span class="stringliteral">&quot; with &quot;</span>&lt;&lt;c-&gt;toString()&lt;&lt;<span class="stringliteral">&quot;: Bad angle\n&quot;</span>;</div>
<div class="line"><a id="l04336" name="l04336"></a><span class="lineno"> 4336</span>                                    acc=<span class="keyword">false</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l04337" name="l04337"></a><span class="lineno"> 4337</span>                                }</div>
<div class="line"><a id="l04338" name="l04338"></a><span class="lineno"> 4338</span>                            }</div>
<div class="line"><a id="l04339" name="l04339"></a><span class="lineno"> 4339</span>                            <span class="keywordflow">if</span>(!acc) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l04340" name="l04340"></a><span class="lineno"> 4340</span>              cyc=ign=<span class="keyword">true</span>;</div>
<div class="line"><a id="l04341" name="l04341"></a><span class="lineno"> 4341</span>                            <span class="keywordflow">if</span>(!QUIET) cout &lt;&lt; <span class="stringliteral">&quot;RINGACC\t&quot;</span>&lt;&lt;natom-&gt;<a class="code hl_function" href="classAtom.html#a189def3b8bade8507d49cfd7de881178">toString</a>()&lt;&lt;<span class="stringliteral">&quot; with &quot;</span>&lt;&lt;c-&gt;toString()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l04342" name="l04342"></a><span class="lineno"> 4342</span>            }</div>
<div class="line"><a id="l04343" name="l04343"></a><span class="lineno"> 4343</span>            <span class="keywordflow">if</span>(!ign) intlje+=<a class="code hl_function" href="namespacechemtools.html#a4d736b938261879ac0c621cd97172a7a">getNonbondingPotential</a>(c,natom);</div>
<div class="line"><a id="l04344" name="l04344"></a><span class="lineno"> 4344</span>          }</div>
<div class="line"><a id="l04345" name="l04345"></a><span class="lineno"> 4345</span>        }</div>
<div class="line"><a id="l04346" name="l04346"></a><span class="lineno"> 4346</span>      }</div>
<div class="line"><a id="l04347" name="l04347"></a><span class="lineno"> 4347</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l04348" name="l04348"></a><span class="lineno"> 4348</span>            {</div>
<div class="line"><a id="l04349" name="l04349"></a><span class="lineno"> 4349</span>                <span class="keywordflow">for</span>(<a class="code hl_class" href="classMolecule.html">Molecule</a>* m : sys.getMolecules())</div>
<div class="line"><a id="l04350" name="l04350"></a><span class="lineno"> 4350</span>        {</div>
<div class="line"><a id="l04351" name="l04351"></a><span class="lineno"> 4351</span>                    <span class="keywordflow">if</span>(m-&gt;type==1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l04352" name="l04352"></a><span class="lineno"> 4352</span>          <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* c : m-&gt;getAtoms())</div>
<div class="line"><a id="l04353" name="l04353"></a><span class="lineno"> 4353</span>          {</div>
<div class="line"><a id="l04354" name="l04354"></a><span class="lineno"> 4354</span>                        <span class="keywordflow">if</span>(c==src) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l04355" name="l04355"></a><span class="lineno"> 4355</span>                        <span class="keywordflow">if</span>(contains(ignore,c)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l04356" name="l04356"></a><span class="lineno"> 4356</span>                        vdis=c-&gt;distanceFrom(natom);</div>
<div class="line"><a id="l04357" name="l04357"></a><span class="lineno"> 4357</span>                        <span class="keywordflow">if</span>(vdis&lt;RCUT*0.67) {acc=<span class="keyword">false</span>; <span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l04358" name="l04358"></a><span class="lineno"> 4358</span>                    }</div>
<div class="line"><a id="l04359" name="l04359"></a><span class="lineno"> 4359</span>                }</div>
<div class="line"><a id="l04360" name="l04360"></a><span class="lineno"> 4360</span>            }</div>
<div class="line"><a id="l04361" name="l04361"></a><span class="lineno"> 4361</span>      <span class="keywordflow">if</span>(!acc) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l04362" name="l04362"></a><span class="lineno"> 4362</span>            proten=0;</div>
<div class="line"><a id="l04363" name="l04363"></a><span class="lineno"> 4363</span>      <span class="keywordflow">for</span>(<a class="code hl_class" href="classMolecule.html">Molecule</a>* m : sys.getMolecules())</div>
<div class="line"><a id="l04364" name="l04364"></a><span class="lineno"> 4364</span>      {</div>
<div class="line"><a id="l04365" name="l04365"></a><span class="lineno"> 4365</span>        <span class="keywordflow">if</span>(m-&gt;type==1)</div>
<div class="line"><a id="l04366" name="l04366"></a><span class="lineno"> 4366</span>        {</div>
<div class="line"><a id="l04367" name="l04367"></a><span class="lineno"> 4367</span>          <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* pa : m-&gt;getAtoms()) <span class="comment">//Can restrain atom selection here to ensure only nearby atoms are selected</span></div>
<div class="line"><a id="l04368" name="l04368"></a><span class="lineno"> 4368</span>          {</div>
<div class="line"><a id="l04369" name="l04369"></a><span class="lineno"> 4369</span>            <span class="keywordflow">if</span>(!natom-&gt;<a class="code hl_function" href="classAtom.html#a99ed78f1b94d694b0f3fac609fd92934">isHydrogen</a>() &amp;&amp; !pa-&gt;isHydrogen() &amp;&amp; pa-&gt;distanceFrom(natom)&lt;PROTCUT) {acc=<span class="keyword">false</span>; <span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l04370" name="l04370"></a><span class="lineno"> 4370</span>            tempen=<a class="code hl_function" href="namespacechemtools.html#a4d736b938261879ac0c621cd97172a7a">chemtools::getNonbondingPotential</a>(pa,natom);</div>
<div class="line"><a id="l04371" name="l04371"></a><span class="lineno"> 4371</span>            <span class="comment">//if(throwarandompoint(0,1)&gt;boltzmannFactor(tempen,sys.temp)) {acc=false; break;}</span></div>
<div class="line"><a id="l04372" name="l04372"></a><span class="lineno"> 4372</span>            intlje+=tempen;</div>
<div class="line"><a id="l04373" name="l04373"></a><span class="lineno"> 4373</span>                        proten+=tempen;</div>
<div class="line"><a id="l04374" name="l04374"></a><span class="lineno"> 4374</span>          }</div>
<div class="line"><a id="l04375" name="l04375"></a><span class="lineno"> 4375</span>                    <span class="keywordflow">if</span>(proten&gt;SINGLEATOMENERLIM) acc=<span class="keyword">false</span>;</div>
<div class="line"><a id="l04376" name="l04376"></a><span class="lineno"> 4376</span>                    <span class="keywordflow">if</span>(!acc) {<span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l04377" name="l04377"></a><span class="lineno"> 4377</span>                    <span class="keywordflow">if</span>(!natom-&gt;<a class="code hl_function" href="classAtom.html#a99ed78f1b94d694b0f3fac609fd92934">isHydrogen</a>())</div>
<div class="line"><a id="l04378" name="l04378"></a><span class="lineno"> 4378</span>                    {</div>
<div class="line"><a id="l04379" name="l04379"></a><span class="lineno"> 4379</span>                        <span class="keywordflow">if</span>(sys.getContainer()) acc=sys.getContainer()-&gt;contains(natom-&gt;<a class="code hl_function" href="classAtom.html#a73b92d7b24611f250127856e3b52ed31">getPosition</a>());</div>
<div class="line"><a id="l04380" name="l04380"></a><span class="lineno"> 4380</span>                        <span class="keywordflow">if</span>(acc &amp;&amp; restr)</div>
<div class="line"><a id="l04381" name="l04381"></a><span class="lineno"> 4381</span>                        {</div>
<div class="line"><a id="l04382" name="l04382"></a><span class="lineno"> 4382</span>                            acc=<span class="keyword">false</span>;</div>
<div class="line"><a id="l04383" name="l04383"></a><span class="lineno"> 4383</span>                            <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* hsa : ((<a class="code hl_class" href="classProtein.html">Protein</a>*)m)-&gt;getHotspotAtoms()) {<span class="keywordflow">if</span>(hsa-&gt;distanceFrom(natom)&lt;RESTRAINDISTANCE) {acc=<span class="keyword">true</span>; <span class="keywordflow">break</span>;}}</div>
<div class="line"><a id="l04384" name="l04384"></a><span class="lineno"> 4384</span>                        }</div>
<div class="line"><a id="l04385" name="l04385"></a><span class="lineno"> 4385</span>                        <span class="keywordflow">if</span>(!acc) {<span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l04386" name="l04386"></a><span class="lineno"> 4386</span>                    }</div>
<div class="line"><a id="l04387" name="l04387"></a><span class="lineno"> 4387</span>          <span class="keywordflow">for</span>(<a class="code hl_class" href="classAtom.html">Atom</a>* pa : ((<a class="code hl_class" href="classProtein.html">Protein</a>*)m)-&gt;getHotspotAtoms()) hsben+=<a class="code hl_function" href="namespacechemtools.html#a4d736b938261879ac0c621cd97172a7a">chemtools::getNonbondingPotential</a>(pa,natom);</div>
<div class="line"><a id="l04388" name="l04388"></a><span class="lineno"> 4388</span>        }</div>
<div class="line"><a id="l04389" name="l04389"></a><span class="lineno"> 4389</span>      }</div>
<div class="line"><a id="l04390" name="l04390"></a><span class="lineno"> 4390</span>      <span class="keywordflow">if</span>(cyc) {dihe=0; intlje=0;}</div>
<div class="line"><a id="l04391" name="l04391"></a><span class="lineno"> 4391</span>            <span class="keywordflow">if</span>(intlje&gt;SINGLEATOMINTENERLIM) acc=<span class="keyword">false</span>;</div>
<div class="line"><a id="l04392" name="l04392"></a><span class="lineno"> 4392</span>            <span class="keywordflow">if</span>(!acc) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l04393" name="l04393"></a><span class="lineno"> 4393</span>      <span class="comment">//dihe+=intlje;</span></div>
<div class="line"><a id="l04394" name="l04394"></a><span class="lineno"> 4394</span>            <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; p : atgeom)</div>
<div class="line"><a id="l04395" name="l04395"></a><span class="lineno"> 4395</span>            {</div>
<div class="line"><a id="l04396" name="l04396"></a><span class="lineno"> 4396</span>        <a class="code hl_class" href="classAtom.html">Atom</a>* a=get&lt;0&gt;(p);</div>
<div class="line"><a id="l04397" name="l04397"></a><span class="lineno"> 4397</span>                <span class="comment">//cout &lt;&lt; getAngle(a,src,natom) &lt;&lt; &quot;\t&quot; &lt;&lt; (sys.ff.getAngleParamtersFailsafe(a-&gt;toString(),src-&gt;toString(),natom-&gt;toString()))[0] &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a id="l04398" name="l04398"></a><span class="lineno"> 4398</span>                <span class="comment">//if(abs(getAngle(a,src,natom)-(sys.ff.getAngleParamtersFailsafe(a-&gt;toString(),src-&gt;toString(),natom-&gt;toString()))[0])&gt;(10*PI/180.0)) {cout &lt;&lt; &quot;R\\a-1,&quot;; acc=false; break;}</span></div>
<div class="line"><a id="l04399" name="l04399"></a><span class="lineno"> 4399</span>        <span class="keywordflow">if</span>(!dihexist || natom-&gt;<a class="code hl_function" href="classAtom.html#a99ed78f1b94d694b0f3fac609fd92934">isHydrogen</a>()) <span class="keywordflow">if</span>(sys.ff-&gt;calculateAngleEnergy(a,src,natom,<span class="keyword">true</span>,THETACUT)!=0) {acc=<span class="keyword">false</span>; <span class="keywordflow">break</span>;}</div>
<div class="line"><a id="l04400" name="l04400"></a><span class="lineno"> 4400</span>                <span class="comment">//angcol=mol-&gt;getBondedAtoms(a);</span></div>
<div class="line"><a id="l04401" name="l04401"></a><span class="lineno"> 4401</span>                <span class="comment">/*for(Atom* a2 : get&lt;1&gt;(p))</span></div>
<div class="line"><a id="l04402" name="l04402"></a><span class="lineno"> 4402</span><span class="comment">                {</span></div>
<div class="line"><a id="l04403" name="l04403"></a><span class="lineno"> 4403</span><span class="comment">                    if(a2==src) continue;</span></div>
<div class="line"><a id="l04404" name="l04404"></a><span class="lineno"> 4404</span><span class="comment">                    //if(mol-&gt;calculateDihedralEnergy(a2,a,src,natom)&lt;DIHEDENERCUT) {acc=false; break;}</span></div>
<div class="line"><a id="l04405" name="l04405"></a><span class="lineno"> 4405</span><span class="comment">                    //if(ff.calculateDihedralEnergy(a2,a,src,natom,true,DIHEDTHETACUT)) {acc=false; break;}</span></div>
<div class="line"><a id="l04406" name="l04406"></a><span class="lineno"> 4406</span><span class="comment">          dihe+=sys.ff.calculateDihedralEnergy(a2,a,src,natom,false);</span></div>
<div class="line"><a id="l04407" name="l04407"></a><span class="lineno"> 4407</span><span class="comment">                }*/</span></div>
<div class="line"><a id="l04408" name="l04408"></a><span class="lineno"> 4408</span>                <span class="keywordflow">if</span>(!acc) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l04409" name="l04409"></a><span class="lineno"> 4409</span>            }</div>
<div class="line"><a id="l04410" name="l04410"></a><span class="lineno"> 4410</span>      <span class="comment">//cout &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a id="l04411" name="l04411"></a><span class="lineno"> 4411</span>            <span class="keywordflow">if</span>(acc) {<span class="comment">/*if(cyc) return make_pair(v,make_pair(0,0));*/</span> ret.push_back(make_pair(v+src-&gt;<a class="code hl_function" href="classAtom.html#a73b92d7b24611f250127856e3b52ed31">getPosition</a>(),make_pair(intlje,make_pair(proten,hsben))));}</div>
<div class="line"><a id="l04412" name="l04412"></a><span class="lineno"> 4412</span>            <span class="keywordflow">if</span>(ret.size()&gt;=num || cyc) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l04413" name="l04413"></a><span class="lineno"> 4413</span>        }</div>
<div class="line"><a id="l04414" name="l04414"></a><span class="lineno"> 4414</span>        tries--;</div>
<div class="line"><a id="l04415" name="l04415"></a><span class="lineno"> 4415</span>        <span class="keywordflow">if</span>(tries&lt;=0) <span class="keywordflow">break</span>; <span class="comment">//{mol-&gt;dumpMolAsTxt(&quot;faileddrug.txt&quot;); break;}</span></div>
<div class="line"><a id="l04416" name="l04416"></a><span class="lineno"> 4416</span>    }</div>
<div class="line"><a id="l04417" name="l04417"></a><span class="lineno"> 4417</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a id="l04418" name="l04418"></a><span class="lineno"> 4418</span>}</div>
<div class="ttc" id="aclassAtom_html"><div class="ttname"><a href="classAtom.html">Atom</a></div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00039">Atom.hpp:40</a></div></div>
<div class="ttc" id="aclassAtom_html_a1816a8312c1cd338b507522c6c1bde6b"><div class="ttname"><a href="classAtom.html#a1816a8312c1cd338b507522c6c1bde6b">Atom::isCyclized</a></div><div class="ttdeci">bool isCyclized() const</div><div class="ttdoc">A wrapper for cylc. Checks is the atom has cyclized or not.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00212">Atom.hpp:212</a></div></div>
<div class="ttc" id="aclassAtom_html_a189def3b8bade8507d49cfd7de881178"><div class="ttname"><a href="classAtom.html#a189def3b8bade8507d49cfd7de881178">Atom::toString</a></div><div class="ttdeci">const std::string &amp; toString() const</div><div class="ttdoc">Gives the atom name for this atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00110">Atom.hpp:110</a></div></div>
<div class="ttc" id="aclassAtom_html_a34fc2756d0f817a9ee6cf91c797d8bcc"><div class="ttname"><a href="classAtom.html#a34fc2756d0f817a9ee6cf91c797d8bcc">Atom::setPosition</a></div><div class="ttdeci">void setPosition(const Eigen::Vector3d &amp;v)</div><div class="ttdoc">Allows setting the position of the atom by providing an &quot;Eigen::Vector3d&quot; object.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00386">Atom.hpp:386</a></div></div>
<div class="ttc" id="aclassAtom_html_a40e4a43205a24f5e64ea0d27994a3efb"><div class="ttname"><a href="classAtom.html#a40e4a43205a24f5e64ea0d27994a3efb">Atom::bondVectorTo</a></div><div class="ttdeci">Eigen::Vector3d bondVectorTo(Atom *a) const</div><div class="ttdoc">Get a vector from this atom to 'a'.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00390">Atom.hpp:390</a></div></div>
<div class="ttc" id="aclassAtom_html_a73b92d7b24611f250127856e3b52ed31"><div class="ttname"><a href="classAtom.html#a73b92d7b24611f250127856e3b52ed31">Atom::getPosition</a></div><div class="ttdeci">Eigen::Vector3d getPosition() const</div><div class="ttdoc">Returns this complete position of the enitre atom in an &quot;Eigen::Vector3d&quot; object.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00385">Atom.hpp:385</a></div></div>
<div class="ttc" id="aclassAtom_html_a99ed78f1b94d694b0f3fac609fd92934"><div class="ttname"><a href="classAtom.html#a99ed78f1b94d694b0f3fac609fd92934">Atom::isHydrogen</a></div><div class="ttdeci">bool isHydrogen() const</div><div class="ttdoc">Tests if this atom is a hydrogen atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00153">Atom.hpp:153</a></div></div>
<div class="ttc" id="aclassAtom_html_ae2ac3a6ffdc90898d06d05eaf374960e"><div class="ttname"><a href="classAtom.html#ae2ac3a6ffdc90898d06d05eaf374960e">Atom::seek_valency</a></div><div class="ttdeci">int seek_valency() const</div><div class="ttdoc">Get the number of free valencies this atom has.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00378">Atom.hpp:378</a></div></div>
<div class="ttc" id="aclassCategory_html_a3ffa41a593852318c167862171166f1b"><div class="ttname"><a href="classCategory.html#a3ffa41a593852318c167862171166f1b">Category::contains</a></div><div class="ttdeci">bool contains(const Atom *a) const</div><div class="ttdoc">Checks whether a particular atom type is grouped under this Category.</div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00305">forcefield.hpp:305</a></div></div>
<div class="ttc" id="aclassDataNotAvailableException_html"><div class="ttname"><a href="classDataNotAvailableException.html">DataNotAvailableException</a></div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00013">forcefield.hpp:13</a></div></div>
<div class="ttc" id="aclassForceField_html_a0b53370d39b444980839b0b6181ee0cf"><div class="ttname"><a href="classForceField.html#a0b53370d39b444980839b0b6181ee0cf">ForceField::expandMultiplicity</a></div><div class="ttdeci">static std::vector&lt; double &gt; expandMultiplicity(double v, int m)</div><div class="ttdoc">Expand dihedral multiplicity to explicitly write down the allowed dihedrals. See algorithm PDF (the d...</div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l00794">forcefield.hpp:794</a></div></div>
<div class="ttc" id="aclassMolecule_html"><div class="ttname"><a href="classMolecule.html">Molecule</a></div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00477">Molecule.hpp:478</a></div></div>
<div class="ttc" id="aclassMolecule_html_a728fa63d31ed43876593086571e82cf6"><div class="ttname"><a href="classMolecule.html#a728fa63d31ed43876593086571e82cf6">Molecule::describeStructure</a></div><div class="ttdeci">void describeStructure(std::ostream &amp;outs=std::cout) const</div><div class="ttdoc">Symbolically describe the structure of the molecule.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l01563">Molecule.hpp:1563</a></div></div>
<div class="ttc" id="aclassMolecule_html_aef77043ab98f1008a15a1e52d85b827e"><div class="ttname"><a href="classMolecule.html#aef77043ab98f1008a15a1e52d85b827e">Molecule::getBondedAtoms</a></div><div class="ttdeci">const std::vector&lt; Atom * &gt; getBondedAtoms(Atom *src) const</div><div class="ttdoc">Get all atoms bonded to a given atom.</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00994">Molecule.hpp:994</a></div></div>
<div class="ttc" id="aclassNoPositionAvailableException_html"><div class="ttname"><a href="classNoPositionAvailableException.html">NoPositionAvailableException</a></div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00065">Molecule.hpp:65</a></div></div>
<div class="ttc" id="aclassProtein_html"><div class="ttname"><a href="classProtein.html">Protein</a></div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l03064">Molecule.hpp:3065</a></div></div>
<div class="ttc" id="anamespacechemtools_html_a330bbc0a28d98a7b8d22150d8e590050"><div class="ttname"><a href="namespacechemtools.html#a330bbc0a28d98a7b8d22150d8e590050">chemtools::getAngle</a></div><div class="ttdeci">static double getAngle(Atom *a1, Atom *a2, Atom *a3)</div><div class="ttdoc">Calculate the angle between any three atoms.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00471">Atom.hpp:471</a></div></div>
<div class="ttc" id="anamespacechemtools_html_a4d736b938261879ac0c621cd97172a7a"><div class="ttname"><a href="namespacechemtools.html#a4d736b938261879ac0c621cd97172a7a">chemtools::getNonbondingPotential</a></div><div class="ttdeci">static double getNonbondingPotential(Atom *a1, Atom *a2)</div><div class="ttdoc">A wrapper that uses the stored parameters of Atom objects to calculate non-bonding interaction betwee...</div><div class="ttdef"><b>Definition:</b> <a href="Molecule_8hpp_source.html#l00366">Molecule.hpp:366</a></div></div>
<div class="ttc" id="anamespacequickgeom_html_a78c6886551455b71fe88580560aae508"><div class="ttname"><a href="namespacequickgeom.html#a78c6886551455b71fe88580560aae508">quickgeom::getRandomVectorsInShell</a></div><div class="ttdeci">static std::vector&lt; Eigen::Vector3d &gt; getRandomVectorsInShell(const Eigen::Vector3d &amp;origin, const double &amp;radius, int sampleSize, int devid=0)</div><div class="ttdoc">A wrapper to generate multiple vectors around a given centre (useful while trialling seed positions o...</div><div class="ttdef"><b>Definition:</b> <a href="commons_8h_source.html#l00499">commons.h:499</a></div></div>
<div class="ttc" id="anamespacequickgeom_html_aa2a985eca968dd07d69c6460717c1d1c"><div class="ttname"><a href="namespacequickgeom.html#aa2a985eca968dd07d69c6460717c1d1c">quickgeom::getConePositions</a></div><div class="ttdeci">static std::vector&lt; Eigen::Vector3d &gt; getConePositions(const Eigen::Vector3d &amp;fixed, double length, double angle, int num=10, int devid=0)</div><div class="ttdoc">Get positions inside the cross-section of cone for trialling positions with given bond length and ang...</div><div class="ttdef"><b>Definition:</b> <a href="commons_8h_source.html#l00531">commons.h:531</a></div></div>
<div class="ttc" id="anamespacequickgeom_html_af60aae27d8f525f83c7088e81fcda69f"><div class="ttname"><a href="namespacequickgeom.html#af60aae27d8f525f83c7088e81fcda69f">quickgeom::getArcPositions</a></div><div class="ttdeci">static std::vector&lt; Eigen::Vector3d &gt; getArcPositions(const Eigen::Vector3d &amp;fixed, const Eigen::Vector3d &amp;def, double length, double angle, const std::vector&lt; double &gt; &amp;dihedral, int num=10, int devid=0)</div><div class="ttdoc">The function used for generating trial positions with a given length, angle and set of allowed dihedr...</div><div class="ttdef"><b>Definition:</b> <a href="commons_8h_source.html#l00559">commons.h:559</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0257a011fb4df690121cb9bf71cc67e8" name="a0257a011fb4df690121cb9bf71cc67e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0257a011fb4df690121cb9bf71cc67e8">&#9670;&nbsp;</a></span>getElectrostaticEnergy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double chemtools::getElectrostaticEnergy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the electrostatic interaction energy between two atoms distance 'r' apart. </p>
<p >This function does not use the positions of the atoms provided to get the distance. Instead these atoms are used only as holders for atom-type data and it uses the charges from the atom-type data as well. </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00352">352</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>{<span class="keywordflow">return</span> calculateElectrostaticPotential(a1-&gt;<a class="code hl_function" href="classAtom.html#a2b74c9d1a56b37907b911dff932e06bb">seek_charge</a>(),a2-&gt;<a class="code hl_function" href="classAtom.html#a2b74c9d1a56b37907b911dff932e06bb">seek_charge</a>(),r,(a1-&gt;<a class="code hl_variable" href="classAtom.html#a4c63bddb98ac4001372af2f6e5279fe5">posdev</a>+a2-&gt;<a class="code hl_variable" href="classAtom.html#a4c63bddb98ac4001372af2f6e5279fe5">posdev</a>)/2);}</div>
<div class="ttc" id="aclassAtom_html_a2b74c9d1a56b37907b911dff932e06bb"><div class="ttname"><a href="classAtom.html#a2b74c9d1a56b37907b911dff932e06bb">Atom::seek_charge</a></div><div class="ttdeci">double seek_charge() const</div><div class="ttdoc">Get the force-field (or otherwise loaded) charge parameter for this atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00380">Atom.hpp:380</a></div></div>
<div class="ttc" id="aclassAtom_html_a4c63bddb98ac4001372af2f6e5279fe5"><div class="ttname"><a href="classAtom.html#a4c63bddb98ac4001372af2f6e5279fe5">Atom::posdev</a></div><div class="ttdeci">double posdev</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00056">Atom.hpp:56</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a79d7722db71286b1fe58858f47f72dbe" name="a79d7722db71286b1fe58858f47f72dbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79d7722db71286b1fe58858f47f72dbe">&#9670;&nbsp;</a></span>getElectrostaticForce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double chemtools::getElectrostaticForce </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the electrostatic force between two atoms distance 'r' apart. </p>
<p >This function does not use the positions of the atoms provided to get the distance. Instead these atoms are used only as holders for atom-type data and it uses the charges from the atom-type data as well. </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00356">356</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>{<span class="keywordflow">return</span> calculateElectrostaticForce(a1-&gt;<a class="code hl_function" href="classAtom.html#a2b74c9d1a56b37907b911dff932e06bb">seek_charge</a>(),a2-&gt;<a class="code hl_function" href="classAtom.html#a2b74c9d1a56b37907b911dff932e06bb">seek_charge</a>(),r);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a56a8750722bf7f58e4dd0539497527e7" name="a56a8750722bf7f58e4dd0539497527e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56a8750722bf7f58e4dd0539497527e7">&#9670;&nbsp;</a></span>getLJForce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double chemtools::getLJForce </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the L-J (Lennard Jones) force between two atoms distance 'r' apart. </p>
<p >This function does not use the positions of the atoms provided to get the distance. Instead these atoms are used only as holders for atom-type data and it uses the internal σ, ε from the atom-type data as well </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00364">364</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>{<span class="keywordflow">return</span> calculateLJForce(a1-&gt;<a class="code hl_function" href="classAtom.html#af064e5513e564187fd4e5726c9c1d5a7">seek_sigma</a>(),a2-&gt;<a class="code hl_function" href="classAtom.html#af064e5513e564187fd4e5726c9c1d5a7">seek_sigma</a>(),a1-&gt;<a class="code hl_function" href="classAtom.html#a9affdff9e2e1ac38e17f13428d678044">seek_epsilon</a>(),a2-&gt;<a class="code hl_function" href="classAtom.html#a9affdff9e2e1ac38e17f13428d678044">seek_epsilon</a>(),r);}</div>
<div class="ttc" id="aclassAtom_html_a9affdff9e2e1ac38e17f13428d678044"><div class="ttname"><a href="classAtom.html#a9affdff9e2e1ac38e17f13428d678044">Atom::seek_epsilon</a></div><div class="ttdeci">double seek_epsilon() const</div><div class="ttdoc">Get the force-field (or otherwise loaded) epsilon parameter for this atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00382">Atom.hpp:382</a></div></div>
<div class="ttc" id="aclassAtom_html_af064e5513e564187fd4e5726c9c1d5a7"><div class="ttname"><a href="classAtom.html#af064e5513e564187fd4e5726c9c1d5a7">Atom::seek_sigma</a></div><div class="ttdeci">double seek_sigma() const</div><div class="ttdoc">Get the force-field (or otherwise loaded) sigma parameter for this atom.</div><div class="ttdef"><b>Definition:</b> <a href="Atom_8hpp_source.html#l00381">Atom.hpp:381</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7437535dfce8aac7d0e53487331c5062" name="a7437535dfce8aac7d0e53487331c5062"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7437535dfce8aac7d0e53487331c5062">&#9670;&nbsp;</a></span>getLJInteraction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double chemtools::getLJInteraction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classAtom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the L-J (Lennard Jones) interaction energy between two atoms distance 'r' apart. </p>
<p >This function does not use the positions of the atoms provided to get the distance. Instead these atoms are used only as holders for atom-type data and it uses the internal σ, ε from the atom-type data as well </p>

<p class="definition">Definition at line <a class="el" href="Molecule_8hpp_source.html#l00360">360</a> of file <a class="el" href="Molecule_8hpp_source.html">Molecule.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>{<span class="keywordflow">return</span> calculateLJEnergy(a1-&gt;<a class="code hl_function" href="classAtom.html#af064e5513e564187fd4e5726c9c1d5a7">seek_sigma</a>(),a2-&gt;<a class="code hl_function" href="classAtom.html#af064e5513e564187fd4e5726c9c1d5a7">seek_sigma</a>(),a1-&gt;<a class="code hl_function" href="classAtom.html#a9affdff9e2e1ac38e17f13428d678044">seek_epsilon</a>(),a2-&gt;<a class="code hl_function" href="classAtom.html#a9affdff9e2e1ac38e17f13428d678044">seek_epsilon</a>(),r,(a1-&gt;<a class="code hl_variable" href="classAtom.html#a4c63bddb98ac4001372af2f6e5279fe5">posdev</a>+a2-&gt;<a class="code hl_variable" href="classAtom.html#a4c63bddb98ac4001372af2f6e5279fe5">posdev</a>)/2);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0566d6420d090a2cd4d9530bca1b769" name="ac0566d6420d090a2cd4d9530bca1b769"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0566d6420d090a2cd4d9530bca1b769">&#9670;&nbsp;</a></span>getRuleset() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::pair&lt; std::string, std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">chemtools::Rule</a> &gt; &gt; &gt; chemtools::getRuleset </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> *&#160;</td>
          <td class="paramname"><em>ff</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Load all rules from a file. </p>
<p >Load all the rules atomtype-wise from the input file. <a class="el" href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66" title="Generate a set of Rule objects by parsing a line from the definitions file (See PDF for definition fo...">buildRules()</a> is used to build the rules.<br  />
 See the documentation PDF for the atom-type definition file format </p><dl class="section return"><dt>Returns</dt><dd>a list with pairs of atom-types and the list of rules it is expected to satisfy (std::vector&lt;std::pair&lt;std::string,std::vector&lt;Rule&gt;&gt;&gt;) </dd></dl>

<p class="definition">Definition at line <a class="el" href="forcefield_8hpp_source.html#l01287">1287</a> of file <a class="el" href="forcefield_8hpp_source.html">forcefield.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>{</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>    std::vector&lt;std::pair&lt;std::string,std::vector&lt;chemtools::Rule&gt;&gt;&gt; ret;</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>    std::ifstream inf; inf.open(file,ios::in);</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>    <span class="keywordflow">if</span>(!inf) <span class="keywordflow">throw</span> <a class="code hl_class" href="classFileNotFoundException.html">FileNotFoundException</a>();</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>    std::string str;</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>    <span class="keywordtype">int</span> constcount=0;</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>    <span class="keywordflow">while</span>(<span class="keyword">true</span>)</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>    {</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>        getline(inf,str);</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>        <span class="keywordflow">if</span>(inf.eof()) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>        std::vector&lt;chemtools::Rule&gt; rules=<a class="code hl_function" href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66">buildRules</a>(str,ff);</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>        <span class="keywordflow">if</span>(!rules.size()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>        <span class="keywordflow">if</span>(ff)</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>        {</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>            <span class="comment">//cout &lt;&lt; rules[0].getCentre()&lt;&lt;&quot; &quot;&lt;&lt; rules.size() &lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>            constcount=0;</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>            <span class="keywordflow">for</span>(<span class="keyword">const</span> <a class="code hl_class" href="classchemtools_1_1Rule.html">Rule</a>&amp; r : rules) constcount+=r.getMin();</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span><span class="preprocessor">            #ifndef QUIET</span></div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>            cout &lt;&lt; rules[0].getCentre()&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt; constcount &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span><span class="preprocessor">            #endif</span></div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>            <span class="comment">//if(constcount&gt;ff-&gt;getAtom(rules[0].getCentre())-&gt;seek_valency()) throw RulesExceedValenciesException();</span></div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>        }</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>        ret.push_back(make_pair(rules[0].getCentre(),rules));</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>    }</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>}</div>
<div class="ttc" id="aclassFileNotFoundException_html"><div class="ttname"><a href="classFileNotFoundException.html">FileNotFoundException</a></div><div class="ttdef"><b>Definition:</b> <a href="commons_8h_source.html#l00019">commons.h:19</a></div></div>
<div class="ttc" id="anamespacechemtools_html_a6c73fdd6c186f091225ee45907fe6b66"><div class="ttname"><a href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66">chemtools::buildRules</a></div><div class="ttdeci">static std::vector&lt; Rule &gt; buildRules(const std::string &amp;def, const ForceField *ff=nullptr)</div><div class="ttdoc">Generate a set of Rule objects by parsing a line from the definitions file (See PDF for definition fo...</div><div class="ttdef"><b>Definition:</b> <a href="forcefield_8hpp_source.html#l01273">forcefield.hpp:1273</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0566d6420d090a2cd4d9530bca1b769" name="ac0566d6420d090a2cd4d9530bca1b769"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0566d6420d090a2cd4d9530bca1b769">&#9670;&nbsp;</a></span>getRuleset() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::pair&lt; std::string, std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">chemtools::Rule</a> &gt; &gt; &gt; chemtools::getRuleset </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> *&#160;</td>
          <td class="paramname"><em>ff</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Load all rules from a file. </p>
<p >Load all the rules atomtype-wise from the input file. <a class="el" href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66" title="Generate a set of Rule objects by parsing a line from the definitions file (See PDF for definition fo...">buildRules()</a> is used to build the rules.<br  />
 See the documentation PDF for the atom-type definition file format </p><dl class="section return"><dt>Returns</dt><dd>a list with pairs of atom-types and the list of rules it is expected to satisfy (std::vector&lt;std::pair&lt;std::string,std::vector&lt;Rule&gt;&gt;&gt;) </dd></dl>

<p class="definition">Definition at line <a class="el" href="forcefield__precomp_8hpp_source.html#l01190">1190</a> of file <a class="el" href="forcefield__precomp_8hpp_source.html">forcefield_precomp.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>{</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>    std::vector&lt;std::pair&lt;std::string,std::vector&lt;chemtools::Rule&gt;&gt;&gt; ret;</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>    std::ifstream inf; inf.open(file,ios::in);</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>    <span class="keywordflow">if</span>(!inf) <span class="keywordflow">throw</span> <a class="code hl_class" href="classFileNotFoundException.html">FileNotFoundException</a>();</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>    std::string str;</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>    <span class="keywordtype">int</span> constcount=0;</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>    <span class="keywordflow">while</span>(<span class="keyword">true</span>)</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>    {</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>        getline(inf,str);</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>        <span class="keywordflow">if</span>(inf.eof()) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>        std::vector&lt;chemtools::Rule&gt; rules=<a class="code hl_function" href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66">buildRules</a>(str,ff);</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>        <span class="keywordflow">if</span>(!rules.size()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>        <span class="keywordflow">if</span>(ff)</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>        {</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>            <span class="comment">//cout &lt;&lt; rules[0].getCentre()&lt;&lt;&quot; &quot;&lt;&lt; rules.size() &lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>            constcount=0;</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>            <span class="keywordflow">for</span>(<span class="keyword">const</span> <a class="code hl_class" href="classchemtools_1_1Rule.html">Rule</a>&amp; r : rules) constcount+=r.getMin();</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span><span class="preprocessor">            #ifndef QUIET</span></div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>            cout &lt;&lt; rules[0].getCentre()&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt; constcount &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span><span class="preprocessor">            #endif</span></div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>            <span class="comment">//if(constcount&gt;ff-&gt;getAtom(rules[0].getCentre())-&gt;seek_valency()) throw RulesExceedValenciesException();</span></div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>        }</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>        ret.push_back(make_pair(rules[0].getCentre(),rules));</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>    }</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0566d6420d090a2cd4d9530bca1b769" name="ac0566d6420d090a2cd4d9530bca1b769"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0566d6420d090a2cd4d9530bca1b769">&#9670;&nbsp;</a></span>getRuleset() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::pair&lt; std::string, std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">chemtools::Rule</a> &gt; &gt; &gt; chemtools::getRuleset </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> *&#160;</td>
          <td class="paramname"><em>ff</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Load all rules from a file. </p>
<p >Load all the rules atomtype-wise from the input file. <a class="el" href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66" title="Generate a set of Rule objects by parsing a line from the definitions file (See PDF for definition fo...">buildRules()</a> is used to build the rules.<br  />
 See the documentation PDF for the atom-type definition file format </p><dl class="section return"><dt>Returns</dt><dd>a list with pairs of atom-types and the list of rules it is expected to satisfy (std::vector&lt;std::pair&lt;std::string,std::vector&lt;Rule&gt;&gt;&gt;) </dd></dl>

<p class="definition">Definition at line <a class="el" href="forcefield__precomp__omega__stable_8hpp_source.html#l01095">1095</a> of file <a class="el" href="forcefield__precomp__omega__stable_8hpp_source.html">forcefield_precomp_omega_stable.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>{</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>    std::vector&lt;std::pair&lt;std::string,std::vector&lt;chemtools::Rule&gt;&gt;&gt; ret;</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>    std::ifstream inf; inf.open(file,ios::in);</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>    <span class="keywordflow">if</span>(!inf) <span class="keywordflow">throw</span> <a class="code hl_class" href="classFileNotFoundException.html">FileNotFoundException</a>();</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>    std::string str;</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>    <span class="keywordtype">int</span> constcount=0;</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>    <span class="keywordflow">while</span>(<span class="keyword">true</span>)</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>    {</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>        getline(inf,str);</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>        <span class="keywordflow">if</span>(inf.eof()) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>        std::vector&lt;chemtools::Rule&gt; rules=<a class="code hl_function" href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66">buildRules</a>(str,ff);</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>        <span class="keywordflow">if</span>(!rules.size()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>        <span class="keywordflow">if</span>(ff)</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>        {</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>            <span class="comment">//cout &lt;&lt; rules[0].getCentre()&lt;&lt;&quot; &quot;&lt;&lt; rules.size() &lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>            constcount=0;</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>            <span class="keywordflow">for</span>(<span class="keyword">const</span> <a class="code hl_class" href="classchemtools_1_1Rule.html">Rule</a>&amp; r : rules) constcount+=r.getMin();</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span><span class="preprocessor">            #ifndef QUIET</span></div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>            cout &lt;&lt; rules[0].getCentre()&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt; constcount &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span><span class="preprocessor">            #endif</span></div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>            <span class="comment">//if(constcount&gt;ff-&gt;getAtom(rules[0].getCentre())-&gt;seek_valency()) throw RulesExceedValenciesException();</span></div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>        }</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>        ret.push_back(make_pair(rules[0].getCentre(),rules));</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>    }</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0566d6420d090a2cd4d9530bca1b769" name="ac0566d6420d090a2cd4d9530bca1b769"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0566d6420d090a2cd4d9530bca1b769">&#9670;&nbsp;</a></span>getRuleset() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::pair&lt; std::string, std::vector&lt; <a class="el" href="classchemtools_1_1Rule.html">chemtools::Rule</a> &gt; &gt; &gt; chemtools::getRuleset </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classForceField.html">ForceField</a> *&#160;</td>
          <td class="paramname"><em>ff</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Load all rules from a file. </p>
<p >Load all the rules atomtype-wise from the input file. <a class="el" href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66" title="Generate a set of Rule objects by parsing a line from the definitions file (See PDF for definition fo...">buildRules()</a> is used to build the rules.<br  />
 See the documentation PDF for the atom-type definition file format </p><dl class="section return"><dt>Returns</dt><dd>a list with pairs of atom-types and the list of rules it is expected to satisfy (std::vector&lt;std::pair&lt;std::string,std::vector&lt;Rule&gt;&gt;&gt;) </dd></dl>

<p class="definition">Definition at line <a class="el" href="forcefield__precomp__omega__stable2_8hpp_source.html#l01188">1188</a> of file <a class="el" href="forcefield__precomp__omega__stable2_8hpp_source.html">forcefield_precomp_omega_stable2.hpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>{</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>    std::vector&lt;std::pair&lt;std::string,std::vector&lt;chemtools::Rule&gt;&gt;&gt; ret;</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>    std::ifstream inf; inf.open(file,ios::in);</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>    <span class="keywordflow">if</span>(!inf) <span class="keywordflow">throw</span> <a class="code hl_class" href="classFileNotFoundException.html">FileNotFoundException</a>();</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>    std::string str;</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>    <span class="keywordtype">int</span> constcount=0;</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>    <span class="keywordflow">while</span>(<span class="keyword">true</span>)</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>    {</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>        getline(inf,str);</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>        <span class="keywordflow">if</span>(inf.eof()) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>        std::vector&lt;chemtools::Rule&gt; rules=<a class="code hl_function" href="namespacechemtools.html#a6c73fdd6c186f091225ee45907fe6b66">buildRules</a>(str,ff);</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>        <span class="keywordflow">if</span>(!rules.size()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>        <span class="keywordflow">if</span>(ff)</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>        {</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>            <span class="comment">//cout &lt;&lt; rules[0].getCentre()&lt;&lt;&quot; &quot;&lt;&lt; rules.size() &lt;&lt;&quot;\n&quot;;</span></div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>            constcount=0;</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>            <span class="keywordflow">for</span>(<span class="keyword">const</span> <a class="code hl_class" href="classchemtools_1_1Rule.html">Rule</a>&amp; r : rules) constcount+=r.getMin();</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span><span class="preprocessor">            #ifndef QUIET</span></div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>            cout &lt;&lt; rules[0].getCentre()&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt; constcount &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span><span class="preprocessor">            #endif</span></div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>            <span class="comment">//if(constcount&gt;ff-&gt;getAtom(rules[0].getCentre())-&gt;seek_valency()) throw RulesExceedValenciesException();</span></div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>        }</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>        ret.push_back(make_pair(rules[0].getCentre(),rules));</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>    }</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
