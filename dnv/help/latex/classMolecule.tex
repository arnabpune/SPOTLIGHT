\hypertarget{classMolecule}{}\doxysection{Molecule Class Reference}
\label{classMolecule}\index{Molecule@{Molecule}}


{\ttfamily \#include \char`\"{}graph/\+Molecule.\+hpp\char`\"{}}

Inheritance diagram for Molecule\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=4.000000cm]{classMolecule}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classMolecule_a5744317e0c2c298f7e74873be2f46abc}\label{classMolecule_a5744317e0c2c298f7e74873be2f46abc}} 
{\bfseries Molecule} (\mbox{\hyperlink{classAtom}{Atom}} $\ast$a)
\begin{DoxyCompactList}\small\item\em Load a single atom (eg. when starting generation from single atom seed) \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMolecule_aa08b915718a7851b753c0cd9acb026f8}{Molecule}} (std\+::vector$<$ \mbox{\hyperlink{classAtom}{Atom}} $\ast$ $>$)
\begin{DoxyCompactList}\small\item\em Load a molecule by just collecting atoms. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_ab5dd0fff02c29ca0e4209822857cf66f}\label{classMolecule_ab5dd0fff02c29ca0e4209822857cf66f}} 
{\bfseries Molecule} (std\+::vector$<$ \mbox{\hyperlink{classAtom}{Atom}} $\ast$ $>$, std\+::vector$<$ std\+::vector$<$ int $>$ $>$ b)
\begin{DoxyCompactList}\small\item\em Load a molecule from a set of atoms and some connections. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_acf1c3fa4a6d3c6d6c530ea0b620807c5}\label{classMolecule_acf1c3fa4a6d3c6d6c530ea0b620807c5}} 
{\bfseries Molecule} (int n)
\begin{DoxyCompactList}\small\item\em Allocate space for \textquotesingle{}n\textquotesingle{} atoms in this \mbox{\hyperlink{classMolecule}{Molecule}} object. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMolecule_a21ee086bf224ec95f24aae555e94b5b9}{Molecule}} (const \mbox{\hyperlink{classMolecule}{Molecule}} $\ast$o)
\begin{DoxyCompactList}\small\item\em The \mbox{\hyperlink{classMolecule}{Molecule}} class copy constructor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMolecule_a041d96213e53bd501f94b46cc36d74f6}{Molecule}} (std\+::istream \&f, bool eval=false, bool cpt=false, const \mbox{\hyperlink{classForceField}{Force\+Field}} $\ast$ff=nullptr)
\begin{DoxyCompactList}\small\item\em Load a molecule from TXT format (see algorithm PDF for details on TXT format) \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMolecule_abd5df1c615fa93e4c0ce80e6a9dcd900}{Molecule}} (const char $\ast$file, bool eval=false)
\begin{DoxyCompactList}\small\item\em Load a molecule from TXT format (see algorithm PDF for details on TXT format) \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMolecule_a834ac3e93af40e0f03bf1bb83c1ccb3e}{Molecule}} (const std\+::string \&infile, const \mbox{\hyperlink{classForceField}{Force\+Field}} \&ff, const std\+::string \&format=\char`\"{}pdb\char`\"{}, bool eval=false, bool warnf=false, char chain=\textquotesingle{}A\textquotesingle{})
\begin{DoxyCompactList}\small\item\em Load \mbox{\hyperlink{classMolecule}{Molecule}} from a standard format (PDB or GRO) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_ad35a661359739714f8b03295788e4dc4}\label{classMolecule_ad35a661359739714f8b03295788e4dc4}} 
{\bfseries Molecule} (std\+::istream \&infile, const \mbox{\hyperlink{classForceField}{Force\+Field}} \&ff, const std\+::string \&format=\char`\"{}pdb\char`\"{}, bool eval=false, bool warnf=false, char chain=\textquotesingle{}A\textquotesingle{})
\begin{DoxyCompactList}\small\item\em An alternative to \mbox{\hyperlink{classMolecule_a834ac3e93af40e0f03bf1bb83c1ccb3e}{Molecule\+::\+Molecule(const std\+::string\&,const Force\+Field\&,const std\+::string\&,bool,bool,char)}} where instead of filename, a stream is provided. Useful when multiple molecules are stored in the same file. See Also(load\+From\+Checkpoint()) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a1ff980b574a62526abff3d631c83bf94}\label{classMolecule_a1ff980b574a62526abff3d631c83bf94}} 
{\bfseries $\sim$\+Molecule} ()
\begin{DoxyCompactList}\small\item\em Default destructor\+: {\bfseries{Deletes its atom data}} and frees up memory. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a8cdf18b0095a344a34d5ffe80be73d98}\label{classMolecule_a8cdf18b0095a344a34d5ffe80be73d98}} 
void {\bfseries load\+Molecule\+From\+TXT} (std\+::istream \&f, bool eval=false, bool cpt=false, const \mbox{\hyperlink{classForceField}{Force\+Field}} $\ast$ff=nullptr)
\begin{DoxyCompactList}\small\item\em Actual function called in the TXT file loading constructor. See\+: Molecule\+::\+Molecule(std\+::istream\&,bool,bool) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a6946cbe0d8daa9b2386d85ca7faf0cd1}\label{classMolecule_a6946cbe0d8daa9b2386d85ca7faf0cd1}} 
int {\bfseries get\+Size} () const
\begin{DoxyCompactList}\small\item\em Get the total number of atoms (including hydrogen atoms) in this \mbox{\hyperlink{classMolecule}{Molecule}}. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMolecule_a4c6228c3225bd9571ba276841caa7c90}{get\+Effective\+Size}} () const
\begin{DoxyCompactList}\small\item\em Get the total number of atoms (excluding hydrogen atoms) in this \mbox{\hyperlink{classMolecule}{Molecule}}. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a75dace1f6d0736e85fbe517a0f26e136}\label{classMolecule_a75dace1f6d0736e85fbe517a0f26e136}} 
const \mbox{\hyperlink{classAtom}{Atom}} $\ast$ {\bfseries get\+Atom} (int n) const
\begin{DoxyCompactList}\small\item\em Get the pointer to the \textquotesingle{}n\textquotesingle{}th atom in this \mbox{\hyperlink{classMolecule}{Molecule}} (alternate method for a \char`\"{}const\char`\"{} \mbox{\hyperlink{classMolecule}{Molecule}} object) \end{DoxyCompactList}\item 
const \mbox{\hyperlink{classAtom}{Atom}} $\ast$ \mbox{\hyperlink{classMolecule_a1a3d512a623d6ffdcc21783b651c1dee}{get\+Last\+Atom}} () const
\begin{DoxyCompactList}\small\item\em Get the last atom in this molecule. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a8c5e2e247a65abf29d4bb379d09efb90}\label{classMolecule_a8c5e2e247a65abf29d4bb379d09efb90}} 
double {\bfseries get\+Mass} () const
\begin{DoxyCompactList}\small\item\em Get the mass of this molecule (by adding masses of individual atoms) \end{DoxyCompactList}\item 
const std\+::vector$<$ \mbox{\hyperlink{classAtom}{Atom}} $\ast$ $>$ \& \mbox{\hyperlink{classMolecule_a7d42c427c602da77f79246fe39246fb9}{get\+Atoms}} () const
\begin{DoxyCompactList}\small\item\em Get a copy of the list of atoms belonging to this \mbox{\hyperlink{classMolecule}{Molecule}}. \end{DoxyCompactList}\item 
const std\+::vector$<$ std\+::vector$<$ int $>$ $>$ \& \mbox{\hyperlink{classMolecule_a7b87ff96eec588c7296fcda7ee7ed178}{get\+Bonds}} () const
\begin{DoxyCompactList}\small\item\em Get the bonding data of the molecule. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_afcdacd3ae6feb61f05cdc306ed8ab29d}\label{classMolecule_afcdacd3ae6feb61f05cdc306ed8ab29d}} 
\mbox{\hyperlink{classAtom}{Atom}} $\ast$ {\bfseries get\+Atom} (int x)
\begin{DoxyCompactList}\small\item\em Get the pointer to the \textquotesingle{}n\textquotesingle{}th atom in this \mbox{\hyperlink{classMolecule}{Molecule}}. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMolecule_aa13276cae00e350b9b28c07cb82ebcec}{index\+Of}} (\mbox{\hyperlink{classAtom}{Atom}} $\ast$p) const
\begin{DoxyCompactList}\small\item\em Get the index value of an atom from it\textquotesingle{}s pointer. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a008ae56ec47345e906b08db6d2fd2b1c}\label{classMolecule_a008ae56ec47345e906b08db6d2fd2b1c}} 
double {\bfseries binding\+\_\+energy} () const
\begin{DoxyCompactList}\small\item\em a wrapper to get the calculated binding energy for this molecule. See Protein\+::calculate\+Non\+Bonding\+Energy(\+Molecule$\ast$). \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a5fbc68980ca26d735d65eaf7c35a49c4}\label{classMolecule_a5fbc68980ca26d735d65eaf7c35a49c4}} 
double {\bfseries hotspot\+\_\+binding\+\_\+energy} () const
\begin{DoxyCompactList}\small\item\em a wrapper to get the calculated binding energy (the contribution of the \char`\"{}hotspot\char`\"{} region) for this molecule. See Protein\+::calculate\+Non\+Bonding\+Energy(\+Molecule$\ast$). \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_aadf1f51e311a11e69385ff51602b86bc}{add\+Atom}} (\mbox{\hyperlink{classAtom}{Atom}} $\ast$a)
\begin{DoxyCompactList}\small\item\em Add a new atom to the \mbox{\hyperlink{classMolecule}{Molecule}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_ab64af9956394c7077c0ebf2db64b9cdf}{calculate\+Bond\+Orders}} (\mbox{\hyperlink{classForceField}{Force\+Field}} \&ff, bool assume\+\_\+complete=false, bool assign\+\_\+valence=false)
\begin{DoxyCompactList}\small\item\em Calculate bond orders for the bonds of this molecules (experimental) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_aa0590f11faa97d063d7542f91587898c}\label{classMolecule_aa0590f11faa97d063d7542f91587898c}} 
void {\bfseries calculate\+Bond\+Orders2} (\mbox{\hyperlink{classForceField}{Force\+Field}} \&ff, bool assume\+\_\+complete=false, bool assign\+\_\+valence=false)
\begin{DoxyCompactList}\small\item\em An update on the original \mbox{\hyperlink{classMolecule_ab64af9956394c7077c0ebf2db64b9cdf}{calculate\+Bond\+Orders()}} method. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_abfd8b7d4b46f69a9675e2fcac4397d19}{mark\+Cyclized\+Atoms}} ()
\begin{DoxyCompactList}\small\item\em Mark the atoms which are cyclized. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMolecule_a8234989a3038abdd2228bf243cb7f668}{calculate\+NRot}} (const \mbox{\hyperlink{classForceField}{Force\+Field}} $\ast$ff=nullptr, bool mod=false)
\begin{DoxyCompactList}\small\item\em Calculate the number of rotatable bonds. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_acae7cca34de5ee4bf83f6627e7501ab8}\label{classMolecule_acae7cca34de5ee4bf83f6627e7501ab8}} 
void {\bfseries print\+Structure\+Tree} ()
\begin{DoxyCompactList}\small\item\em Print out the adjacency list to standard output. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_aa3b73777e17fa7a34d15866fab326cfc}{seal\+All}} ()
\begin{DoxyCompactList}\small\item\em \char`\"{}\+Caps\char`\"{} all the atoms of this molecule \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_ab6c1f0207db1069de8e3a49a1881e880}{free}} (\mbox{\hyperlink{classAtom}{Atom}} $\ast$a, int val=-\/1)
\begin{DoxyCompactList}\small\item\em Manually \char`\"{}frees\char`\"{} a capped or completely valency satisfied atom. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a588965bd448a1cb43f25aed3179ecf96}\label{classMolecule_a588965bd448a1cb43f25aed3179ecf96}} 
void {\bfseries calculate\+Free\+Atoms} ()
\begin{DoxyCompactList}\small\item\em Manually parse the atom-\/list to add/remove atoms from the \char`\"{}free atoms\char`\"{} list. This is useful only when the \mbox{\hyperlink{classMolecule}{Molecule}} has been manually constructed (using functions like \mbox{\hyperlink{classMolecule_aadf1f51e311a11e69385ff51602b86bc}{add\+Atom()}}, \mbox{\hyperlink{classMolecule_a04b3beb3e333664d6421e9f0ee46dd73}{make\+Bond()}}, and \mbox{\hyperlink{classMolecule_aebc4ac8f4a68e24dbb0720402798ca4e}{bond\+Atom()}}) \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classMolecule_a1b92bf02eb26dd75ea36273601e0a3c2}{load\+Grid}} (\mbox{\hyperlink{classSystem}{System}} \&s)
\item 
const std\+::vector$<$ \mbox{\hyperlink{classAtom}{Atom}} $\ast$ $>$ \mbox{\hyperlink{classMolecule_aef77043ab98f1008a15a1e52d85b827e}{get\+Bonded\+Atoms}} (\mbox{\hyperlink{classAtom}{Atom}} $\ast$src) const
\begin{DoxyCompactList}\small\item\em Get all atoms bonded to a given atom. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_ab89456b4f7e16d7cbf6025f0389f5d10}{start\+Trials}} ()
\begin{DoxyCompactList}\small\item\em Start trial mode. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_af86a46bfed0f76534eb11a2016371f13}{rollback}} (const \mbox{\hyperlink{classSystem}{System}} \&s)
\begin{DoxyCompactList}\small\item\em Restore original molecule. All changes from the last call of \mbox{\hyperlink{classMolecule_ab89456b4f7e16d7cbf6025f0389f5d10}{start\+Trials()}} will be deleted. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_ac178106e85c4a667d2c7faa57765d0fb}{mini\+Rollback}} (const \mbox{\hyperlink{classForceField}{Force\+Field}} \&ff)
\item 
void \mbox{\hyperlink{classMolecule_a04b2de48ba4c22b9bef6ca8aec90c1f9}{commit}} ()
\begin{DoxyCompactList}\small\item\em Save all changes and end trial mode. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classAtom}{Atom}} $\ast$ \mbox{\hyperlink{classMolecule_a50d2a2068fcda1e9676eb5d8e3aac9f2}{get\+Random\+Bondable\+Atom}} () const
\begin{DoxyCompactList}\small\item\em Randomly select an atom with free valencies. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_a04b3beb3e333664d6421e9f0ee46dd73}{make\+Bond}} (\mbox{\hyperlink{classAtom}{Atom}} $\ast$a1, \mbox{\hyperlink{classAtom}{Atom}} $\ast$a2)
\begin{DoxyCompactList}\small\item\em Join two atoms to make a bond. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classMolecule_aebc4ac8f4a68e24dbb0720402798ca4e}{bond\+Atom}} (\mbox{\hyperlink{classAtom}{Atom}} $\ast$natm, \mbox{\hyperlink{classAtom}{Atom}} $\ast$src)
\begin{DoxyCompactList}\small\item\em Add an atom to the molecule by bonding it to a pre-\/existing atom of the molecule. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_aab5fec59c8dddb8cf598eb38f524a94a}\label{classMolecule_aab5fec59c8dddb8cf598eb38f524a94a}} 
std\+::vector$<$ \mbox{\hyperlink{classAtom}{Atom}} $\ast$ $>$ {\bfseries bond\+Fragment} (\mbox{\hyperlink{classMolecularFragment}{Molecular\+Fragment}} $\ast$nfrag, int ind, \mbox{\hyperlink{classAtom}{Atom}} $\ast$src)
\begin{DoxyCompactList}\small\item\em Bond a fragment to a given molecule by attaching one point to another atom. Returns a bool value to report success. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a973b1a0e85f2a3cf1e5c55dbe24c54e3}\label{classMolecule_a973b1a0e85f2a3cf1e5c55dbe24c54e3}} 
virtual std\+::pair$<$ double, double $>$ {\bfseries calculate\+Non\+Bonding\+Energy} (\mbox{\hyperlink{classAtom}{Atom}} $\ast$dummy, bool write=false)
\begin{DoxyCompactList}\small\item\em A wrapper to iterate through all the atoms in this molecule, and sum up the non-\/bonding interaction energy of this new (external) atom with this molecule. See Also\+: \mbox{\hyperlink{namespacechemtools_a4d736b938261879ac0c621cd97172a7a}{chemtools\+::get\+Nonbonding\+Potential()}} \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_a28fd8a15cac9bf3f9df358af8ee07ff0}{samplegrowimpartial}} (const \mbox{\hyperlink{classSystem}{System}} \&s, int n, int trials=15)
\item 
double \mbox{\hyperlink{classMolecule_a63283844d6c417b775c29fc9c86eef47}{get\+Hotspot\+Energy}} (const \mbox{\hyperlink{classSystem}{System}} \&s, double v=0)
\item 
\mbox{\Hypertarget{classMolecule_aaa3f24a1ea27312d39f72d8b4f277058}\label{classMolecule_aaa3f24a1ea27312d39f72d8b4f277058}} 
bool {\bfseries attempt} (const \mbox{\hyperlink{classSystem}{System}} \&s, \mbox{\hyperlink{classAtom}{Atom}} $\ast$gP, \mbox{\hyperlink{classAtom}{Atom}} $\ast$nat, \mbox{\hyperlink{classAtom}{Atom}} $\ast$\&nxt, int trials=10, bool restr=false, int nps=0, int devid=0)
\begin{DoxyCompactList}\small\item\em Attempts to add a new atom to a source atom. See flowchart of algorithm in PDF for more details. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classMolecule_ab0beb758c9101529938d5fdab3ed3f86}{reduce}} (const \mbox{\hyperlink{classSystem}{System}} \&s, int trials=15, bool forced=false, int devid=0)
\begin{DoxyCompactList}\small\item\em Complete all valencies by adding hydrogens. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_a6fb016cb3c6871904bd1e856e40f9fd1}{samplegrowunrigid}} (const \mbox{\hyperlink{classSystem}{System}} \&s, int n, int trials=15)
\item 
\mbox{\Hypertarget{classMolecule_a2c2caa1e42988fec83ed9101383c2f19}\label{classMolecule_a2c2caa1e42988fec83ed9101383c2f19}} 
bool {\bfseries complete\+Attempt} (ostream \&logfile, const \mbox{\hyperlink{classSystem}{System}} \&s, \mbox{\hyperlink{classAtom}{Atom}} $\ast$src, int trials=25, int nupper=90, int level=0, int levellim=LEVELLIMIT, bool restr=false, bool superseed=false, bool reseed=false, bool deseed=false, \mbox{\hyperlink{classMolecule}{Molecule}} $\ast$\&common\+\_\+newroot=NULLMOL, int common\+\_\+seedlength=0, int devid=0)
\begin{DoxyCompactList}\small\item\em Try to satisfy all atom-\/type requirements. See algorithm details in the PDF containing the flowchart. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_adc8c0ae7c7ce4f851344d9b4b6479602}{samplegrow}} (ostream \&logfile, const \mbox{\hyperlink{classSystem}{System}} \&s, int n, int trials=15, int nupper=90, int levellim=LEVELLIMIT, bool restr=false, bool superseed=false, bool reseed=false, bool deseed=false, \mbox{\hyperlink{classMolecule}{Molecule}} $\ast$\&common\+\_\+newroot=NULLMOL, int common\+\_\+seedlength=0, int devid=0)
\begin{DoxyCompactList}\small\item\em The internal growth function which guided the molecule growth. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_a6b91da44d6681118424a20a4a8ea2b24}{uniform\+Charge\+Adjustments}} (double tchg=0)
\begin{DoxyCompactList}\small\item\em Sets the net charge of the \mbox{\hyperlink{classMolecule}{Molecule}} by uniformly modifying the charges of all atoms (usually by a small quantity for large enough molecules) \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classMolecule_a69594b093fbb60eabc373d6860f19a87}{get\+Net\+Charge}} (const \mbox{\hyperlink{classForceField}{Force\+Field}} \&ff) const
\begin{DoxyCompactList}\small\item\em Get expected charge of a molecule. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_a728fa63d31ed43876593086571e82cf6}{describe\+Structure}} (std\+::ostream \&outs=std\+::cout) const
\begin{DoxyCompactList}\small\item\em Symbolically describe the structure of the molecule. \end{DoxyCompactList}\item 
std\+::vector$<$ int $>$ \mbox{\hyperlink{classMolecule_a3457de95adc23d040a6545a8b783dd32}{quick\+Locate}} (int latind, int startatin, std\+::vector$<$ int $>$ passed)
\begin{DoxyCompactList}\small\item\em Locate the closest path joining the atoms at the two indices without passing through the given list of atoms (Used to find path when cyclization occurs) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_a72616aa9d293190a9a0372a735f76966}{dump\+Mol}} (const std\+::string \&fn, const \mbox{\hyperlink{classForceField}{Force\+Field}} $\ast$ff=nullptr) const
\begin{DoxyCompactList}\small\item\em Write (dump) a molecule to a file (in PDB format) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_abf63c026f43bb010231bc3dbb7c7b7de}\label{classMolecule_abf63c026f43bb010231bc3dbb7c7b7de}} 
void {\bfseries dump\+Mol} (ofstream \&f, const \mbox{\hyperlink{classForceField}{Force\+Field}} $\ast$ff=nullptr) const
\begin{DoxyCompactList}\small\item\em Same as dump\+Mol(const std\+::string\&,const Force\+Field$\ast$). Uses an output stream instead of filename. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_abeb8483a7acbcab66438a3ec61b53971}{dump\+Mol\+As\+Txt}} (ostream \&f, bool cpt=false) const
\begin{DoxyCompactList}\small\item\em Dump the molecule as a TXT file (See algorithm documentation PDF for details about this format) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_a3afedbfc21fac19be1d4c5aaa9a9ac63}{dump\+Mol\+As\+Txt}} (const std\+::string \&f, bool cpt=false) const
\item 
void \mbox{\hyperlink{classMolecule_a8d59b178a86747eca8237e73170351e5}{dump\+Mol\+As\+GRO}} (std\+::ostream \&os, int stI=1, bool head=true, const std\+::string \&header=\char`\"{}DNV GRO molecule output\char`\"{}) const
\begin{DoxyCompactList}\small\item\em Write the molecule data in GRO format. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_af8c0559dba93cc2a1abef93b13216de1}{dump\+Mol\+As\+Mol2}} (std\+::ostream \&os, \mbox{\hyperlink{classForceField}{Force\+Field}} $\ast$ff=nullptr, bool no\+\_\+orders=false, bool calculate\+\_\+orders=false, const std\+::string \&name=\char`\"{}DNV\char`\"{})
\begin{DoxyCompactList}\small\item\em Dump molecule in mol2 format to a stream. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a7bbf0be79bb0c20c003bbb2160244306}\label{classMolecule_a7bbf0be79bb0c20c003bbb2160244306}} 
float {\bfseries get\+Solvation\+Energy\+Estimate} ()
\begin{DoxyCompactList}\small\item\em Get the net solvation energy estimate for this molecule (first-\/order linear approximation) \end{DoxyCompactList}\item 
Eigen\+::\+Vector3d \mbox{\hyperlink{classMolecule_a0839d679a7ed5664c8729ab572ef67d7}{get\+Centre\+Of\+Geometry}} (bool inch=false) const
\begin{DoxyCompactList}\small\item\em Get the center of geometry of the molecule. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_af4ee33c60073cc39d50f316576275a69}\label{classMolecule_af4ee33c60073cc39d50f316576275a69}} 
Eigen\+::\+Vector3d {\bfseries get\+Centre\+Of\+Mass} (bool inch=true) const
\begin{DoxyCompactList}\small\item\em Get the center-\/of-\/mass for this molecule. Important when handling the system for mechanics. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a9b2d6019d07a44478eca43157a0f55e6}\label{classMolecule_a9b2d6019d07a44478eca43157a0f55e6}} 
double {\bfseries get\+Moment\+Of\+Inertia} (bool inch=true) const
\begin{DoxyCompactList}\small\item\em Calculate the moment of inertia for this molecule (used for simulating rigid-\/body dynamics) \end{DoxyCompactList}\item 
std\+::pair$<$ Eigen\+::\+Vector3d, Eigen\+::\+Vector3d $>$ \mbox{\hyperlink{classMolecule_a3d482b455228629e6ca908ce461a64a7}{get\+Container}} () const
\begin{DoxyCompactList}\small\item\em Get a containing \char`\"{}box\char`\"{} co-\/ordinates which ensures that the molecule is enclosed by it. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classMolecule_a5eff5649ce64bbe64269a1b7e21016ed}{best\+Plane\+Of\+Fit}} (double err=1e-\/5) const
\begin{DoxyCompactList}\small\item\em Get the bast plane of fit to this molecule -\/ experimental. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_acbd9a3848f358d7b556201b822a0092d}\label{classMolecule_acbd9a3848f358d7b556201b822a0092d}} 
void {\bfseries translate\+Molecule} (const Eigen\+::\+Vector3d \&v)
\begin{DoxyCompactList}\small\item\em Translate a molecule along a given vector. Length of translation depends on vector length. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_adbbc84419964e42f958f78219a92b556}{rotate\+Molecule}} (const Eigen\+::\+Vector3d \&n, Eigen\+::\+Vector3d com=Eigen\+::\+Vector3d(0, 0, 0))
\begin{DoxyCompactList}\small\item\em Rotate the molecule about a given vector by a given angle (in radians). The angle is given by the norm of the vector. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classMolecule_afa6fbeecd0df2fb5a8026895ab57bc60}{rotate\+Dihedral\+To}} (\mbox{\hyperlink{classAtom}{Atom}} $\ast$a1, \mbox{\hyperlink{classAtom}{Atom}} $\ast$a2, \mbox{\hyperlink{classAtom}{Atom}} $\ast$a3, \mbox{\hyperlink{classAtom}{Atom}} $\ast$a4, double dih)
\begin{DoxyCompactList}\small\item\em Rotate the dihedral to set it to a particular value. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a7dbdfaca5e02c004c63d15b43817c418}\label{classMolecule_a7dbdfaca5e02c004c63d15b43817c418}} 
bool {\bfseries rotate\+Dihedral\+To} (int i1, int i2, int i3, int i4, double dih)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classMolecule_afa6fbeecd0df2fb5a8026895ab57bc60}{rotate\+Dihedral\+To()}} that uses atom indices instead of \mbox{\hyperlink{classAtom}{Atom}} pointers. More efficient if you know the indices already \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classMolecule_aef128442de06304833ac94e8a418ba61}{calculate\+Internal\+Energy}} (const \mbox{\hyperlink{classForceField}{Force\+Field}} \&ff) const
\begin{DoxyCompactList}\small\item\em Calculate the total internal energy of a molecule. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_ad622f2b8ddde095a834f73e2f589b014}\label{classMolecule_ad622f2b8ddde095a834f73e2f589b014}} 
std\+::pair$<$ std\+::vector$<$ Eigen\+::\+Vector3d $>$, std\+::vector$<$ Eigen\+::\+Vector3d $>$ $>$ {\bfseries calculate\+Acting\+Forces} (\mbox{\hyperlink{classMolecule}{Molecule}} $\ast$lig) const
\begin{DoxyCompactList}\small\item\em Calculate the forces acting on a target molecule from this molecule. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::pair$<$ int, int $>$ $>$ \mbox{\hyperlink{classMolecule_a586d332662ebab7d9c3cdf667d39a901}{get\+All\+Bridge\+Heads}} ()
\begin{DoxyCompactList}\small\item\em Find all bridge-\/head atom index pairs for all possible bridges in this molecule. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_a37f0c2acba7e35455f6128fff194e1a9}{drop\+Single\+Atom}} (int din)
\begin{DoxyCompactList}\small\item\em This function allows to drop one atom from the molecule. Read well before usage. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_a6351ba55249d7e5659dfbb397dd0e069}{make\+Prune\+Fragment}} (int n, int devid=0)
\begin{DoxyCompactList}\small\item\em This function generates the starting fragment for \char`\"{}pruning\char`\"{} (See algorthim PDF). \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a45071d6f28ea163b763f08ae23430a76}\label{classMolecule_a45071d6f28ea163b763f08ae23430a76}} 
\mbox{\hyperlink{classMolecule}{Molecule}} $\ast$ {\bfseries create\+Submolecule} (const std\+::vector$<$ \mbox{\hyperlink{classAtom}{Atom}} $\ast$ $>$ \&ats)
\begin{DoxyCompactList}\small\item\em Make a sub-\/\+Molecule from the given molecule using a set of atoms (maintaining any bonds possible) \end{DoxyCompactList}\item 
std\+::pair$<$ std\+::string, std\+::vector$<$ \mbox{\hyperlink{classAtom}{Atom}} $\ast$ $>$ $>$ \mbox{\hyperlink{classMolecule_ad2e19e6613d0ed3d7249a3aaea8f87dd}{get\+SMILES2}} (const \mbox{\hyperlink{classForceField}{Force\+Field}} $\ast$ff=nullptr, bool daylight=false) const
\begin{DoxyCompactList}\small\item\em Get SMILES format for this molecule -\/ Improved. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a5aef6bc268040eb562836135eae6802a}\label{classMolecule_a5aef6bc268040eb562836135eae6802a}} 
int {\bfseries get\+AID} (\mbox{\hyperlink{classAtom}{Atom}} $\ast$a) const
\begin{DoxyCompactList}\small\item\em Get \mbox{\hyperlink{classAtom}{Atom}} ID (used during \char`\"{}hashing\char`\"{}) -\/experimental. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_ab1796d77ef0d13270640fa26c6402e45}\label{classMolecule_ab1796d77ef0d13270640fa26c6402e45}} 
int {\bfseries get\+AID} (int atno) const
\begin{DoxyCompactList}\small\item\em Get \mbox{\hyperlink{classAtom}{Atom}} ID (used during \char`\"{}hashing\char`\"{}) -\/experimental. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a8bc7955fb40d44962a8a21ad964cbab6}\label{classMolecule_a8bc7955fb40d44962a8a21ad964cbab6}} 
std\+::vector$<$ int $>$ \& {\bfseries hashatomcomplete} (int ind) const
\begin{DoxyCompactList}\small\item\em Get a \char`\"{}hash vector\char`\"{} for this atom -\/experimental. \end{DoxyCompactList}\item 
long int \mbox{\hyperlink{classMolecule_a54571895bd7b4ffa483889aad3b1092b}{hashatom}} (\mbox{\hyperlink{classAtom}{Atom}} $\ast$a)
\begin{DoxyCompactList}\small\item\em Numeric first-\/order hash. \end{DoxyCompactList}\item 
long int \mbox{\hyperlink{classMolecule_a804447203e588ac312611688aa4fb500}{get\+First\+Order\+Hash}} ()
\begin{DoxyCompactList}\small\item\em Numeric first-\/order hash. \end{DoxyCompactList}\item 
std\+::vector$<$ int $>$ \mbox{\hyperlink{classMolecule_a9b7c224368ec15caea268e26051c9437}{get\+Complete\+Hash}} (bool heavy=false) const
\begin{DoxyCompactList}\small\item\em Get a complete hash vector for a molecule. -\/ experimental. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_a91f54fd4523fcafbb41bb88fc6846d85}\label{classMolecule_a91f54fd4523fcafbb41bb88fc6846d85}} 
double {\bfseries get\+Graph\+Distance} (const \mbox{\hyperlink{classMolecule}{Molecule}} $\ast$m2, double base=0.\+8) const
\begin{DoxyCompactList}\small\item\em Try to match the similarity of two molecules and score the similarity in (0,1) -\/ under development. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_af4065bbc264b5b4263a927a4f63116c3}\label{classMolecule_af4065bbc264b5b4263a927a4f63116c3}} 
Pose {\bfseries extract\+Pose} ()
\begin{DoxyCompactList}\small\item\em Get the \char`\"{}pose\char`\"{} (3D atom-\/position data) of the \mbox{\hyperlink{classMolecule}{Molecule}} object. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static double \mbox{\hyperlink{classMolecule_a6b70c9d0397e77a4d7305b9dce395887}{square\+Distance}} (std\+::vector$<$ double $>$ plane)
\begin{DoxyCompactList}\small\item\em Get the sum of squares distances of each atom (including hydrogen atoms) of this molecule to a given plane. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classMolecule_ac4b492f2099e1c59c6c4f19818f1394c}\label{classMolecule_ac4b492f2099e1c59c6c4f19818f1394c}} 
static double {\bfseries normalized\+Vector\+Difference} (const std\+::vector$<$ int $>$ \&hash1, const std\+::vector$<$ int $>$ \&hash2, int s1, int s2, double base=0.\+8)
\begin{DoxyCompactList}\small\item\em Match to vectors and calculate some kind of a \char`\"{}distance\char`\"{} to score the similarity in (0,1) -\/ under development. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{classMolecule_ab9512050a395e0ebb8fbba92f0a91222}{HC}} =0
\item 
int \mbox{\hyperlink{classMolecule_a3e459e9ae52f281073d4821b9af72b60}{type}} =0
\item 
int \mbox{\hyperlink{classMolecule_a87674f540b98a33b4921c4d57b3982fc}{ID}} =-\/1
\item 
bool \mbox{\hyperlink{classMolecule_acf710157d0a2da0d5d7bab8d658c39be}{trialmode}} =false
\item 
double \mbox{\hyperlink{classMolecule_adebb2c740099c5db4f14137bb1609877}{my\+BE}} =0
\item 
double \mbox{\hyperlink{classMolecule_a6647358091d946bb02dbcf3ce35b7d5e}{my\+HBE}} =0
\item 
double \mbox{\hyperlink{classMolecule_a6b1f799908a9d52d7194d07ac6bb28d3}{err\+BE}} =0
\item 
double \mbox{\hyperlink{classMolecule_a32075500340345439d0d4912e26fb44f}{err\+HBE}} =0
\item 
double \mbox{\hyperlink{classMolecule_abf3e45c79a7ae3fbb0fc174544debc1e}{pE}} =0
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classMolecule_a7e7d290ae641518ad4c4d5303b519d0f}\label{classMolecule_a7e7d290ae641518ad4c4d5303b519d0f}} 
{\bfseries Molecule} ()
\begin{DoxyCompactList}\small\item\em The blank \mbox{\hyperlink{classMolecule}{Molecule}} constructor. It just creates a ghost molecule object with no atom data. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_a38c89b2e6d4e911cfdf9ac6ea3306a1c}{add\+BE}} (double x)
\begin{DoxyCompactList}\small\item\em a wrapper to add some amount to the binding energy stored in this \mbox{\hyperlink{classMolecule}{Molecule}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMolecule_a2d42407d83a7ca200fe738b67a3c38cb}{add\+HBE}} (double x)
\begin{DoxyCompactList}\small\item\em a wrapper to add some amount to the binding energy (contributed by the \char`\"{}hotspot\char`\"{}) stored in this \mbox{\hyperlink{classMolecule}{Molecule}}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Friends}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMolecule}{Molecule}} $\ast$ \mbox{\hyperlink{classMolecule_a13f21a69f0d90e36bffdc2236e75fff3}{merge}} (const \mbox{\hyperlink{classMolecule}{Molecule}} $\ast$m1, const \mbox{\hyperlink{classMolecule}{Molecule}} $\ast$m2)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
The class is the backbone of the De\+Novo program. It contains all information about the molecule and all generation methods are included here. As a lot of methods in the class deal with energy, it is useful to mention that the unit of energy used in De\+Novo is (k\+J/mol)~\newline
 {\bfseries{Atoms}}~\newline
 This class holds an array (technically a \textquotesingle{}std\+::vector\textquotesingle{}) of Atom$\ast$ (pointers to an \mbox{\hyperlink{classAtom}{Atom}} object). This storage method automatically indexes every atom by an integer.~\newline
 When loaded from a file (PDB, GRO, or TXT), the sequence of indexing for the atoms matches the order in which they were found in the file. When manually constructed, the order is same as the order in which each atom was added. If two molecules are \char`\"{}merged\char`\"{} (see \mbox{\hyperlink{classMolecule_a13f21a69f0d90e36bffdc2236e75fff3}{merge(const Molecule$\ast$,const Molecule$\ast$)}}), the lists are concatenated in the same order as the parameters~\newline
 {\bfseries{Bonds and adjacency lists}}~\newline
 The molecule is stored in a tree format, using an adjacency list to store bonding data. Bonds are stored as vectors of integer vectors (to represent the matrix).~\newline
 Each element (number) of an integer vector refers to the index of an \mbox{\hyperlink{classAtom}{Atom}} in the \mbox{\hyperlink{classMolecule}{Molecule}}. Such vectors are compiled in another vector and indexed by the source atom (the atom which is bonded to all atoms referred to by this list)~\newline
 A sample adjacency list (for benzene)\+:~\newline
 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{classAtom}{Atom}}-\/name, Index,  corresponding adjacency vector}
\DoxyCodeLine{}
\DoxyCodeLine{CA,    0,  \{1,5,6\}}
\DoxyCodeLine{CA,    1,  \{0,2,7\}}
\DoxyCodeLine{CA,    2,  \{1,3,8\}}
\DoxyCodeLine{CA,    3,  \{2,4,9\}}
\DoxyCodeLine{CA,    4,  \{3,5,10\}}
\DoxyCodeLine{CA,    5,  \{4,0,11\}}
\DoxyCodeLine{HA,    6,  \{0\}}
\DoxyCodeLine{HA,    7,  \{1\}}
\DoxyCodeLine{HA,    8,  \{2\}}
\DoxyCodeLine{HA,    9,  \{3\}}
\DoxyCodeLine{HA,    10, \{4\}}
\DoxyCodeLine{HA,    11, \{5\}}

\end{DoxyCode}
 ~\newline
 Bond orders are not stored. They usually can be determined from atom-\/type valencies (and sometimes with the help of hybridization)~\newline


This class makes use of the Eigen libraries. See Eigen\+: \href{http://eigen.tuxfamily.org/}{\texttt{ http\+://eigen.\+tuxfamily.\+org/}} for more details. (git repo\+: \href{https://gitlab.com/libeigen/eigen.git}{\texttt{ https\+://gitlab.\+com/libeigen/eigen.\+git}})

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00477}{477}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classMolecule_aa08b915718a7851b753c0cd9acb026f8}\label{classMolecule_aa08b915718a7851b753c0cd9acb026f8}} 
\index{Molecule@{Molecule}!Molecule@{Molecule}}
\index{Molecule@{Molecule}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{Molecule()}{Molecule()}\hspace{0.1cm}{\footnotesize\ttfamily [1/5]}}
{\footnotesize\ttfamily Molecule\+::\+Molecule (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \mbox{\hyperlink{classAtom}{Atom}} $\ast$ $>$}]{ats }\end{DoxyParamCaption})}



Load a molecule by just collecting atoms. 

Useful to perform rigid-\/molecule operations that do not involve bonding. For problems that require bond-\/data, see \mbox{\hyperlink{classMolecule_ab5dd0fff02c29ca0e4209822857cf66f}{Molecule\+::\+Molecule(std\+::vector$<$\+Atom$\ast$$>$,std\+::vector$<$std\+::vector$<$int$>$$>$)}} 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l02703}{2703}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l02703}02703                                        : \mbox{\hyperlink{classMolecule_a7e7d290ae641518ad4c4d5303b519d0f}{Molecule}}() \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02704}02704     atoms=std::vector<Atom*>();}
\DoxyCodeLine{\Hypertarget{classMolecule_l02705}02705     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : ats) atoms.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{classAtom}{Atom}}(*a));}
\DoxyCodeLine{\Hypertarget{classMolecule_l02706}02706     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<ats.size();i++) bonds.push\_back(std::vector<int>());}
\DoxyCodeLine{\Hypertarget{classMolecule_l02707}02707     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : atoms)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02708}02708     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02709}02709         \textcolor{keywordflow}{if}(a-\/>isHydrogen()) \mbox{\hyperlink{classMolecule_ab9512050a395e0ebb8fbba92f0a91222}{HC}}++;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02710}02710         \textcolor{keywordflow}{if}(VARIEDCOUNT \&\& VCLIST-\/>\mbox{\hyperlink{classCategory_a3ffa41a593852318c167862171166f1b}{contains}}(a)) HAC++;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02711}02711     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02712}02712 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a21ee086bf224ec95f24aae555e94b5b9}\label{classMolecule_a21ee086bf224ec95f24aae555e94b5b9}} 
\index{Molecule@{Molecule}!Molecule@{Molecule}}
\index{Molecule@{Molecule}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{Molecule()}{Molecule()}\hspace{0.1cm}{\footnotesize\ttfamily [2/5]}}
{\footnotesize\ttfamily Molecule\+::\+Molecule (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classMolecule}{Molecule}} $\ast$}]{o }\end{DoxyParamCaption})}



The \mbox{\hyperlink{classMolecule}{Molecule}} class copy constructor. 

This constructor is the proper way to clone a \mbox{\hyperlink{classMolecule}{Molecule}} object. ~\newline
Unless explicitly mentioned in the documentation of a specific method {\bfseries{DO NOT}} dereference a Molecule$\ast$ before using it. It may lead to memory corruption and undefined behaviour.~\newline
 Sample usage\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{classMolecule}{Molecule}}* srcMolecule; \textcolor{comment}{//Molecule to be copied}}
\DoxyCodeLine{\mbox{\hyperlink{classMolecule}{Molecule}}* clonedMolecule = \textcolor{keyword}{new} \mbox{\hyperlink{classMolecule_a7e7d290ae641518ad4c4d5303b519d0f}{Molecule}}(srcMolecule)}

\end{DoxyCode}
 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l02735}{2735}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l02735}02735                                     : \mbox{\hyperlink{classMolecule_a7e7d290ae641518ad4c4d5303b519d0f}{Molecule}}()}
\DoxyCodeLine{\Hypertarget{classMolecule_l02736}02736 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02737}02737     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<o-\/>\mbox{\hyperlink{classMolecule_a6946cbe0d8daa9b2386d85ca7faf0cd1}{getSize}}();i++) atoms.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{classAtom}{Atom}}(*(o-\/>atoms[i])));}
\DoxyCodeLine{\Hypertarget{classMolecule_l02738}02738     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : atoms) \{\textcolor{keywordflow}{if}(a-\/>seek\_valency()) freeatoms.push\_back(a);\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02739}02739     bonds=o-\/>bonds;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02740}02740     \mbox{\hyperlink{classMolecule_a3e459e9ae52f281073d4821b9af72b60}{type}}=o-\/>\mbox{\hyperlink{classMolecule_a3e459e9ae52f281073d4821b9af72b60}{type}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02741}02741     \mbox{\hyperlink{classMolecule_adebb2c740099c5db4f14137bb1609877}{myBE}}=o-\/>\mbox{\hyperlink{classMolecule_adebb2c740099c5db4f14137bb1609877}{myBE}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02742}02742     \mbox{\hyperlink{classMolecule_a6647358091d946bb02dbcf3ce35b7d5e}{myHBE}}=o-\/>\mbox{\hyperlink{classMolecule_a6647358091d946bb02dbcf3ce35b7d5e}{myHBE}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02743}02743     \mbox{\hyperlink{classMolecule_ab9512050a395e0ebb8fbba92f0a91222}{HC}}=o-\/>\mbox{\hyperlink{classMolecule_ab9512050a395e0ebb8fbba92f0a91222}{HC}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02744}02744     \textcolor{keywordflow}{if}(VARIEDCOUNT) HAC=o-\/>HAC;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02745}02745 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a041d96213e53bd501f94b46cc36d74f6}\label{classMolecule_a041d96213e53bd501f94b46cc36d74f6}} 
\index{Molecule@{Molecule}!Molecule@{Molecule}}
\index{Molecule@{Molecule}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{Molecule()}{Molecule()}\hspace{0.1cm}{\footnotesize\ttfamily [3/5]}}
{\footnotesize\ttfamily Molecule\+::\+Molecule (\begin{DoxyParamCaption}\item[{std\+::istream \&}]{f,  }\item[{bool}]{eval = {\ttfamily false},  }\item[{bool}]{cpt = {\ttfamily false},  }\item[{const \mbox{\hyperlink{classForceField}{Force\+Field}} $\ast$}]{ff = {\ttfamily nullptr} }\end{DoxyParamCaption})}



Load a molecule from TXT format (see algorithm PDF for details on TXT format) 

This is the \mbox{\hyperlink{classMolecule}{Molecule}} class constructor that can load molecules from TXT format file. Recent De\+Novo versions support PDB and GRO formats, however, this method is kept for backward support ~\newline
 From De\+Novo \textbackslash{}omega onwards, it is used to load checkpoints. You can supply an open input file stream.~\newline
See Also\+: \mbox{\hyperlink{classMolecule_a7e7d290ae641518ad4c4d5303b519d0f}{Molecule\+::\+Molecule}}(const char $\ast$file,bool eval=false) 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em f} & Input stream from which to load \\
\hline
\mbox{\texttt{ in}}  & {\em eval} & Evaluate bonds? (Default\+: no) \\
\hline
\mbox{\texttt{ in}}  & {\em cpt} & Is a checkpoint file? (Default\+: no). If yes, it will expect n more lines with bonding data. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l02755}{2755}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l02755}02755 : \mbox{\hyperlink{classMolecule_a7e7d290ae641518ad4c4d5303b519d0f}{Molecule}}() \{\mbox{\hyperlink{classMolecule_a8cdf18b0095a344a34d5ffe80be73d98}{loadMoleculeFromTXT}}(f,eval,cpt,ff);\}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_abd5df1c615fa93e4c0ce80e6a9dcd900}\label{classMolecule_abd5df1c615fa93e4c0ce80e6a9dcd900}} 
\index{Molecule@{Molecule}!Molecule@{Molecule}}
\index{Molecule@{Molecule}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{Molecule()}{Molecule()}\hspace{0.1cm}{\footnotesize\ttfamily [4/5]}}
{\footnotesize\ttfamily Molecule\+::\+Molecule (\begin{DoxyParamCaption}\item[{const char $\ast$}]{file,  }\item[{bool}]{eval = {\ttfamily false} }\end{DoxyParamCaption})}



Load a molecule from TXT format (see algorithm PDF for details on TXT format) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em file} & Name of the file from which to load \\
\hline
\mbox{\texttt{ in}}  & {\em eval} & Evaluate bonds? (Default\+: no) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l02747}{2747}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l02748}02748 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02749}02749     ifstream f;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02750}02750     f.open(file,ios::in);\textcolor{comment}{//opening file containing the data set}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02751}02751     \textcolor{keywordflow}{if}(!f) \{cout << \textcolor{stringliteral}{"{}Requested file: "{}}<<file<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}}; \textcolor{keywordflow}{throw} \mbox{\hyperlink{classUnableToOpenFileException}{UnableToOpenFileException}}();\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02752}02752     \mbox{\hyperlink{classMolecule_a8cdf18b0095a344a34d5ffe80be73d98}{loadMoleculeFromTXT}}(f,eval,\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{classMolecule_l02753}02753     f.close();\textcolor{comment}{//file closed}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02754}02754 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a834ac3e93af40e0f03bf1bb83c1ccb3e}\label{classMolecule_a834ac3e93af40e0f03bf1bb83c1ccb3e}} 
\index{Molecule@{Molecule}!Molecule@{Molecule}}
\index{Molecule@{Molecule}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{Molecule()}{Molecule()}\hspace{0.1cm}{\footnotesize\ttfamily [5/5]}}
{\footnotesize\ttfamily Molecule\+::\+Molecule (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{infile,  }\item[{const \mbox{\hyperlink{classForceField}{Force\+Field}} \&}]{ff,  }\item[{const std\+::string \&}]{format = {\ttfamily \char`\"{}pdb\char`\"{}},  }\item[{bool}]{eval = {\ttfamily false},  }\item[{bool}]{warnf = {\ttfamily false},  }\item[{char}]{chain = {\ttfamily \textquotesingle{}A\textquotesingle{}} }\end{DoxyParamCaption})}



Load \mbox{\hyperlink{classMolecule}{Molecule}} from a standard format (PDB or GRO) 

This is the constructor used for constructing a \mbox{\hyperlink{classMolecule}{Molecule}} from a standard format file.~\newline
. It requires a force-\/field (See \mbox{\hyperlink{classForceField}{Force\+Field}}) with atom names defined (to match that from the input file) 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em infile} & The input file (PDB or GRO) format \\
\hline
\mbox{\texttt{ in}}  & {\em format} & Specify the input format. Currently \char`\"{}pdb\char`\"{} and \char`\"{}gro\char`\"{} are supported. If nothing is specified, it is taken to be \char`\"{}pdb\char`\"{} \\
\hline
\mbox{\texttt{ in}}  & {\em ff} & The \mbox{\hyperlink{classForceField}{Force\+Field}} object which has the atom-\/types referred to in this file \\
\hline
\mbox{\texttt{ in}}  & {\em eval} & Evaluate bonds? If set to \char`\"{}true\char`\"{}, it checks for bonds (using vanderwaal radii as criteria.~\newline
For macromolecules, when loading from a PDB, as only non-\/bonding interactions matter, it is not necessary to calculate bonds.~\newline
 Only when loading small molecule, this is usually needed \\
\hline
\mbox{\texttt{ in}}  & {\em warnf} & \+: If set to true, warning (if any) will be printed during the loading. If not, most (weak) warnings will be omitted (Default\+: off) \\
\hline
\mbox{\texttt{ in}}  & {\em chain} & You can specify the chain in this (if loading a multi-\/chain protein). By default it is taken to be \textquotesingle{}A\textquotesingle{}. Note\+: You must load multiple chains from different files with different Chain IDs \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l02833}{2833}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l02834}02834 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02835}02835     ifstream inf; inf.open(infile,ios::in);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02836}02836     \textcolor{keywordflow}{if}(!inf) \{cout << \textcolor{stringliteral}{"{}Requested file: "{}}<<infile<<\textcolor{stringliteral}{"{} was not found/could not be opened for reading\(\backslash\)n"{}}; \textcolor{keywordflow}{throw} \mbox{\hyperlink{classFileNotFoundException}{FileNotFoundException}}();\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02837}02837     loadFromInputStream(inf,ff,format,eval,warnf,chain);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02838}02838     inf.close();}
\DoxyCodeLine{\Hypertarget{classMolecule_l02839}02839 \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classMolecule_aadf1f51e311a11e69385ff51602b86bc}\label{classMolecule_aadf1f51e311a11e69385ff51602b86bc}} 
\index{Molecule@{Molecule}!addAtom@{addAtom}}
\index{addAtom@{addAtom}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{addAtom()}{addAtom()}}
{\footnotesize\ttfamily void Molecule\+::add\+Atom (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classAtom}{Atom}} $\ast$}]{a }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Add a new atom to the \mbox{\hyperlink{classMolecule}{Molecule}}. 

This method allows manually adding atoms to the \mbox{\hyperlink{classMolecule}{Molecule}} class.~\newline
 Unless specifically asked for, no calculations or validations are performed on this \mbox{\hyperlink{classAtom}{Atom}}. Also, until manual bonding definition (see add\+Bond()) is given, the \mbox{\hyperlink{classAtom}{Atom}} is not bonded to any other in the molecule irrespective of its proximity to other atoms 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00637}{637}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l00637}00637 \{atoms.push\_back(a); bonds.push\_back(std::vector<int>()); a-\/>setMolecule(\textcolor{keyword}{this});\}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a38c89b2e6d4e911cfdf9ac6ea3306a1c}\label{classMolecule_a38c89b2e6d4e911cfdf9ac6ea3306a1c}} 
\index{Molecule@{Molecule}!addBE@{addBE}}
\index{addBE@{addBE}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{addBE()}{addBE()}}
{\footnotesize\ttfamily void Molecule\+::add\+BE (\begin{DoxyParamCaption}\item[{double}]{x }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



a wrapper to add some amount to the binding energy stored in this \mbox{\hyperlink{classMolecule}{Molecule}}. 

This method is used internally by the program to increment binding energy for every atom added during the growth phase.~\newline
Do not use this function from an external source. 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00628}{628}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l00628}00628 \{\mbox{\hyperlink{classMolecule_adebb2c740099c5db4f14137bb1609877}{myBE}}+=x;\}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a2d42407d83a7ca200fe738b67a3c38cb}\label{classMolecule_a2d42407d83a7ca200fe738b67a3c38cb}} 
\index{Molecule@{Molecule}!addHBE@{addHBE}}
\index{addHBE@{addHBE}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{addHBE()}{addHBE()}}
{\footnotesize\ttfamily void Molecule\+::add\+HBE (\begin{DoxyParamCaption}\item[{double}]{x }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



a wrapper to add some amount to the binding energy (contributed by the \char`\"{}hotspot\char`\"{}) stored in this \mbox{\hyperlink{classMolecule}{Molecule}}. 

This method is used internally by the program to increment binding energy for every atom added during the growth phase.~\newline
Do not use this function from an external source. 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00632}{632}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l00632}00632 \{\mbox{\hyperlink{classMolecule_a6647358091d946bb02dbcf3ce35b7d5e}{myHBE}}+=x;\}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a5eff5649ce64bbe64269a1b7e21016ed}\label{classMolecule_a5eff5649ce64bbe64269a1b7e21016ed}} 
\index{Molecule@{Molecule}!bestPlaneOfFit@{bestPlaneOfFit}}
\index{bestPlaneOfFit@{bestPlaneOfFit}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{bestPlaneOfFit()}{bestPlaneOfFit()}}
{\footnotesize\ttfamily std\+::vector$<$ double $>$ Molecule\+::best\+Plane\+Of\+Fit (\begin{DoxyParamCaption}\item[{double}]{err = {\ttfamily 1e-\/5} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get the bast plane of fit to this molecule -\/ experimental. 

This function uses Gradient Descent Fitting to fit a plane equation to this molecule. It assigns the global \char`\"{}currmol\char`\"{} to \char`\"{}this\char`\"{} molecule.~\newline
See also\+: \mbox{\hyperlink{classMolecule_a6b70c9d0397e77a4d7305b9dce395887}{square\+Distance()}}. It calculates the square distance from the plane (which is the target function to be minimized by gradient descent) 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em err} & The tolerance limit for convergence of gradient descent \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The coeffients of a plane in vector form (a,b,c,d) which corresponds to the plane \char`\"{}$<$b$>$a$<$/b$>$x +$<$b$>$b$<$/b$>$y +$<$b$>$c$<$/b$>$z = $<$b$>$d$<$/b$>$\char`\"{}. (std\+::vector$<$double$>$) 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01818}{1818}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01818}01818 \{currMol=\textcolor{keyword}{this}; \textcolor{keywordflow}{return} quickmath::gradientDescentFit(\mbox{\hyperlink{classMolecule_a6b70c9d0397e77a4d7305b9dce395887}{squareDistance}},4,err);\}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_aebc4ac8f4a68e24dbb0720402798ca4e}\label{classMolecule_aebc4ac8f4a68e24dbb0720402798ca4e}} 
\index{Molecule@{Molecule}!bondAtom@{bondAtom}}
\index{bondAtom@{bondAtom}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{bondAtom()}{bondAtom()}}
{\footnotesize\ttfamily bool Molecule\+::bond\+Atom (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classAtom}{Atom}} $\ast$}]{natm,  }\item[{\mbox{\hyperlink{classAtom}{Atom}} $\ast$}]{src }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Add an atom to the molecule by bonding it to a pre-\/existing atom of the molecule. 

This method is a short way to add an atom to a \mbox{\hyperlink{classMolecule}{Molecule}} when manually building a molecule. It adds the \mbox{\hyperlink{classAtom}{Atom}} to this \mbox{\hyperlink{classMolecule}{Molecule}} and then bonds it to the chosen atom (which must be in this molecule).~\newline
 It achieves both the steps in one function.(see \mbox{\hyperlink{classMolecule_aadf1f51e311a11e69385ff51602b86bc}{add\+Atom(\+Atom$\ast$)}} and \mbox{\hyperlink{classMolecule_a04b3beb3e333664d6421e9f0ee46dd73}{make\+Bond(\+Atom$\ast$,\+Atom$\ast$)}})~\newline
No checks are performed to see if the newly added atom already belongs to the molecule. The use must manually check this, or this may lead to memory corruption and/or infinite loops (see \mbox{\hyperlink{classMolecule_aa13276cae00e350b9b28c07cb82ebcec}{Molecule\+::index\+Of(\+Atom$\ast$) const}}). 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em natm} & The newly added atom (this must not belong to the molecule object when this method is called) \\
\hline
\mbox{\texttt{ in}}  & {\em src} & The source atom (to which this new atom is attached. This atom must be in the \mbox{\hyperlink{classMolecule}{Molecule}}. No checks are performed here either) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true/false (bool)\+: If either atom (new or source) cannot bond due to lack of valences, no bond is formed and \textquotesingle{}false\textquotesingle{} is returned. Otherwise the function exists with a return value \textquotesingle{}true\textquotesingle{} 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01164}{1164}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01165}01165     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01166}01166     \textcolor{comment}{//Atom* nacpy=natm;}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01167}01167         \textcolor{keywordflow}{if}(!natm-\/>\mbox{\hyperlink{classAtom_acd1d81d4d5011bd1cf6b53e6ec5830dd}{canBond}}() || !src-\/>\mbox{\hyperlink{classAtom_acd1d81d4d5011bd1cf6b53e6ec5830dd}{canBond}}()) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01168}01168     \textcolor{keywordflow}{if}(natm-\/>\mbox{\hyperlink{classAtom_a99ed78f1b94d694b0f3fac609fd92934}{isHydrogen}}()) \mbox{\hyperlink{classMolecule_ab9512050a395e0ebb8fbba92f0a91222}{HC}}++;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01169}01169         \textcolor{keywordflow}{if}(VARIEDCOUNT \&\& VCLIST-\/>\mbox{\hyperlink{classCategory_a3ffa41a593852318c167862171166f1b}{contains}}(natm)) HAC++;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01170}01170         \textcolor{keywordtype}{int} sI=\mbox{\hyperlink{classMolecule_aa13276cae00e350b9b28c07cb82ebcec}{indexOf}}(src);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01171}01171         atoms.push\_back(natm);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01172}01172         bonds.push\_back(std::vector<int>(1,sI));}
\DoxyCodeLine{\Hypertarget{classMolecule_l01173}01173         bonds[sI].push\_back(atoms.size()-\/1);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01174}01174         src-\/>\mbox{\hyperlink{classAtom_a6d1ed6f7432ecc88bee6faa26294cd08}{addBond}}(); natm-\/>\mbox{\hyperlink{classAtom_a6d1ed6f7432ecc88bee6faa26294cd08}{addBond}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01175}01175         \textcolor{keywordflow}{if}(natm-\/>\mbox{\hyperlink{classAtom_acd1d81d4d5011bd1cf6b53e6ec5830dd}{canBond}}()) freeatoms.push\_back(natm);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01176}01176         \textcolor{keywordflow}{if}(!src-\/>\mbox{\hyperlink{classAtom_acd1d81d4d5011bd1cf6b53e6ec5830dd}{canBond}}()) freeatoms.erase(std::remove(freeatoms.begin(), freeatoms.end(), src), freeatoms.end());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01177}01177         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01178}01178     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_ab64af9956394c7077c0ebf2db64b9cdf}\label{classMolecule_ab64af9956394c7077c0ebf2db64b9cdf}} 
\index{Molecule@{Molecule}!calculateBondOrders@{calculateBondOrders}}
\index{calculateBondOrders@{calculateBondOrders}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{calculateBondOrders()}{calculateBondOrders()}}
{\footnotesize\ttfamily void Molecule\+::calculate\+Bond\+Orders (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classForceField}{Force\+Field}} \&}]{ff,  }\item[{bool}]{assume\+\_\+complete = {\ttfamily false},  }\item[{bool}]{assign\+\_\+valence = {\ttfamily false} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Calculate bond orders for the bonds of this molecules (experimental) 

This method parses the adjacency list and uses the atom type definition data (such as hybridization and maximium valency) to judge the orders of various bonds.~\newline
Calling this method is a prerequisite for get\+SMILES() 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ff} & The \mbox{\hyperlink{classForceField}{Force\+Field}} used to get hybridization data and valencies for estimating bond-\/orders. \\
\hline
\mbox{\texttt{ in}}  & {\em assume\+\_\+complete} & This parameter (if set to \char`\"{}true\char`\"{} assumes all valencies of the \mbox{\hyperlink{classMolecule}{Molecule}} to be satisfied. It is useful to use this option when working with external (non CHARMM-\/27) valency satisfied molecules using an \char`\"{}empty forcefield\char`\"{}.~\newline
 \\
\hline
\mbox{\texttt{ in}}  & {\em assign\+\_\+valence} & This parameter (by default\+: off), if switched on, recalculates the free valencies for the atoms of this \mbox{\hyperlink{classMolecule}{Molecule}}. It is useful when using the \char`\"{}empty\char`\"{} force-\/field on an external molecule See Also\+: Force-\/\+Field (not the class) in PDF \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00646}{646}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l00647}00647     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00648}00648         \textcolor{keywordflow}{if}(!ff.\mbox{\hyperlink{classForceField_ab5bfc00e94bac57310cc3a4778e11342}{hasCategory}}(\textcolor{stringliteral}{"{}aromatic"{}})) \textcolor{keywordflow}{throw} \mbox{\hyperlink{classNoAromaticCategoryException}{NoAromaticCategoryException}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l00649}00649         \textcolor{keyword}{const} \mbox{\hyperlink{classCategory}{Category}}\& aromcat=ff.\mbox{\hyperlink{classForceField_a5a30c5a7760b5c791c5b34f9bd133506}{getCategory}}(\textcolor{stringliteral}{"{}aromatic"{}});}
\DoxyCodeLine{\Hypertarget{classMolecule_l00650}00650         orders=std::vector<std::vector<unsigned short int>>();}
\DoxyCodeLine{\Hypertarget{classMolecule_l00651}00651         std::vector<int> exB;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00652}00652         \textcolor{keywordtype}{bool} rep=\textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00653}00653         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++) \{std::vector<unsigned short int> aord; \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<bonds[i].size();j++) aord.push\_back(0); orders.push\_back(aord); exB.push\_back(0);\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00654}00654         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l00655}00655         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00656}00656             std::vector<Atom*> a1bonds=this-\/>\mbox{\hyperlink{classMolecule_aef77043ab98f1008a15a1e52d85b827e}{getBondedAtoms}}(atoms[i]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l00657}00657             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<a1bonds.size();j++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l00658}00658             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00659}00659                 \textcolor{keywordflow}{if}(orders[i][j]!=0 \&\& !rep) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00660}00660                 \mbox{\hyperlink{classAtom}{Atom}}* ca=a1bonds[j];}
\DoxyCodeLine{\Hypertarget{classMolecule_l00661}00661                 \textcolor{keywordtype}{int} ind=\mbox{\hyperlink{classMolecule_aa13276cae00e350b9b28c07cb82ebcec}{indexOf}}(ca);}
\DoxyCodeLine{\Hypertarget{classMolecule_l00662}00662                 std::vector<Atom*> a2bonds=this-\/>\mbox{\hyperlink{classMolecule_aef77043ab98f1008a15a1e52d85b827e}{getBondedAtoms}}(ca);}
\DoxyCodeLine{\Hypertarget{classMolecule_l00663}00663                 \textcolor{keywordtype}{int} ord=1;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00664}00664                 \textcolor{keywordflow}{if}(assume\_complete)}
\DoxyCodeLine{\Hypertarget{classMolecule_l00665}00665                 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00666}00666                     ord=(min(1-\/exB[i]+(ff.\mbox{\hyperlink{classForceField_a71608edab6564b721aa4b77739a82fc4}{getDefaultConnectivity}}(atoms[i])-\/a1bonds.size()),1-\/exB[ind]+(ff.\mbox{\hyperlink{classForceField_a71608edab6564b721aa4b77739a82fc4}{getDefaultConnectivity}}(ca)-\/a2bonds.size())));}
\DoxyCodeLine{\Hypertarget{classMolecule_l00667}00667                     exB[i]+=(ord-\/1);}
\DoxyCodeLine{\Hypertarget{classMolecule_l00668}00668                     exB[ind]+=(ord-\/1);}
\DoxyCodeLine{\Hypertarget{classMolecule_l00669}00669                 \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00670}00670                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00671}00671                 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00672}00672                     \textcolor{keywordtype}{int} exv1,exv2;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00673}00673                     \textcolor{keywordflow}{switch}(atoms[i]-\/>toString()[0])}
\DoxyCodeLine{\Hypertarget{classMolecule_l00674}00674                     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00675}00675                         \textcolor{keywordflow}{case} \textcolor{charliteral}{'P'}:}
\DoxyCodeLine{\Hypertarget{classMolecule_l00676}00676                             exv1=1;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00677}00677                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00678}00678                         \textcolor{keywordflow}{case} \textcolor{charliteral}{'S'}:}
\DoxyCodeLine{\Hypertarget{classMolecule_l00679}00679                             exv1=2;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00680}00680                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00681}00681                         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{classMolecule_l00682}00682                             exv1=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00683}00683                     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00684}00684                     \textcolor{keywordflow}{switch}(ca-\/>\mbox{\hyperlink{classAtom_a189def3b8bade8507d49cfd7de881178}{toString}}()[0])}
\DoxyCodeLine{\Hypertarget{classMolecule_l00685}00685                     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00686}00686                         \textcolor{keywordflow}{case} \textcolor{charliteral}{'P'}:}
\DoxyCodeLine{\Hypertarget{classMolecule_l00687}00687                             exv2=1;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00688}00688                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00689}00689                         \textcolor{keywordflow}{case} \textcolor{charliteral}{'S'}:}
\DoxyCodeLine{\Hypertarget{classMolecule_l00690}00690                             exv2=2;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00691}00691                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00692}00692                         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{classMolecule_l00693}00693                             exv2=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00694}00694                     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00695}00695                     \textcolor{comment}{//int exv1=(atoms[i]-\/>toString()[0]=='S' || atoms[i]-\/>toString()[0]=='P')?1:0,exv2=(ca-\/>toString()[0]=='S' || ca-\/>toString()[0]=='P')?1:0;}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00696}00696                     cout << atoms[i]-\/>toString() << \textcolor{stringliteral}{"{},"{}}<<atoms[ind]-\/>toString() << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << (1+(3-\/atoms[i]-\/>getHybridization())+exv1)<<\textcolor{stringliteral}{"{}("{}}<<(-\/exB[i])<<\textcolor{stringliteral}{"{})"{}} << \textcolor{stringliteral}{"{},"{}} << (1+(3-\/ca-\/>\mbox{\hyperlink{classAtom_a3082999bd6c416335c36e02db4dd72a0}{getHybridization}}())+exv2)<<\textcolor{stringliteral}{"{}("{}}<<(-\/exB[ind])<<\textcolor{stringliteral}{"{})"{}} << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00697}00697                     ord=min(1+(3-\/atoms[i]-\/>getHybridization())+exv1-\/exB[i],1+(3-\/ca-\/>\mbox{\hyperlink{classAtom_a3082999bd6c416335c36e02db4dd72a0}{getHybridization}}())+exv2-\/exB[ind]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l00698}00698                     \textcolor{keywordflow}{if}(!atoms[i]-\/>getHybridization() || !atoms[ind]-\/>getHybridization() || (aromcat.\mbox{\hyperlink{classCategory_a3ffa41a593852318c167862171166f1b}{contains}}(atoms[i]) \&\& atoms[ind]-\/>getStandardValency()>1) || (aromcat.\mbox{\hyperlink{classCategory_a3ffa41a593852318c167862171166f1b}{contains}}(atoms[ind]) \&\& atoms[i]-\/>getStandardValency()>1)) ord=1;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00699}00699                     \textcolor{comment}{//if(atoms[i]-\/>getStandardValency()<ord || ca-\/>getStandardValency()<ord) ord=min(atoms[i]-\/>getStandardValency(),ca-\/>getStandardValency());}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00700}00700                     exB[i]+=(ord-\/1);}
\DoxyCodeLine{\Hypertarget{classMolecule_l00701}00701                     exB[ind]+=(ord-\/1);}
\DoxyCodeLine{\Hypertarget{classMolecule_l00702}00702                 \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00703}00703                 orders[i][j]=ord;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00704}00704                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0;k<a2bonds.size();k++) \{\textcolor{keywordflow}{if}(a2bonds[k]==atoms[i]) orders[ind][k]=ord;\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00705}00705             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00706}00706             \textcolor{keywordflow}{if}(rep) rep=\textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00707}00707             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00708}00708             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00709}00709                 \textcolor{keywordflow}{if}(atoms[i]-\/>getStandardValency()==1 || atoms[i]-\/>getHybridization()==3 || aromcat.\mbox{\hyperlink{classCategory_a3ffa41a593852318c167862171166f1b}{contains}}(atoms[i])) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00710}00710                 \textcolor{keywordtype}{int} s=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00711}00711                 \textcolor{comment}{/*if(atoms[i]-\/>toString()[0]=='N') s++;}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00712}00712 \textcolor{comment}{                else if(atoms[i]-\/>toString()[0]=='N') s+=2;*/}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00713}00713                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} t=0;t<orders[i].size();t++) s+=orders[i][t];}
\DoxyCodeLine{\Hypertarget{classMolecule_l00714}00714                 cout << atoms[i]-\/>toString() << \textcolor{stringliteral}{"{}:"{}}<< s <<\textcolor{stringliteral}{"{} "{}}<< ff.\mbox{\hyperlink{classForceField_a71608edab6564b721aa4b77739a82fc4}{getDefaultConnectivity}}(atoms[i]) << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00715}00715                 \textcolor{keywordflow}{if}(s<ff.\mbox{\hyperlink{classForceField_a71608edab6564b721aa4b77739a82fc4}{getDefaultConnectivity}}(atoms[i]))}
\DoxyCodeLine{\Hypertarget{classMolecule_l00716}00716                 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00717}00717                     rep=\textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00718}00718                     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<a1bonds.size();j++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l00719}00719                     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00720}00720                         \textcolor{keywordtype}{int} ind=\mbox{\hyperlink{classMolecule_aa13276cae00e350b9b28c07cb82ebcec}{indexOf}}(a1bonds[j]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l00721}00721                         exB[ind]=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00722}00722                         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} t=0;t<orders[ind].size();t++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l00723}00723                         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00724}00724                             orders[ind][t]=1;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00725}00725                             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} u=0;u<orders[bonds[ind][t]].size();u++) \textcolor{keywordflow}{if}(bonds[bonds[ind][t]][u]==ind) \{orders[bonds[ind][t]][u]=1; \textcolor{keywordflow}{break};\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00726}00726                         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00727}00727                     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00728}00728                     i-\/-\/;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00729}00729                 \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00730}00730             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00731}00731         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00732}00732         \textcolor{keywordflow}{if}(assign\_valence)}
\DoxyCodeLine{\Hypertarget{classMolecule_l00733}00733         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00734}00734             \textcolor{keywordtype}{int} s=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00735}00735             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<orders.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l00736}00736             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00737}00737                 s=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00738}00738                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<orders[i].size();j++) s+=orders[i][j];}
\DoxyCodeLine{\Hypertarget{classMolecule_l00739}00739                 \textcolor{comment}{//cout << atoms[i]-\/>toString() << "{}\(\backslash\)t"{}<<(s-\/(int)orders[i].size())<<"{} "{}<<atoms[i]-\/>seek\_valency()<<"{}\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00740}00740                 atoms[i]-\/>setValency(ff.\mbox{\hyperlink{classForceField_a71608edab6564b721aa4b77739a82fc4}{getDefaultConnectivity}}(atoms[i])-\/s);}
\DoxyCodeLine{\Hypertarget{classMolecule_l00741}00741             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00742}00742             \mbox{\hyperlink{classMolecule_a588965bd448a1cb43f25aed3179ecf96}{calculateFreeAtoms}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l00743}00743         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00744}00744     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_aef128442de06304833ac94e8a418ba61}\label{classMolecule_aef128442de06304833ac94e8a418ba61}} 
\index{Molecule@{Molecule}!calculateInternalEnergy@{calculateInternalEnergy}}
\index{calculateInternalEnergy@{calculateInternalEnergy}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{calculateInternalEnergy()}{calculateInternalEnergy()}}
{\footnotesize\ttfamily double Molecule\+::calculate\+Internal\+Energy (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classForceField}{Force\+Field}} \&}]{ff }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Calculate the total internal energy of a molecule. 

Calculates the sum all all forms of internal potential for a molecule. It includes angle, dihedral, and non-\/bonding interaction energies.~\newline
This function still requires proper testing. 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01874}{1874}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01875}01875     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01876}01876         \textcolor{keywordtype}{double} inte=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01877}01877         \textcolor{keywordtype}{double} ange=0,dihe=0,ofe=0,lje=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01878}01878         std::vector<Atom*> visited;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01879}01879         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01880}01880         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01881}01881             \textcolor{keywordflow}{if}(atoms[i]-\/>isHydrogen()) \textcolor{keywordflow}{continue}; \textcolor{comment}{//Comment to calculate H-\/H interactios as well.}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01882}01882             visited.push\_back(atoms[i]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01883}01883             std::vector<Atom*> bndats=this-\/>\mbox{\hyperlink{classMolecule_aef77043ab98f1008a15a1e52d85b827e}{getBondedAtoms}}(atoms[i]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01884}01884             std::vector<Atom*> nearat=bndats;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01885}01885             \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* ca : bndats)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01886}01886             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01887}01887                 \textcolor{keywordflow}{if}(ca-\/>isHydrogen()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01888}01888                 std::vector<Atom*> sbndats=this-\/>\mbox{\hyperlink{classMolecule_aef77043ab98f1008a15a1e52d85b827e}{getBondedAtoms}}(ca);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01889}01889                 \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* sca : sbndats)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01890}01890                 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01891}01891                     \textcolor{keywordflow}{if}(sca-\/>isHydrogen() || sca==atoms[i]) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01892}01892                     nearat.push\_back(sca);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01893}01893                     std::vector<Atom*> tbndats=this-\/>\mbox{\hyperlink{classMolecule_aef77043ab98f1008a15a1e52d85b827e}{getBondedAtoms}}(ca);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01894}01894                     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* tca : tbndats)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01895}01895                     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01896}01896                         \textcolor{keywordflow}{if}(tca==atoms[i]) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01897}01897                         \textcolor{keywordflow}{if}(tca-\/>isHydrogen()) \textcolor{keywordflow}{continue}; \textcolor{comment}{//Comment to calculate 1-\/4s for Hydrogen as well}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01898}01898                         ofe+=\mbox{\hyperlink{namespacechemtools_a4d736b938261879ac0c621cd97172a7a}{chemtools::getNonbondingPotential}}(tca,atoms[i])/2;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01899}01899                         nearat.push\_back(tca);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01900}01900                     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01901}01901                 \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01902}01902             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01903}01903             \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* fa : atoms)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01904}01904             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01905}01905                 \textcolor{keywordflow}{if}(fa-\/>isHydrogen()) \textcolor{keywordflow}{continue}; \textcolor{comment}{//Comment to calculate LJs for hydrogen as well}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01906}01906                 \textcolor{keywordflow}{if}(fa==atoms[i] || contains(nearat,fa)) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01907}01907                 \textcolor{keywordtype}{double} ae=\mbox{\hyperlink{namespacechemtools_a4d736b938261879ac0c621cd97172a7a}{chemtools::getNonbondingPotential}}(fa,atoms[i]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01908}01908                 cout << atoms[i]-\/>toString()<<\textcolor{stringliteral}{"{} "{}}<<atoms[i]-\/>getPosition().transpose() << \textcolor{stringliteral}{"{} "{}}<<fa-\/>toString()<<\textcolor{stringliteral}{"{} "{}}<<fa-\/>getPosition().transpose() << \textcolor{stringliteral}{"{}\(\backslash\)t"{}}<<ae<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01909}01909                 lje+=ae;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01910}01910             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01911}01911         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01912}01912         ange/=2; dihe/=2; lje/=2; ofe/=2;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01913}01913         cout << \textcolor{stringliteral}{"{}Angle energy: "{}}<<ange<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01914}01914         cout << \textcolor{stringliteral}{"{}Dihedral energy: "{}}<<dihe<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01915}01915         cout << \textcolor{stringliteral}{"{}LJ Energy: "{}}<< lje<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01916}01916         cout << \textcolor{stringliteral}{"{}1-\/4 Energy: "{}}<<ofe<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01917}01917         \textcolor{keywordflow}{return} ange+dihe+lje+ofe;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01918}01918     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a8234989a3038abdd2228bf243cb7f668}\label{classMolecule_a8234989a3038abdd2228bf243cb7f668}} 
\index{Molecule@{Molecule}!calculateNRot@{calculateNRot}}
\index{calculateNRot@{calculateNRot}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{calculateNRot()}{calculateNRot()}}
{\footnotesize\ttfamily int Molecule\+::calculate\+NRot (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classForceField}{Force\+Field}} $\ast$}]{ff = {\ttfamily nullptr},  }\item[{bool}]{mod = {\ttfamily false} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Calculate the number of rotatable bonds. 

Calculates N\+\_\+\{ROT\}, or the number of rotational degrees of freedom. This is used to empirically correct for some of the entropy caused due to ligand size~\newline
 {\bfseries{Note\+: }} This assumes that the cycles have been already marked in this molecule (See\+: \mbox{\hyperlink{classMolecule_abfd8b7d4b46f69a9675e2fcac4397d19}{Molecule\+::mark\+Cyclized\+Atoms()}}) 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00859}{859}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l00860}00860     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00861}00861         \textcolor{keyword}{const} \mbox{\hyperlink{classCategory}{Category}}* cat=(ff \&\& ff-\/>\mbox{\hyperlink{classForceField_ab5bfc00e94bac57310cc3a4778e11342}{hasCategory}}(\textcolor{stringliteral}{"{}amidic"{}}))?\&(ff-\/>\mbox{\hyperlink{classForceField_a5a30c5a7760b5c791c5b34f9bd133506}{getCategory}}(\textcolor{stringliteral}{"{}amidic"{}})):\textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00862}00862         \textcolor{comment}{//if(cat) cout << "{}Found category: 'amidic'\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00863}00863         \textcolor{keywordtype}{int} nrot=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00864}00864         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l00865}00865         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00866}00866             \textcolor{keywordflow}{if}(atoms[i]-\/>getStandardValency()<2 || atoms[i]-\/>getHybridization()<2) \textcolor{keywordflow}{continue}; \textcolor{comment}{//Consider changing valency limit to 3 (Does C-\/O bond in R-\/C(R')-\/OH actually have a degree of freedom)}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00867}00867             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<bonds[i].size();j++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l00868}00868             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00869}00869                 \textcolor{keywordflow}{if}(atoms[bonds[i][j]]-\/>getStandardValency()<2 || atoms[i]-\/>getHybridization()<2 || (mod \&\& atoms[i]-\/>getHybridization()<3 \&\& atoms[bonds[i][j]]-\/>getHybridization()<3) || (cat \&\& ((cat-\/>\mbox{\hyperlink{classCategory_a3ffa41a593852318c167862171166f1b}{contains}}(atoms[i]) \&\& atoms[bonds[i][j]]-\/>toString()[0]==\textcolor{charliteral}{'N'}) || (cat-\/>\mbox{\hyperlink{classCategory_a3ffa41a593852318c167862171166f1b}{contains}}(atoms[bonds[i][j]]) \&\& atoms[i]-\/>toString()[0]==\textcolor{charliteral}{'N'})) ) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00870}00870                 \textcolor{keywordtype}{bool} all1=\textcolor{keyword}{true},all2=\textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00871}00871                 \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\& v : cycles)}
\DoxyCodeLine{\Hypertarget{classMolecule_l00872}00872                 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00873}00873                     all1=\textcolor{keyword}{true}; all2=\textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00874}00874                     \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \mbox{\hyperlink{classAtom}{Atom}}* ta : v)}
\DoxyCodeLine{\Hypertarget{classMolecule_l00875}00875                     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00876}00876                         \textcolor{keywordflow}{if}(ta==atoms[i]) all1=\textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00877}00877                         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(ta==atoms[bonds[i][j]]) all2=\textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00878}00878                     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00879}00879                     \textcolor{keywordflow}{if}(!all1 \&\& !all2) \{\textcolor{comment}{/*cout << "{}\(\backslash\)t"{} << atoms[i]-\/>toString() << "{} -\/ "{} << atoms[bonds[i][j]]-\/>toString()<<"{}\(\backslash\)n"{};*/} \textcolor{keywordflow}{break};\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00880}00880                 \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00881}00881                 \textcolor{keywordflow}{if}(!all1 \&\& !all2) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00882}00882                 \textcolor{comment}{//cout << atoms[i]-\/>toString() << "{} -\/ "{} << atoms[bonds[i][j]]-\/>toString()<<"{}\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00883}00883                 nrot++;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00884}00884             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00885}00885         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00886}00886 }
\DoxyCodeLine{\Hypertarget{classMolecule_l00887}00887         \textcolor{keywordflow}{return} nrot/2;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00888}00888     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a04b2de48ba4c22b9bef6ca8aec90c1f9}\label{classMolecule_a04b2de48ba4c22b9bef6ca8aec90c1f9}} 
\index{Molecule@{Molecule}!commit@{commit}}
\index{commit@{commit}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{commit()}{commit()}}
{\footnotesize\ttfamily void Molecule\+::commit (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Save all changes and end trial mode. 

This method marks the end of \char`\"{}trial mode\char`\"{}. All changes made are kept, the back-\/up copy is deleted, and trial mode is switched off. 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01127}{1127}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01127}01127 \{\mbox{\hyperlink{classMolecule_acf710157d0a2da0d5d7bab8d658c39be}{trialmode}}=\textcolor{keyword}{false};\}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a728fa63d31ed43876593086571e82cf6}\label{classMolecule_a728fa63d31ed43876593086571e82cf6}} 
\index{Molecule@{Molecule}!describeStructure@{describeStructure}}
\index{describeStructure@{describeStructure}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{describeStructure()}{describeStructure()}}
{\footnotesize\ttfamily void Molecule\+::describe\+Structure (\begin{DoxyParamCaption}\item[{std\+::ostream \&}]{outs = {\ttfamily std\+:\+:cout} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Symbolically describe the structure of the molecule. 

Describe the molecule atom-\/wise along with the free valecies in brackets.~\newline
Atoms that must cyclize have a \textquotesingle{}$\ast$\textquotesingle{} on the side and atoms that have cyclized have a \textquotesingle{}\$\textquotesingle{} 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01563}{1563}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01564}01564   \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01565}01565     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : atoms) outs << a-\/>toString()<<((a-\/>mustCycl)?\textcolor{stringliteral}{"{}*"{}}:\textcolor{stringliteral}{"{}"{}})<<((a-\/>isCyclized())?\textcolor{stringliteral}{"{}\$"{}}:\textcolor{stringliteral}{"{}"{}})<< \textcolor{stringliteral}{"{}("{}}<<a-\/>seek\_valency()<<\textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01566}01566     outs << \textcolor{stringliteral}{"{}\(\backslash\)t"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01567}01567     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : freeatoms) outs << a-\/>toString() << \textcolor{stringliteral}{"{}("{}}<<a-\/>seek\_valency()<<\textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01568}01568     outs <<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01569}01569   \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a37f0c2acba7e35455f6128fff194e1a9}\label{classMolecule_a37f0c2acba7e35455f6128fff194e1a9}} 
\index{Molecule@{Molecule}!dropSingleAtom@{dropSingleAtom}}
\index{dropSingleAtom@{dropSingleAtom}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{dropSingleAtom()}{dropSingleAtom()}}
{\footnotesize\ttfamily void Molecule\+::drop\+Single\+Atom (\begin{DoxyParamCaption}\item[{int}]{din }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



This function allows to drop one atom from the molecule. Read well before usage. 

Using this function, you can drop any atom which is a terminal atom. This is most commonly a hydrogen atom, and sometimes a halogen, but more uncommonly it might also be carbonyl oxygen.~\newline
You can also remove other atoms as long as you are sure they have exactly one connection to them at the time of removal. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em din} & Index of atom to be removed \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l02070}{2070}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l02071}02071     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02072}02072         std::vector<int> conA=bonds[din];}
\DoxyCodeLine{\Hypertarget{classMolecule_l02073}02073         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\& c : conA)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02074}02074         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02075}02075             \textcolor{keywordtype}{int} i=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02076}02076             \textcolor{keywordflow}{for}(;i<bonds[c].size();i++) \{\textcolor{keywordflow}{if}(bonds[c][i]==din) \textcolor{keywordflow}{break};\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02077}02077             bonds[c].erase(bonds[c].begin()+i);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02078}02078             atoms[c]-\/>setValency(atoms[c]-\/>seek\_valency()+1);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02079}02079             \textcolor{keywordflow}{if}(!contains(freeatoms,atoms[c])) freeatoms.push\_back(atoms[c]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02080}02080         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02081}02081         bonds.erase(bonds.begin()+din);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02082}02082         \mbox{\hyperlink{classMolecule_adebb2c740099c5db4f14137bb1609877}{myBE}}-\/=atoms[din]-\/>getEnergyContribution();}
\DoxyCodeLine{\Hypertarget{classMolecule_l02083}02083         \mbox{\hyperlink{classMolecule_a6647358091d946bb02dbcf3ce35b7d5e}{myHBE}}-\/=atoms[din]-\/>getHotspotEnergyContribution();}
\DoxyCodeLine{\Hypertarget{classMolecule_l02084}02084         \textcolor{keywordflow}{if}(atoms[din]-\/>isHydrogen()) \mbox{\hyperlink{classMolecule_ab9512050a395e0ebb8fbba92f0a91222}{HC}}-\/-\/;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02085}02085         \textcolor{keywordflow}{if}(VARIEDCOUNT \&\& VCLIST-\/>\mbox{\hyperlink{classCategory_a3ffa41a593852318c167862171166f1b}{contains}}(atoms[din])) HAC-\/-\/;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02086}02086         atoms.erase(atoms.begin()+din);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02087}02087         \textcolor{keywordflow}{for}(std::vector<int>\& bv : bonds)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02088}02088         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02089}02089             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\& i : bv) \{\textcolor{keywordflow}{if}(i>=din) i-\/-\/;\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02090}02090         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02091}02091     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a72616aa9d293190a9a0372a735f76966}\label{classMolecule_a72616aa9d293190a9a0372a735f76966}} 
\index{Molecule@{Molecule}!dumpMol@{dumpMol}}
\index{dumpMol@{dumpMol}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{dumpMol()}{dumpMol()}}
{\footnotesize\ttfamily void Molecule\+::dump\+Mol (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{fn,  }\item[{const \mbox{\hyperlink{classForceField}{Force\+Field}} $\ast$}]{ff = {\ttfamily nullptr} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Write (dump) a molecule to a file (in PDB format) 

This functions writes the molecule (with atom-\/type names and coordinates) to a PDB file. A \mbox{\hyperlink{classForceField}{Force\+Field}} is also takaen as input (optionally) to detect elements separately from atom-\/type names (eg. CLAR is chlorine and not carbon) 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01594}{1594}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01595}01595   \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01596}01596     cout << \textcolor{stringliteral}{"{}Dumping to: "{}}<<fn<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01597}01597     ofstream of; of.open(fn,ios::out);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01598}01598     \mbox{\hyperlink{classMolecule_a72616aa9d293190a9a0372a735f76966}{dumpMol}}(of,ff);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01599}01599     of.close();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01600}01600   \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a8d59b178a86747eca8237e73170351e5}\label{classMolecule_a8d59b178a86747eca8237e73170351e5}} 
\index{Molecule@{Molecule}!dumpMolAsGRO@{dumpMolAsGRO}}
\index{dumpMolAsGRO@{dumpMolAsGRO}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{dumpMolAsGRO()}{dumpMolAsGRO()}}
{\footnotesize\ttfamily void Molecule\+::dump\+Mol\+As\+GRO (\begin{DoxyParamCaption}\item[{std\+::ostream \&}]{os,  }\item[{int}]{stI = {\ttfamily 1},  }\item[{bool}]{head = {\ttfamily true},  }\item[{const std\+::string \&}]{header = {\ttfamily \char`\"{}DNV~GRO~molecule~output\char`\"{}} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Write the molecule data in GRO format. 

GRO format is the standard GROMACS format. 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01626}{1626}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01627}01627     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01628}01628         \textcolor{keywordflow}{if}(head)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01629}01629         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01630}01630             os << header << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01631}01631             os <<\textcolor{stringliteral}{"{} "{}}<< this-\/>\mbox{\hyperlink{classMolecule_a6946cbe0d8daa9b2386d85ca7faf0cd1}{getSize}}() << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01632}01632         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01633}01633         \textcolor{keywordtype}{char} rnum[10],x[10],y[10],z[10],atn[10],ind[10];}
\DoxyCodeLine{\Hypertarget{classMolecule_l01634}01634         \textcolor{keywordtype}{char} rnam[10]; sprintf(rnam,\textcolor{stringliteral}{"{}\%4s"{}},atoms[0]-\/>getResidue().c\_str());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01635}01635         \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : atoms)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01636}01636         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01637}01637             sprintf(rnum,\textcolor{stringliteral}{"{}\%d"{}},a-\/>getResidueNumber());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01638}01638             sprintf(atn,\textcolor{stringliteral}{"{}\%+4s"{}},a-\/>toString().c\_str());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01639}01639             sprintf(ind,\textcolor{stringliteral}{"{}\%d"{}},stI++);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01640}01640             sprintf(x,\textcolor{stringliteral}{"{}\%.3f"{}},a-\/>seek\_x());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01641}01641             sprintf(y,\textcolor{stringliteral}{"{}\%.3f"{}},a-\/>seek\_y());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01642}01642             sprintf(z,\textcolor{stringliteral}{"{}\%.3f"{}},a-\/>seek\_z());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01643}01643             \textcolor{keywordtype}{char} line[100];}
\DoxyCodeLine{\Hypertarget{classMolecule_l01644}01644             sprintf(line,\textcolor{stringliteral}{"{}\%+5s\%+5s\%+5s\%+5s \%+7s \%+7s \%+7s\(\backslash\)n"{}},rnum,rnam,atn,ind,x,y,z);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01645}01645             os << line;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01646}01646         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01647}01647     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_af8c0559dba93cc2a1abef93b13216de1}\label{classMolecule_af8c0559dba93cc2a1abef93b13216de1}} 
\index{Molecule@{Molecule}!dumpMolAsMol2@{dumpMolAsMol2}}
\index{dumpMolAsMol2@{dumpMolAsMol2}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{dumpMolAsMol2()}{dumpMolAsMol2()}}
{\footnotesize\ttfamily void Molecule\+::dump\+Mol\+As\+Mol2 (\begin{DoxyParamCaption}\item[{std\+::ostream \&}]{os,  }\item[{\mbox{\hyperlink{classForceField}{Force\+Field}} $\ast$}]{ff = {\ttfamily nullptr},  }\item[{bool}]{no\+\_\+orders = {\ttfamily false},  }\item[{bool}]{calculate\+\_\+orders = {\ttfamily false},  }\item[{const std\+::string \&}]{name = {\ttfamily \char`\"{}DNV\char`\"{}} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Dump molecule in mol2 format to a stream. 

Provides a function write the molecule in mol2 format. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em os} & The output stream to write to. \\
\hline
\mbox{\texttt{ in}}  & {\em ff} & The \mbox{\hyperlink{classForceField}{Force\+Field}} to use for guessing bond-\/types (and orders) \\
\hline
\mbox{\texttt{ in}}  & {\em no\+\_\+orders} & Ignores orders and bond-\/type data in mol2 bond records. \\
\hline
\mbox{\texttt{ in}}  & {\em calculate\+\_\+orders} & Calculate order before writing if not already calculated. Must provide ff \\
\hline
\mbox{\texttt{ in}}  & {\em name} & Name to give the molecule (Default\+: DNV) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01656}{1656}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01657}01657     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01658}01658         \textcolor{keywordflow}{if}(no\_orders || !ff) calculate\_orders=\textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01659}01659         std::string globalrecs=\textcolor{stringliteral}{"{}@<TRIPOS>MOLECULE\(\backslash\)n"{}}+name+\textcolor{stringliteral}{"{}\(\backslash\)n"{}},atomrecs=\textcolor{stringliteral}{"{}@<TRIPOS>ATOM\(\backslash\)n"{}},bondrecs=\textcolor{stringliteral}{"{}@<TRIPOS>BOND\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01660}01660         \textcolor{keywordtype}{int} bondcount=0,conK=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01661}01661         \textcolor{keyword}{const} \mbox{\hyperlink{classCategory}{Category}}* aromcat=\textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01662}01662         \textcolor{keyword}{const} \mbox{\hyperlink{classCategory}{Category}}* halocat=\textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01663}01663         \textcolor{keywordflow}{if}(ff)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01664}01664         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01665}01665             aromcat=ff-\/>\mbox{\hyperlink{classForceField_ab5bfc00e94bac57310cc3a4778e11342}{hasCategory}}(\textcolor{stringliteral}{"{}aromatic"{}})?\&ff-\/>\mbox{\hyperlink{classForceField_a5a30c5a7760b5c791c5b34f9bd133506}{getCategory}}(\textcolor{stringliteral}{"{}aromatic"{}}):\textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01666}01666             halocat=ff-\/>\mbox{\hyperlink{classForceField_ab5bfc00e94bac57310cc3a4778e11342}{hasCategory}}(\textcolor{stringliteral}{"{}halogen"{}})?\&ff-\/>\mbox{\hyperlink{classForceField_a5a30c5a7760b5c791c5b34f9bd133506}{getCategory}}(\textcolor{stringliteral}{"{}halogen"{}}):\textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01667}01667         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01668}01668         \textcolor{keywordflow}{if}(!orders.size() \&\& calculate\_orders) this-\/>\mbox{\hyperlink{classMolecule_aa0590f11faa97d063d7542f91587898c}{calculateBondOrders2}}(*ff);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01669}01669         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01670}01670         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01671}01671             \textcolor{keywordtype}{char} atstr[100];}
\DoxyCodeLine{\Hypertarget{classMolecule_l01672}01672             \textcolor{keywordtype}{char} fch=atoms[i]-\/>toString()[0];}
\DoxyCodeLine{\Hypertarget{classMolecule_l01673}01673             std::string symb=(halocat \&\& halocat-\/>\mbox{\hyperlink{classCategory_a3ffa41a593852318c167862171166f1b}{contains}}(atoms[i]))?((fch==\textcolor{charliteral}{'C'}?\textcolor{stringliteral}{"{}Cl"{}}:(fch==\textcolor{charliteral}{'B'}?\textcolor{stringliteral}{"{}Br"{}}:std::string(1,fch)))):std::string(1,fch);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01674}01674             \textcolor{keywordflow}{if}(aromcat \&\& aromcat-\/>\mbox{\hyperlink{classCategory_a3ffa41a593852318c167862171166f1b}{contains}}(atoms[i]))}
\DoxyCodeLine{\Hypertarget{classMolecule_l01675}01675             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01676}01676                 \textcolor{keywordflow}{if}(fch==\textcolor{charliteral}{'O'}) symb+=\textcolor{stringliteral}{"{}.2"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01677}01677                 \textcolor{keywordflow}{else} symb+=\textcolor{stringliteral}{"{}.ar"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01678}01678             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01679}01679             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01680}01680             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01681}01681                 \textcolor{keywordflow}{if}(atoms[i]-\/>getHybridization()) symb+=\textcolor{stringliteral}{"{}."{}}+to\_string(atoms[i]-\/>getHybridization());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01682}01682             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01683}01683             \textcolor{keywordtype}{char} x[10],y[10],z[10];}
\DoxyCodeLine{\Hypertarget{classMolecule_l01684}01684             sprintf(x,\textcolor{stringliteral}{"{}\%4.4f"{}},atoms[i]-\/>seek\_x()*10);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01685}01685             sprintf(y,\textcolor{stringliteral}{"{}\%4.4f"{}},atoms[i]-\/>seek\_y()*10);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01686}01686             sprintf(z,\textcolor{stringliteral}{"{}\%4.4f"{}},atoms[i]-\/>seek\_z()*10);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01687}01687             sprintf(atstr,\textcolor{stringliteral}{"{}   \%4d \%4s     \%9s \%9s \%9s \%5s   1  DNV        \%1.4f\(\backslash\)n"{}},i+1,atoms[i]-\/>toString().c\_str(),x,y,z,symb.c\_str(),atoms[i]-\/>seek\_charge());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01688}01688             atomrecs+=atstr;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01689}01689             bondcount+=bonds[i].size();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01690}01690             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<bonds[i].size();j++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01691}01691             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01692}01692                 \textcolor{keywordflow}{if}(bonds[i][j]<i) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01693}01693                 \textcolor{keywordtype}{char} bstr[60];}
\DoxyCodeLine{\Hypertarget{classMolecule_l01694}01694                 std::string btype=\textcolor{stringliteral}{"{}1"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01695}01695                 \textcolor{keywordflow}{if}(!no\_orders)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01696}01696                 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01697}01697                     \textcolor{keywordflow}{if}(aromcat \&\& aromcat-\/>\mbox{\hyperlink{classCategory_a3ffa41a593852318c167862171166f1b}{contains}}(atoms[i]) \&\& aromcat-\/>\mbox{\hyperlink{classCategory_a3ffa41a593852318c167862171166f1b}{contains}}(atoms[bonds[i][j]])) btype=\textcolor{stringliteral}{"{}ar"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01698}01698                     \textcolor{keywordflow}{else} \{\textcolor{keywordflow}{if}(orders.size() \&\& orders[i][j]!=1) btype=to\_string(orders[i][j]);\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01699}01699                 \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01700}01700                 sprintf(bstr,\textcolor{stringliteral}{"{}  \%4d  \%4d  \%4d  \%4s\(\backslash\)n"{}},++conK,i+1,bonds[i][j]+1,btype.c\_str());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01701}01701                 bondrecs+=bstr;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01702}01702             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01703}01703         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01704}01704         globalrecs+=to\_string(atoms.size())+\textcolor{stringliteral}{"{} "{}}+to\_string(bondcount/2)+\textcolor{stringliteral}{"{} 0 0 0\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01705}01705         \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMolecule_a008ae56ec47345e906b08db6d2fd2b1c}{binding\_energy}}()) os << \textcolor{stringliteral}{"{}\#REMARK "{}}<<\mbox{\hyperlink{classMolecule_a008ae56ec47345e906b08db6d2fd2b1c}{binding\_energy}}()<<\textcolor{stringliteral}{"{}\(\backslash\)t"{}}<<\mbox{\hyperlink{classMolecule_a5fbc68980ca26d735d65eaf7c35a49c4}{hotspot\_binding\_energy}}()<<\textcolor{stringliteral}{"{}\(\backslash\)t"{}}<<\mbox{\hyperlink{classMolecule_abf3e45c79a7ae3fbb0fc174544debc1e}{pE}}<<\textcolor{stringliteral}{"{}\(\backslash\)t"{}}<<\mbox{\hyperlink{classMolecule_a6b1f799908a9d52d7194d07ac6bb28d3}{errBE}}<<\textcolor{stringliteral}{"{}\(\backslash\)t"{}}<<\mbox{\hyperlink{classMolecule_a32075500340345439d0d4912e26fb44f}{errHBE}}<<\textcolor{stringliteral}{"{}(error not impletemented yet -\/-\/ Last two columns)\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01706}01706         \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\& ring : cycles)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01707}01707         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01708}01708             os << \textcolor{stringliteral}{"{}\#REMARK CYCLE "{}}<<ring.size()<<\textcolor{stringliteral}{"{} with atoms: "{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01709}01709             \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : ring) os << \mbox{\hyperlink{classMolecule_aa13276cae00e350b9b28c07cb82ebcec}{indexOf}}(a) <<\textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01710}01710             os<< \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01711}01711         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01712}01712         os << globalrecs<<atomrecs<<bondrecs<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01713}01713     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a3afedbfc21fac19be1d4c5aaa9a9ac63}\label{classMolecule_a3afedbfc21fac19be1d4c5aaa9a9ac63}} 
\index{Molecule@{Molecule}!dumpMolAsTxt@{dumpMolAsTxt}}
\index{dumpMolAsTxt@{dumpMolAsTxt}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{dumpMolAsTxt()}{dumpMolAsTxt()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void Molecule\+::dump\+Mol\+As\+Txt (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{f,  }\item[{bool}]{cpt = {\ttfamily false} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Same as dump\+Mol\+As\+Txt(const std\+::string\&). Uses an output stream instead of filename. 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01617}{1617}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01617}01617 \{ofstream of; of.open(f,ios::out); this-\/>\mbox{\hyperlink{classMolecule_abeb8483a7acbcab66438a3ec61b53971}{dumpMolAsTxt}}(of,cpt); of.close();\}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_abeb8483a7acbcab66438a3ec61b53971}\label{classMolecule_abeb8483a7acbcab66438a3ec61b53971}} 
\index{Molecule@{Molecule}!dumpMolAsTxt@{dumpMolAsTxt}}
\index{dumpMolAsTxt@{dumpMolAsTxt}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{dumpMolAsTxt()}{dumpMolAsTxt()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void Molecule\+::dump\+Mol\+As\+Txt (\begin{DoxyParamCaption}\item[{ostream \&}]{f,  }\item[{bool}]{cpt = {\ttfamily false} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Dump the molecule as a TXT file (See algorithm documentation PDF for details about this format) 

This function dumps in the old TXT format. This function is kept as backward support. 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01607}{1607}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01608}01608     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01609}01609         f<<atoms.size()<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}}; \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++) f << *(atoms[i]) << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01610}01610         \textcolor{keywordflow}{if}(cpt)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01611}01611         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01612}01612             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++) \{\textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} bmi : bonds[i]) f <<\textcolor{stringliteral}{"{} "{}}<< bmi; f << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01613}01613             f << this-\/>\mbox{\hyperlink{classMolecule_adebb2c740099c5db4f14137bb1609877}{myBE}} <<\textcolor{stringliteral}{"{} "{}}<<this-\/>\mbox{\hyperlink{classMolecule_a6647358091d946bb02dbcf3ce35b7d5e}{myHBE}}<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01614}01614         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01615}01615     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_ab6c1f0207db1069de8e3a49a1881e880}\label{classMolecule_ab6c1f0207db1069de8e3a49a1881e880}} 
\index{Molecule@{Molecule}!free@{free}}
\index{free@{free}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{free()}{free()}}
{\footnotesize\ttfamily void Molecule\+::free (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classAtom}{Atom}} $\ast$}]{a,  }\item[{int}]{val = {\ttfamily -\/1} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Manually \char`\"{}frees\char`\"{} a capped or completely valency satisfied atom. 

Grants some free valencies to a given atom. No checks are performed at this stage to ensure that it does not cross the upper limit of allowed bonds for that atom. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em a} & A pointer to the \mbox{\hyperlink{classAtom}{Atom}} whose valency is to be set. If it doesn\textquotesingle{}t belong to this \mbox{\hyperlink{classMolecule}{Molecule}}, \mbox{\hyperlink{classAtomNotInMoleculeException}{Atom\+Not\+In\+Molecule\+Exception}} is thrown \\
\hline
\mbox{\texttt{ in}}  & {\em val} & The number of valecies to set for this atom. If it is negative, the free valecies of the target atom are set to 1 (if it was initally 0), otherwise it is unchanged. It should not be 0. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00968}{968}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l00969}00969     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00970}00970         assert(val); \textcolor{comment}{//val!=0}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00971}00971         \textcolor{keywordflow}{if}(!contains(atoms,a)) \textcolor{keywordflow}{throw} \mbox{\hyperlink{classAtomNotInMoleculeException}{AtomNotInMoleculeException}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l00972}00972         \textcolor{keywordflow}{if}(!contains(freeatoms,a)) freeatoms.push\_back(a);}
\DoxyCodeLine{\Hypertarget{classMolecule_l00973}00973         \textcolor{keywordflow}{if}(val<0) val=a-\/>seek\_valency();}
\DoxyCodeLine{\Hypertarget{classMolecule_l00974}00974         \textcolor{keywordflow}{if}(val==0) val=1;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00975}00975         a-\/>setValency(val);}
\DoxyCodeLine{\Hypertarget{classMolecule_l00976}00976     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a586d332662ebab7d9c3cdf667d39a901}\label{classMolecule_a586d332662ebab7d9c3cdf667d39a901}} 
\index{Molecule@{Molecule}!getAllBridgeHeads@{getAllBridgeHeads}}
\index{getAllBridgeHeads@{getAllBridgeHeads}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{getAllBridgeHeads()}{getAllBridgeHeads()}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::pair$<$ int, int $>$ $>$ Molecule\+::get\+All\+Bridge\+Heads (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Find all bridge-\/head atom index pairs for all possible bridges in this molecule. 

Looks for bridge edges in the molecule and produces all pairs of atoms that have bridge-\/bonds. 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01957}{1957}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01958}01958     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01959}01959         std::vector<std::pair<int,int>> ret;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01960}01960         this-\/>\mbox{\hyperlink{classMolecule_abfd8b7d4b46f69a9675e2fcac4397d19}{markCyclizedAtoms}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01961}01961         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01962}01962         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01963}01963             \textcolor{keywordflow}{if}(atoms[i]-\/>getStandardValency()<2) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01964}01964             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<bonds[i].size();j++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01965}01965             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01966}01966                 \textcolor{keywordflow}{if}(bonds[i][j]>i) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01967}01967                 \textcolor{keywordflow}{if}(atoms[bonds[i][j]]-\/>getStandardValency()<2) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01968}01968                 \textcolor{keywordflow}{if}(!inSameCycle(atoms[i],atoms[bonds[i][j]])) ret.push\_back(make\_pair(i,bonds[i][j]));}
\DoxyCodeLine{\Hypertarget{classMolecule_l01969}01969             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01970}01970         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01971}01971         \textcolor{keywordflow}{return} ret;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01972}01972     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a7d42c427c602da77f79246fe39246fb9}\label{classMolecule_a7d42c427c602da77f79246fe39246fb9}} 
\index{Molecule@{Molecule}!getAtoms@{getAtoms}}
\index{getAtoms@{getAtoms}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{getAtoms()}{getAtoms()}}
{\footnotesize\ttfamily const std\+::vector$<$ \mbox{\hyperlink{classAtom}{Atom}} $\ast$ $>$ \& Molecule\+::get\+Atoms (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get a copy of the list of atoms belonging to this \mbox{\hyperlink{classMolecule}{Molecule}}. 

This method will give a vector of Atom$\ast$ (pointers) for all the atoms in the \mbox{\hyperlink{classMolecule}{Molecule}}.~\newline
Any modifications made to the atoms in this list will reflect on those in \mbox{\hyperlink{classMolecule}{Molecule}} as well.~\newline
To avoid this copy the \mbox{\hyperlink{classMolecule}{Molecule}}. See \mbox{\hyperlink{classMolecule_a21ee086bf224ec95f24aae555e94b5b9}{Molecule\+::\+Molecule(const Molecule$\ast$)}} \begin{DoxyReturn}{Returns}
List (vector) of pointers to all the atoms of this molecules with same indices as the original molecule (std\+::vector$<$\+Atom$\ast$$>$) 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00599}{599}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l00599}00599 \{\textcolor{keywordflow}{return} atoms;\}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_aef77043ab98f1008a15a1e52d85b827e}\label{classMolecule_aef77043ab98f1008a15a1e52d85b827e}} 
\index{Molecule@{Molecule}!getBondedAtoms@{getBondedAtoms}}
\index{getBondedAtoms@{getBondedAtoms}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{getBondedAtoms()}{getBondedAtoms()}}
{\footnotesize\ttfamily const std\+::vector$<$ \mbox{\hyperlink{classAtom}{Atom}} $\ast$ $>$ Molecule\+::get\+Bonded\+Atoms (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classAtom}{Atom}} $\ast$}]{src }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get all atoms bonded to a given atom. 

Gives a list of pointers to all the atoms that are bonded to this atom. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em src} & Source atom for which bonded atom list is required. If the atom is itself not in this molecule, \mbox{\hyperlink{classAtomNotInMoleculeException}{Atom\+Not\+In\+Molecule\+Exception}} is thrown \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
List of pointers to all the atoms (std\+::vector$<$\+Atom$\ast$$>$) 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00994}{994}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l00995}00995     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00996}00996         std::vector<Atom*> res;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00997}00997     \textcolor{comment}{//cout << src-\/>toString()<<"{}: getBondedAtoms() was called on this\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00998}00998         \textcolor{keywordtype}{int} ind=\mbox{\hyperlink{classMolecule_aa13276cae00e350b9b28c07cb82ebcec}{indexOf}}(src);}
\DoxyCodeLine{\Hypertarget{classMolecule_l00999}00999     \textcolor{keywordflow}{if}(ind==-\/1)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01000}01000         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01001}01001             cout << src-\/>\mbox{\hyperlink{classAtom_a189def3b8bade8507d49cfd7de881178}{toString}}() << \textcolor{stringliteral}{"{}("{}}<<(long)src<<\textcolor{stringliteral}{"{}) not in: "{}}; \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++) cout << atoms[i]-\/>toString()<<\textcolor{stringliteral}{"{}("{}}<<(long)atoms[i]<<\textcolor{stringliteral}{"{}),"{}}; cout << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}; \textcolor{keywordflow}{throw} \mbox{\hyperlink{classAtomNotInMoleculeException}{AtomNotInMoleculeException}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01002}01002         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01003}01003         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i : bonds[ind]) res.push\_back(atoms[i]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01004}01004         \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01005}01005     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a7b87ff96eec588c7296fcda7ee7ed178}\label{classMolecule_a7b87ff96eec588c7296fcda7ee7ed178}} 
\index{Molecule@{Molecule}!getBonds@{getBonds}}
\index{getBonds@{getBonds}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{getBonds()}{getBonds()}}
{\footnotesize\ttfamily const std\+::vector$<$ std\+::vector$<$ int $>$ $>$ \& Molecule\+::get\+Bonds (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get the bonding data of the molecule. 

This method will give a copy of the adjacency list stored in this object. \begin{DoxyReturn}{Returns}
The matrix is returned as a vector of integer-\/entry vectors (std\+::vector$<$std\+::vector$<$int$>$$>$) 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00604}{604}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l00604}00604 \{\textcolor{keywordflow}{return} bonds;\}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a0839d679a7ed5664c8729ab572ef67d7}\label{classMolecule_a0839d679a7ed5664c8729ab572ef67d7}} 
\index{Molecule@{Molecule}!getCentreOfGeometry@{getCentreOfGeometry}}
\index{getCentreOfGeometry@{getCentreOfGeometry}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{getCentreOfGeometry()}{getCentreOfGeometry()}}
{\footnotesize\ttfamily Eigen\+::\+Vector3d Molecule\+::get\+Centre\+Of\+Geometry (\begin{DoxyParamCaption}\item[{bool}]{inch = {\ttfamily false} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get the center of geometry of the molecule. 

Calculates the center of geometry for a molecule. The position is returned as a Vector (Eigen\+::\+Vector3d) 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em inch} & Include hydrogens? If set to true, the hydrogren atom positions are also considered for calculation of center of geomtery. Default\+: false \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01729}{1729}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01730}01730   \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01731}01731     Eigen::Vector3d COG(0,0,0);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01732}01732     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : \mbox{\hyperlink{classMolecule_a7d42c427c602da77f79246fe39246fb9}{getAtoms}}())}
\DoxyCodeLine{\Hypertarget{classMolecule_l01733}01733     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01734}01734       \textcolor{keywordflow}{if}(!inch \&\& a-\/>isHydrogen()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01735}01735       COG+=a-\/>getPosition();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01736}01736     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01737}01737     \textcolor{keywordflow}{if}(inch) COG/=\mbox{\hyperlink{classMolecule_a6946cbe0d8daa9b2386d85ca7faf0cd1}{getSize}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01738}01738     \textcolor{keywordflow}{else} COG/=\mbox{\hyperlink{classMolecule_a4c6228c3225bd9571ba276841caa7c90}{getEffectiveSize}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01739}01739     \textcolor{keywordflow}{return} COG;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01740}01740   \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a9b7c224368ec15caea268e26051c9437}\label{classMolecule_a9b7c224368ec15caea268e26051c9437}} 
\index{Molecule@{Molecule}!getCompleteHash@{getCompleteHash}}
\index{getCompleteHash@{getCompleteHash}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{getCompleteHash()}{getCompleteHash()}}
{\footnotesize\ttfamily std\+::vector$<$ int $>$ Molecule\+::get\+Complete\+Hash (\begin{DoxyParamCaption}\item[{bool}]{heavy = {\ttfamily false} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get a complete hash vector for a molecule. -\/ experimental. 

The hash vector generated by this function can uniquely identify each atom of the molecule and the molecule as a whole.~\newline
As of now, this hash cannot be used as a fingerprint for similarity matching. However, it can be used to tell if two molecule graphs are exactly same or not \begin{DoxyReturn}{Returns}
The hash vector for the entire molecule. If two molecules are same, they will have the same hash vector. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l02421}{2421}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l02422}02422     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02423}02423         std::vector<int> fhash;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02424}02424         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02425}02425         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02426}02426             cout << atoms[i]-\/>toString() << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02427}02427             \textcolor{keywordflow}{if}(!atoms[i]-\/>hashvector.size()) hashatomcomplete(i);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02428}02428         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02429}02429         \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : atoms)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02430}02430         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02431}02431             \textcolor{keywordflow}{if}(heavy \&\& a-\/>isHydrogen()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02432}02432             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<a-\/>hashvector.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02433}02433             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02434}02434                 \textcolor{keywordflow}{if}(fhash.size()>i) fhash[i]+=a-\/>hashvector[i];}
\DoxyCodeLine{\Hypertarget{classMolecule_l02435}02435                 \textcolor{keywordflow}{else} fhash.push\_back(a-\/>hashvector[i]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02436}02436             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02437}02437         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02438}02438         \textcolor{keywordflow}{return} fhash;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02439}02439     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a3d482b455228629e6ca908ce461a64a7}\label{classMolecule_a3d482b455228629e6ca908ce461a64a7}} 
\index{Molecule@{Molecule}!getContainer@{getContainer}}
\index{getContainer@{getContainer}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{getContainer()}{getContainer()}}
{\footnotesize\ttfamily std\+::pair$<$ Eigen\+::\+Vector3d, Eigen\+::\+Vector3d $>$ Molecule\+::get\+Container (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get a containing \char`\"{}box\char`\"{} co-\/ordinates which ensures that the molecule is enclosed by it. 

This functions will give the co-\/ordinates (x\textsubscript{min},y\textsubscript{min},z\textsubscript{min}) and (x\textsubscript{max},y\textsubscript{max},z\textsubscript{max}).~\newline
 Using these coordinates, a bounding box can be constructed \begin{DoxyReturn}{Returns}
Pair of Vectors (std\+::pair$<$\+Eigen\+::\+Vector3d,\+Eigen\+::\+Vector3d$>$), one for each co-\/ordinate 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01786}{1786}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01787}01787   \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01788}01788     Eigen::Vector3d minC,maxC,temp;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01789}01789     \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMolecule_a6946cbe0d8daa9b2386d85ca7faf0cd1}{getSize}}()<=0) \textcolor{keywordflow}{return} make\_pair(Eigen::Vector3d(0,0,0),Eigen::Vector3d(0,0,0));}
\DoxyCodeLine{\Hypertarget{classMolecule_l01790}01790     minC=atoms[0]-\/>getPosition(); maxC=atoms[0]-\/>getPosition();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01791}01791     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=1;i<atoms.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01792}01792     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01793}01793       temp=atoms[i]-\/>getPosition();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01794}01794       minC(0)=min(temp(0),minC(0));}
\DoxyCodeLine{\Hypertarget{classMolecule_l01795}01795       minC(1)=min(temp(1),minC(1));}
\DoxyCodeLine{\Hypertarget{classMolecule_l01796}01796       minC(2)=min(temp(2),minC(2));}
\DoxyCodeLine{\Hypertarget{classMolecule_l01797}01797 }
\DoxyCodeLine{\Hypertarget{classMolecule_l01798}01798       maxC(0)=max(temp(0),maxC(0));}
\DoxyCodeLine{\Hypertarget{classMolecule_l01799}01799       maxC(1)=max(temp(1),maxC(1));}
\DoxyCodeLine{\Hypertarget{classMolecule_l01800}01800       maxC(2)=max(temp(2),maxC(2));}
\DoxyCodeLine{\Hypertarget{classMolecule_l01801}01801     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01802}01802     \textcolor{keywordflow}{return} make\_pair(minC,maxC);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01803}01803   \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a4c6228c3225bd9571ba276841caa7c90}\label{classMolecule_a4c6228c3225bd9571ba276841caa7c90}} 
\index{Molecule@{Molecule}!getEffectiveSize@{getEffectiveSize}}
\index{getEffectiveSize@{getEffectiveSize}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{getEffectiveSize()}{getEffectiveSize()}}
{\footnotesize\ttfamily int Molecule\+::get\+Effective\+Size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get the total number of atoms (excluding hydrogen atoms) in this \mbox{\hyperlink{classMolecule}{Molecule}}. 

Hydrogen atoms are considered \char`\"{}light\char`\"{} atoms by De\+Novo. An atom type is considered to be a hydrogen atom if the first character of its atom name is \textquotesingle{}H\textquotesingle{}~\newline
See Also\+: \mbox{\hyperlink{classMolecule_a6946cbe0d8daa9b2386d85ca7faf0cd1}{get\+Size() const}} 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00575}{575}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l00576}00576     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00577}00577         \textcolor{keywordflow}{if}(VARIEDCOUNT) \textcolor{keywordflow}{return} HAC;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00578}00578         \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} atoms.size()-\/\mbox{\hyperlink{classMolecule_ab9512050a395e0ebb8fbba92f0a91222}{HC}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00579}00579     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a804447203e588ac312611688aa4fb500}\label{classMolecule_a804447203e588ac312611688aa4fb500}} 
\index{Molecule@{Molecule}!getFirstOrderHash@{getFirstOrderHash}}
\index{getFirstOrderHash@{getFirstOrderHash}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{getFirstOrderHash()}{getFirstOrderHash()}}
{\footnotesize\ttfamily long int Molecule\+::get\+First\+Order\+Hash (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Numeric first-\/order hash. 

\begin{DoxyRefDesc}{Deprecated}
\item[\mbox{\hyperlink{deprecated__deprecated000050}{Deprecated}}]Use \mbox{\hyperlink{classMolecule_a9b7c224368ec15caea268e26051c9437}{get\+Complete\+Hash()}} now \end{DoxyRefDesc}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l02410}{2410}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l02411}02411     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02412}02412         \textcolor{keywordflow}{if}(!atoms.size()) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02413}02413         \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} hash=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02414}02414         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++) \{hash+=\mbox{\hyperlink{classMolecule_a54571895bd7b4ffa483889aad3b1092b}{hashatom}}(atoms[i]);\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02415}02415         \textcolor{keywordflow}{return} hash;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02416}02416     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a63283844d6c417b775c29fc9c86eef47}\label{classMolecule_a63283844d6c417b775c29fc9c86eef47}} 
\index{Molecule@{Molecule}!getHotspotEnergy@{getHotspotEnergy}}
\index{getHotspotEnergy@{getHotspotEnergy}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{getHotspotEnergy()}{getHotspotEnergy()}}
{\footnotesize\ttfamily double Molecule\+::get\+Hotspot\+Energy (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classSystem}{System}} \&}]{s,  }\item[{double}]{v = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

\begin{DoxyRefDesc}{Deprecated}
\item[\mbox{\hyperlink{deprecated__deprecated000047}{Deprecated}}]Calculate the non-\/bonding interaction energy of the \mbox{\hyperlink{classMolecule}{Molecule}} to the hotspot region of the Proteins in this system. Use \mbox{\hyperlink{classMolecule_a973b1a0e85f2a3cf1e5c55dbe24c54e3}{calculate\+Non\+Bonding\+Energy()}} \end{DoxyRefDesc}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l04128}{4128}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l04129}04129 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04130}04130   \textcolor{keywordflow}{if}(v!=0) \textcolor{keywordflow}{return} v;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04131}04131   \textcolor{keywordflow}{for}(\mbox{\hyperlink{classMolecule}{Molecule}}* m : s.\mbox{\hyperlink{classSystem_a9a511120c5458822e88f2136aa7fdb2e}{getMolecules}}())}
\DoxyCodeLine{\Hypertarget{classMolecule_l04132}04132   \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04133}04133     v+=get<1>(((\mbox{\hyperlink{classProtein}{Protein}}*)m)-\/>\mbox{\hyperlink{classMolecule_a973b1a0e85f2a3cf1e5c55dbe24c54e3}{calculateNonBondingEnergy}}(\textcolor{keyword}{this}));}
\DoxyCodeLine{\Hypertarget{classMolecule_l04134}04134     \textcolor{comment}{//v+=((Protein*)m)-\/>getHotspotBindingEnergy();}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04135}04135   \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04136}04136   \textcolor{keywordflow}{return} v;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04137}04137 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a1a3d512a623d6ffdcc21783b651c1dee}\label{classMolecule_a1a3d512a623d6ffdcc21783b651c1dee}} 
\index{Molecule@{Molecule}!getLastAtom@{getLastAtom}}
\index{getLastAtom@{getLastAtom}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{getLastAtom()}{getLastAtom()}}
{\footnotesize\ttfamily const \mbox{\hyperlink{classAtom}{Atom}} $\ast$ Molecule\+::get\+Last\+Atom (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get the last atom in this molecule. 

It is usually the atom last added to the \mbox{\hyperlink{classMolecule}{Molecule}}.~\newline
 It is basically a wrapper for mol-\/\texorpdfstring{$>$}{>}get\+Atom(mol-\/\texorpdfstring{$>$}{>}\mbox{\hyperlink{classMolecule_a6946cbe0d8daa9b2386d85ca7faf0cd1}{get\+Size()}}-\/1); 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00585}{585}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l00585}00585 \{\textcolor{keywordflow}{return} atoms[atoms.size()-\/1];\}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a69594b093fbb60eabc373d6860f19a87}\label{classMolecule_a69594b093fbb60eabc373d6860f19a87}} 
\index{Molecule@{Molecule}!getNetCharge@{getNetCharge}}
\index{getNetCharge@{getNetCharge}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{getNetCharge()}{getNetCharge()}}
{\footnotesize\ttfamily double Molecule\+::get\+Net\+Charge (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classForceField}{Force\+Field}} \&}]{ff }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get expected charge of a molecule. 

The expected charge is calculated by summing the non-\/zero formal charges on each atom. The formal charges are defined separately in the forcefield (See algorithm PDF) 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01553}{1553}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01554}01554     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01555}01555         \textcolor{keywordtype}{double} nc=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01556}01556         \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* at : atoms) nc+=at-\/>getFormalCharge();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01557}01557         \textcolor{keywordflow}{return} nc;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01558}01558     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a50d2a2068fcda1e9676eb5d8e3aac9f2}\label{classMolecule_a50d2a2068fcda1e9676eb5d8e3aac9f2}} 
\index{Molecule@{Molecule}!getRandomBondableAtom@{getRandomBondableAtom}}
\index{getRandomBondableAtom@{getRandomBondableAtom}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{getRandomBondableAtom()}{getRandomBondableAtom()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classAtom}{Atom}} $\ast$ Molecule\+::get\+Random\+Bondable\+Atom (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Randomly select an atom with free valencies. 

Randomly picks an atom from the list of \char`\"{}free atoms\char`\"{}. If the \mbox{\hyperlink{classMolecule}{Molecule}} was manually constructed, you may need to use \mbox{\hyperlink{classMolecule_a588965bd448a1cb43f25aed3179ecf96}{calculate\+Free\+Atoms()}} \begin{DoxyReturn}{Returns}
A pointer to a random \mbox{\hyperlink{classAtom}{Atom}} belonging to this molecule which has at-\/least one free valency. If there is no such atom, a nullptr (Null-\/pointer) is returned 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01134}{1134}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01135}01135     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01136}01136         \textcolor{keywordflow}{if}(!freeatoms.size()) \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01137}01137         \textcolor{keywordflow}{return} randomSelect(freeatoms);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01138}01138     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_ad2e19e6613d0ed3d7249a3aaea8f87dd}\label{classMolecule_ad2e19e6613d0ed3d7249a3aaea8f87dd}} 
\index{Molecule@{Molecule}!getSMILES2@{getSMILES2}}
\index{getSMILES2@{getSMILES2}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{getSMILES2()}{getSMILES2()}}
{\footnotesize\ttfamily std\+::pair$<$ std\+::string, std\+::vector$<$ \mbox{\hyperlink{classAtom}{Atom}} $\ast$ $>$ $>$ Molecule\+::get\+SMILES2 (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classForceField}{Force\+Field}} $\ast$}]{ff = {\ttfamily nullptr},  }\item[{bool}]{daylight = {\ttfamily false} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get SMILES format for this molecule -\/ Improved. 

This function parses the graph of the molecule to generate a valid smiles string. It requires a \mbox{\hyperlink{classForceField}{Force\+Field}} (in order to get valency and hybridization).~\newline
For complete molecules (with no free valecies), the \char`\"{}empty\char`\"{} force-\/field can be used (See algorithm PDF).~\newline
It can also be called without a \mbox{\hyperlink{classForceField}{Force\+Field}}, in which case it guesses at the valencies using standard parameters.~\newline
This function requires the \mbox{\hyperlink{classMolecule_ab64af9956394c7077c0ebf2db64b9cdf}{calculate\+Bond\+Orders()}} to be called eariler on this \mbox{\hyperlink{classMolecule}{Molecule}} object 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ff} & \mbox{\hyperlink{classForceField}{Force\+Field}} to use (Note that it\textquotesingle{}s a pointer to the \mbox{\hyperlink{classForceField}{Force\+Field}} object) \\
\hline
\mbox{\texttt{ in}}  & {\em daylight} & Generate daylight SMILES (represents aromatic atoms with small letters and omits their bond-\/orders) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l02203}{2203}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l02204}02204     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02205}02205         \textcolor{keywordflow}{if}(daylight \&\& (!ff || !ff-\/>\mbox{\hyperlink{classForceField_ab5bfc00e94bac57310cc3a4778e11342}{hasCategory}}(\textcolor{stringliteral}{"{}aromatic"{}}))) \textcolor{keywordflow}{throw} \mbox{\hyperlink{classNoAromaticCategoryException}{NoAromaticCategoryException}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l02206}02206         \textcolor{keywordflow}{if}(!orders.size()) \textcolor{keywordflow}{throw} \mbox{\hyperlink{classBondOrdersUncalculatedException}{BondOrdersUncalculatedException}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l02207}02207         \textcolor{keyword}{const} \mbox{\hyperlink{classCategory}{Category}} *aromcat=\&(ff-\/>\mbox{\hyperlink{classForceField_a5a30c5a7760b5c791c5b34f9bd133506}{getCategory}}(\textcolor{stringliteral}{"{}aromatic"{}})),*halocat=\textcolor{keyword}{nullptr}; \textcolor{keywordflow}{if}(ff-\/>\mbox{\hyperlink{classForceField_ab5bfc00e94bac57310cc3a4778e11342}{hasCategory}}(\textcolor{stringliteral}{"{}halogen"{}})) halocat=\&(ff-\/>\mbox{\hyperlink{classForceField_a5a30c5a7760b5c791c5b34f9bd133506}{getCategory}}(\textcolor{stringliteral}{"{}halogen"{}}));}
\DoxyCodeLine{\Hypertarget{classMolecule_l02208}02208         std::string SMILES=\textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02209}02209         \textcolor{keywordtype}{int} K=0,ringID=1;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02210}02210         \textcolor{keywordflow}{for}(K=0;K<atoms.size();K++) \textcolor{keywordflow}{if}(!atoms[K]-\/>isHydrogen()) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02211}02211         std::vector<int> hcount,visited;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02212}02212         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02213}02213         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02214}02214             \textcolor{keywordtype}{int} hC=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02215}02215             \textcolor{keywordflow}{if}(atoms[i]-\/>isHydrogen()) \{hcount.push\_back(0); \textcolor{keywordflow}{continue};\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02216}02216             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<bonds[i].size();j++) \{\textcolor{keywordflow}{if}(atoms[bonds[i][j]]-\/>isHydrogen()) hC++;\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02217}02217             hcount.push\_back(hC);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02218}02218         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02219}02219         std::vector<std::string> atomnames;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02220}02220         \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : atoms)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02221}02221         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02222}02222             \textcolor{keywordflow}{if}(halocat \&\& halocat-\/>contains(a))}
\DoxyCodeLine{\Hypertarget{classMolecule_l02223}02223             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02224}02224                 \textcolor{keywordflow}{if}(a-\/>toString()[0]==\textcolor{charliteral}{'C'}) atomnames.push\_back(\textcolor{stringliteral}{"{}Cl"{}});}
\DoxyCodeLine{\Hypertarget{classMolecule_l02225}02225                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(a-\/>toString()[0]==\textcolor{charliteral}{'B'}) atomnames.push\_back(\textcolor{stringliteral}{"{}Br"{}});}
\DoxyCodeLine{\Hypertarget{classMolecule_l02226}02226                 \textcolor{keywordflow}{else} atomnames.push\_back(std::string(1,a-\/>toString()[0]));}
\DoxyCodeLine{\Hypertarget{classMolecule_l02227}02227             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02228}02228             \textcolor{keywordflow}{else} atomnames.push\_back(std::string(1,a-\/>toString()[0]));}
\DoxyCodeLine{\Hypertarget{classMolecule_l02229}02229             \textcolor{keywordflow}{if}(a-\/>getFormalCharge())}
\DoxyCodeLine{\Hypertarget{classMolecule_l02230}02230             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02231}02231                 \textcolor{keywordtype}{int} atnind=\mbox{\hyperlink{classMolecule_aa13276cae00e350b9b28c07cb82ebcec}{indexOf}}(a); \textcolor{keywordflow}{if}(hcount[atnind]) atomnames[atomnames.size()-\/1]+=\textcolor{stringliteral}{"{}H"{}}+((hcount[atnind]==1)?\textcolor{stringliteral}{"{}"{}}:to\_string(hcount[atnind]));}
\DoxyCodeLine{\Hypertarget{classMolecule_l02232}02232                 \textcolor{keywordflow}{if}(a-\/>getFormalCharge()>0) atomnames[atomnames.size()-\/1]=\textcolor{stringliteral}{"{}["{}}+atomnames[atomnames.size()-\/1]+\textcolor{stringliteral}{"{}+"{}}+to\_string((\textcolor{keywordtype}{int})a-\/>getFormalCharge())+\textcolor{stringliteral}{"{}]"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02233}02233                 \textcolor{keywordflow}{else} atomnames[atomnames.size()-\/1]=\textcolor{stringliteral}{"{}["{}}+atomnames[atomnames.size()-\/1]+to\_string((\textcolor{keywordtype}{int})a-\/>getFormalCharge())+\textcolor{stringliteral}{"{}]"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02234}02234             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02235}02235         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02236}02236 }
\DoxyCodeLine{\Hypertarget{classMolecule_l02237}02237         std::vector<Atom*> neworder;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02238}02238         parseForSMILES2(K,SMILES,atomnames,hcount,visited,neworder,ringID);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02239}02239         \textcolor{keywordflow}{if}(!QUIET) cout << \textcolor{stringliteral}{"{}Raw SMILES: "{}}<<SMILES<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02240}02240 }
\DoxyCodeLine{\Hypertarget{classMolecule_l02241}02241         \textcolor{comment}{//Replacing atom references by actual node data}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02242}02242         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=atoms.size()-\/1;i>=0;i-\/-\/)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02243}02243         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02244}02244             \textcolor{keywordflow}{if}(!atoms[i]-\/>isHydrogen()) cout << atoms[i]-\/>toString() << \textcolor{stringliteral}{"{}\(\backslash\)t"{}}<<atomnames[i]<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02245}02245             \textcolor{keywordflow}{else} \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02246}02246             std::string oldsmiles=\textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02247}02247             \textcolor{keywordflow}{while}(oldsmiles!=SMILES)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02248}02248             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02249}02249                 oldsmiles=SMILES;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02250}02250                 \mbox{\hyperlink{namespacestringfx_a827b03090f77597d306efc02f5132d04}{stringfx::replace}}(SMILES,\textcolor{stringliteral}{"{}\&"{}}+to\_string(i)+\textcolor{stringliteral}{"{}\$"{}},atomnames[i]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02251}02251             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02252}02252         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02253}02253 }
\DoxyCodeLine{\Hypertarget{classMolecule_l02254}02254         \textcolor{comment}{//Return the result}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02255}02255         \textcolor{keywordflow}{if}(!QUIET) cout << \textcolor{stringliteral}{"{}New order: \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02256}02256         \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : neworder) cout << a-\/>toString() <<\textcolor{stringliteral}{"{}("{}}<<this-\/>\mbox{\hyperlink{classMolecule_aa13276cae00e350b9b28c07cb82ebcec}{indexOf}}(a)<<\textcolor{stringliteral}{"{})"{}}<< \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02257}02257         \textcolor{keywordflow}{return} make\_pair(SMILES,neworder);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02258}02258     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a54571895bd7b4ffa483889aad3b1092b}\label{classMolecule_a54571895bd7b4ffa483889aad3b1092b}} 
\index{Molecule@{Molecule}!hashatom@{hashatom}}
\index{hashatom@{hashatom}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{hashatom()}{hashatom()}}
{\footnotesize\ttfamily long int Molecule\+::hashatom (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classAtom}{Atom}} $\ast$}]{a }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Numeric first-\/order hash. 

\begin{DoxyRefDesc}{Deprecated}
\item[\mbox{\hyperlink{deprecated__deprecated000049}{Deprecated}}]Use hashatomcomplete() now \end{DoxyRefDesc}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l02385}{2385}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l02386}02386     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02387}02387         std::vector<Atom*> bnd=this-\/>\mbox{\hyperlink{classMolecule_aef77043ab98f1008a15a1e52d85b827e}{getBondedAtoms}}(a);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02388}02388         \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} myhash=(\textcolor{keywordtype}{long} int)(a-\/>toString()[0])*10000;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02389}02389         \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* n : bnd)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02390}02390         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02391}02391             \textcolor{keywordflow}{if}(bnd.size()==1)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02392}02392             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02393}02393                 \textcolor{keywordflow}{if}(!n-\/>hashvalue) \mbox{\hyperlink{classMolecule_a54571895bd7b4ffa483889aad3b1092b}{hashatom}}(n);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02394}02394                 myhash+=n-\/>hashvalue;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02395}02395             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02396}02396             myhash+=(int)(n-\/>toString()[0]*10)*(this-\/>\mbox{\hyperlink{classMolecule_aef77043ab98f1008a15a1e52d85b827e}{getBondedAtoms}}(n).size());}
\DoxyCodeLine{\Hypertarget{classMolecule_l02397}02397             std::vector<Atom*> sobnd=this-\/>\mbox{\hyperlink{classMolecule_aef77043ab98f1008a15a1e52d85b827e}{getBondedAtoms}}(n);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02398}02398             \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* n2 : sobnd)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02399}02399             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02400}02400                 \textcolor{keywordtype}{int} nb=bonds[\mbox{\hyperlink{classMolecule_aa13276cae00e350b9b28c07cb82ebcec}{indexOf}}(n2)].size();}
\DoxyCodeLine{\Hypertarget{classMolecule_l02401}02401                 \textcolor{keywordflow}{if}(nb==1) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02402}02402                 \textcolor{keywordflow}{if}(n2==a) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02403}02403                 myhash+=(\textcolor{keywordtype}{long} int)(n2-\/>toString()[0])*nb;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02404}02404             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02405}02405         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02406}02406         a-\/>hashvalue=myhash;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02407}02407         \textcolor{keywordflow}{return} myhash;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02408}02408     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_aa13276cae00e350b9b28c07cb82ebcec}\label{classMolecule_aa13276cae00e350b9b28c07cb82ebcec}} 
\index{Molecule@{Molecule}!indexOf@{indexOf}}
\index{indexOf@{indexOf}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{indexOf()}{indexOf()}}
{\footnotesize\ttfamily int Molecule\+::index\+Of (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classAtom}{Atom}} $\ast$}]{p }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get the index value of an atom from it\textquotesingle{}s pointer. 

\begin{DoxyReturn}{Returns}
The index of the atom. If the atom is not found, the result is \textquotesingle{}-\/1\textquotesingle{} 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00610}{610}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l00610}00610 \{\textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++) \{\textcolor{keywordflow}{if}(atoms[i]==p) \textcolor{keywordflow}{return} i;\} \textcolor{keywordflow}{return} -\/1;\}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a1b92bf02eb26dd75ea36273601e0a3c2}\label{classMolecule_a1b92bf02eb26dd75ea36273601e0a3c2}} 
\index{Molecule@{Molecule}!loadGrid@{loadGrid}}
\index{loadGrid@{loadGrid}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{loadGrid()}{loadGrid()}}
{\footnotesize\ttfamily virtual void Molecule\+::load\+Grid (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classSystem}{System}} \&}]{s }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}

\begin{DoxyRefDesc}{Deprecated}
\item[\mbox{\hyperlink{deprecated__deprecated000043}{Deprecated}}]Grid functions are deprecated \end{DoxyRefDesc}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00986}{986}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l00986}00986 \{s.\mbox{\hyperlink{classSystem_ab40a2d763cf2f23f4565f663aedc25df}{grid}}().fill\_with\_zero();\}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a04b3beb3e333664d6421e9f0ee46dd73}\label{classMolecule_a04b3beb3e333664d6421e9f0ee46dd73}} 
\index{Molecule@{Molecule}!makeBond@{makeBond}}
\index{makeBond@{makeBond}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{makeBond()}{makeBond()}}
{\footnotesize\ttfamily void Molecule\+::make\+Bond (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classAtom}{Atom}} $\ast$}]{a1,  }\item[{\mbox{\hyperlink{classAtom}{Atom}} $\ast$}]{a2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Join two atoms to make a bond. 

This is one of the functions used for manually constructing a molecule in cpp. I can also be used to add non-\/existing/un-\/expected bonds to a loaded molecule.~\newline
This function accepts two atoms (as pointers). These atoms {\bfseries{must belong to this \mbox{\hyperlink{classMolecule}{Molecule}} object}}. See \mbox{\hyperlink{classMolecule_aadf1f51e311a11e69385ff51602b86bc}{add\+Atom(\+Atom$\ast$)}} for details on adding an atom~\newline
It is necessary for both atoms to have one free valency at-\/least. Make sure you have chosen the correct atom types before bonding. You can add valencies using \mbox{\hyperlink{classMolecule_ab6c1f0207db1069de8e3a49a1881e880}{free()}} or \mbox{\hyperlink{classAtom_a9eb04d5b5e7b60694e96e5f9dd20bfac}{Atom\+::set\+Valency(int)}}, but it is not recommended. If you do not know what atom-\/type to use and/or do not intend to use it with force-\/fields, use the \char`\"{}empty forcefield\char`\"{}.~\newline
 See Also\+: Force-\/\+Field in PDF, and the \mbox{\hyperlink{classForceField}{Force\+Field}} class 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01143}{1143}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01144}01144     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01145}01145         assert(a1!=a2);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01146}01146         \textcolor{keywordtype}{int} i1=\mbox{\hyperlink{classMolecule_aa13276cae00e350b9b28c07cb82ebcec}{indexOf}}(a1),i2=\mbox{\hyperlink{classMolecule_aa13276cae00e350b9b28c07cb82ebcec}{indexOf}}(a2);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01147}01147         \textcolor{keywordflow}{if}(i1==-\/1 || i2==-\/1) \textcolor{keywordflow}{throw} \mbox{\hyperlink{classAtomNotInMoleculeException}{AtomNotInMoleculeException}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01148}01148 \textcolor{preprocessor}{        \#ifndef PLACEHOLDERMOLECULES}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01149}01149             \textcolor{keywordflow}{if}(!a1-\/>\mbox{\hyperlink{classAtom_acd1d81d4d5011bd1cf6b53e6ec5830dd}{canBond}}() || !a2-\/>\mbox{\hyperlink{classAtom_acd1d81d4d5011bd1cf6b53e6ec5830dd}{canBond}}()) \textcolor{keywordflow}{throw} \mbox{\hyperlink{classNoValencyAvailableException}{NoValencyAvailableException}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01150}01150 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01151}01151         bonds[i1].push\_back(i2);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01152}01152         bonds[i2].push\_back(i1);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01153}01153         a1-\/>\mbox{\hyperlink{classAtom_a6d1ed6f7432ecc88bee6faa26294cd08}{addBond}}(); a2-\/>\mbox{\hyperlink{classAtom_a6d1ed6f7432ecc88bee6faa26294cd08}{addBond}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01154}01154         \textcolor{keywordflow}{if}(!a1-\/>\mbox{\hyperlink{classAtom_acd1d81d4d5011bd1cf6b53e6ec5830dd}{canBond}}()) freeatoms.erase(std::remove(freeatoms.begin(), freeatoms.end(), a1), freeatoms.end());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01155}01155         \textcolor{keywordflow}{if}(!a2-\/>\mbox{\hyperlink{classAtom_acd1d81d4d5011bd1cf6b53e6ec5830dd}{canBond}}()) freeatoms.erase(std::remove(freeatoms.begin(), freeatoms.end(), a2), freeatoms.end());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01156}01156     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a6351ba55249d7e5659dfbb397dd0e069}\label{classMolecule_a6351ba55249d7e5659dfbb397dd0e069}} 
\index{Molecule@{Molecule}!makePruneFragment@{makePruneFragment}}
\index{makePruneFragment@{makePruneFragment}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{makePruneFragment()}{makePruneFragment()}}
{\footnotesize\ttfamily void Molecule\+::make\+Prune\+Fragment (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{int}]{devid = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



This function generates the starting fragment for \char`\"{}pruning\char`\"{} (See algorthim PDF). 

The algorithm of pruning requires removal of random \char`\"{}terminal\char`\"{} atoms. Atoms which have a single non-\/hydrogen neighbour are treated as terminals, and the non-\/hydrogen neighbour is called the \char`\"{}stem\char`\"{}. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em n} & It is the prune depth. \textquotesingle{}n\textquotesingle{} terminal atoms are recursively removed before pruning begins. After the first terminal atom is removed, the next atom (which initially was not terminal but is terminal now) can be removed (hence the term \textquotesingle{}depth\textquotesingle{}) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l02096}{2096}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l02097}02097     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02098}02098         cout << \textcolor{stringliteral}{"{}Begin. n="{}}<<n<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02099}02099         std::vector<std::vector<int>> hydats;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02100}02100         std::vector<int> terms,termconns;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02101}02101         \textcolor{keywordtype}{bool} terminal=\textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02102}02102         \textcolor{keywordtype}{int} termholder=-\/1;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02103}02103         std::vector<int> hydatis;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02104}02104         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02105}02105         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02106}02106             \textcolor{keywordflow}{if}(atoms[i]-\/>isHydrogen()) \{hydatis.push\_back(i); \textcolor{keywordflow}{continue};\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02107}02107             std::vector<int> hyd;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02108}02108             terminal=\textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02109}02109             termholder=-\/1;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02110}02110             \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keywordtype}{int}\& bai : bonds[i])}
\DoxyCodeLine{\Hypertarget{classMolecule_l02111}02111             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02112}02112                 \textcolor{keywordflow}{if}(atoms[bai]-\/>isHydrogen()) hyd.push\_back(bai);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02113}02113                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02114}02114                 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02115}02115                     \textcolor{keywordflow}{if}(termholder==-\/1) termholder=bai;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02116}02116                     \textcolor{keywordflow}{else} \{terminal=\textcolor{keyword}{false}; \textcolor{keywordflow}{break};\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02117}02117                 \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02118}02118             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02119}02119             \textcolor{keywordflow}{if}(terminal)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02120}02120             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02121}02121                 \textcolor{keywordflow}{if}(termholder==-\/1) cout << \textcolor{stringliteral}{"{}WARN: holder not found!!!\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02122}02122                 terms.push\_back(i); hydats.push\_back(hyd); termconns.push\_back(termholder);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02123}02123             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02124}02124         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02125}02125         \textcolor{keywordflow}{if}(!terms.size())}
\DoxyCodeLine{\Hypertarget{classMolecule_l02126}02126         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02127}02127             \textcolor{keywordflow}{if}(hydatis.size())}
\DoxyCodeLine{\Hypertarget{classMolecule_l02128}02128             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02129}02129                 cout << \textcolor{stringliteral}{"{}NOTE: Prune fragment generation will only remove hydrogen atoms now. No heavy-\/atom terminals to prune.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02130}02130                 \textcolor{keywordtype}{int} rhi=randomSelect(hydatis,devid);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02131}02131                 this-\/>\mbox{\hyperlink{classMolecule_a37f0c2acba7e35455f6128fff194e1a9}{dropSingleAtom}}(rhi);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02132}02132                 n-\/-\/;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02133}02133                 \textcolor{keywordflow}{if}(n>0) \mbox{\hyperlink{classMolecule_a6351ba55249d7e5659dfbb397dd0e069}{makePruneFragment}}(n,devid);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02134}02134                 \textcolor{keywordflow}{else} this-\/>\mbox{\hyperlink{classMolecule_a72616aa9d293190a9a0372a735f76966}{dumpMol}}(\textcolor{stringliteral}{"{}prunefrag.pdb"{}});}
\DoxyCodeLine{\Hypertarget{classMolecule_l02135}02135                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02136}02136             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02137}02137             \textcolor{keywordflow}{else} \{cout << \textcolor{stringliteral}{"{}WARN: Prune fragment generation failed. No terminals to prune. Stopping.\(\backslash\)n"{}}; \mbox{\hyperlink{classMolecule_a728fa63d31ed43876593086571e82cf6}{describeStructure}}(); \textcolor{keywordflow}{return};\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02138}02138         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02139}02139         cout << \textcolor{stringliteral}{"{}Terminals:\(\backslash\)n"{}}; \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<terms.size();i++) cout<<terms[i]<<\textcolor{stringliteral}{"{}:"{}}<< atoms[terms[i]]-\/>toString()<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02140}02140         \textcolor{keywordtype}{int} rS=(int)RNG::throwarandompoint(devid,0,terms.size());}
\DoxyCodeLine{\Hypertarget{classMolecule_l02141}02141         cout << \textcolor{stringliteral}{"{}Chose rS="{}}<<rS<<\textcolor{stringliteral}{"{} i.e. "{}}<<terms[rS]<<\textcolor{stringliteral}{"{}:"{}}<<atoms[terms[rS]]-\/>toString()<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02142}02142         std::vector<int> erasure(1,terms[rS]); \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keywordtype}{int}\& hai : hydats[rS]) erasure.push\_back(hai);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02143}02143         \textcolor{keywordtype}{int} i=-\/1;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02144}02144         \textcolor{keywordflow}{for}(i=0;i<bonds[termconns[rS]].size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02145}02145         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02146}02146             \textcolor{keywordflow}{if}(bonds[termconns[rS]][i]==terms[rS]) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02147}02147         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02148}02148         cout << \textcolor{stringliteral}{"{}Using bonds of "{}}<<termconns[rS]<<\textcolor{stringliteral}{"{}:"{}}<<atoms[termconns[rS]]-\/>toString()<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02149}02149         \textcolor{keywordflow}{if}(i>=bonds[termconns[rS]].size()) cout << \textcolor{stringliteral}{"{}Failed to find bond for "{}}<<terms[rS]<<\textcolor{stringliteral}{"{} in: "{}}<<bonds[termconns[rS]]<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02150}02150         cout << terms[rS] << \textcolor{stringliteral}{"{}:"{}}<<atoms[terms[rS]]-\/>toString()<<\textcolor{stringliteral}{"{}\(\backslash\)t"{}}<<i<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l02151}02151         bonds[termconns[rS]].erase(bonds[termconns[rS]].begin()+i);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02152}02152         \textcolor{keywordflow}{if}(!atoms[termconns[rS]]-\/>seek\_valency()) freeatoms.push\_back(atoms[termconns[rS]]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02153}02153         atoms[termconns[rS]]-\/>setValency(atoms[termconns[rS]]-\/>seek\_valency()+1);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02154}02154         \mbox{\hyperlink{classMolecule_ab9512050a395e0ebb8fbba92f0a91222}{HC}}-\/=hydats[rS].size();}
\DoxyCodeLine{\Hypertarget{classMolecule_l02155}02155         \textcolor{keywordflow}{if}(VARIEDCOUNT \&\& VCLIST-\/>\mbox{\hyperlink{classCategory_a3ffa41a593852318c167862171166f1b}{contains}}(atoms[terms[rS]])) HAC-\/-\/;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02156}02156         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<erasure.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02157}02157         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02158}02158             \mbox{\hyperlink{classMolecule_adebb2c740099c5db4f14137bb1609877}{myBE}}-\/=atoms[erasure[i]]-\/>getEnergyContribution();}
\DoxyCodeLine{\Hypertarget{classMolecule_l02159}02159             \mbox{\hyperlink{classMolecule_a6647358091d946bb02dbcf3ce35b7d5e}{myHBE}}-\/=atoms[erasure[i]]-\/>getHotspotEnergyContribution();}
\DoxyCodeLine{\Hypertarget{classMolecule_l02160}02160             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} deli=0;deli<freeatoms.size();deli++) \{\textcolor{keywordflow}{if}(freeatoms[deli]==atoms[erasure[i]]) \{freeatoms.erase(freeatoms.begin()+deli);\textcolor{keywordflow}{break};\}\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02161}02161             \textcolor{keyword}{delete} atoms[erasure[i]];}
\DoxyCodeLine{\Hypertarget{classMolecule_l02162}02162             atoms.erase(atoms.begin()+erasure[i]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02163}02163             bonds.erase(bonds.begin()+erasure[i]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02164}02164             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} p=i+1;p<erasure.size();p++) \{\textcolor{keywordflow}{if}(erasure[p]>erasure[i]) erasure[p]-\/-\/;\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02165}02165             \textcolor{keywordflow}{for}(std::vector<int>\& bv : bonds)}
\DoxyCodeLine{\Hypertarget{classMolecule_l02166}02166             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l02167}02167                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<bv.size();j++) \{\textcolor{keywordflow}{if}(bv[j]>erasure[i]) bv[j]-\/-\/;\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02168}02168             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02169}02169         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l02170}02170         \mbox{\hyperlink{classMolecule_a728fa63d31ed43876593086571e82cf6}{describeStructure}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l02171}02171         n-\/-\/;}
\DoxyCodeLine{\Hypertarget{classMolecule_l02172}02172         \textcolor{keywordflow}{if}(n>0) \mbox{\hyperlink{classMolecule_a6351ba55249d7e5659dfbb397dd0e069}{makePruneFragment}}(n);}
\DoxyCodeLine{\Hypertarget{classMolecule_l02173}02173         \textcolor{keywordflow}{else} this-\/>\mbox{\hyperlink{classMolecule_a72616aa9d293190a9a0372a735f76966}{dumpMol}}(\textcolor{stringliteral}{"{}prunefrag.pdb"{}});}
\DoxyCodeLine{\Hypertarget{classMolecule_l02174}02174     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_abfd8b7d4b46f69a9675e2fcac4397d19}\label{classMolecule_abfd8b7d4b46f69a9675e2fcac4397d19}} 
\index{Molecule@{Molecule}!markCyclizedAtoms@{markCyclizedAtoms}}
\index{markCyclizedAtoms@{markCyclizedAtoms}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{markCyclizedAtoms()}{markCyclizedAtoms()}}
{\footnotesize\ttfamily void Molecule\+::mark\+Cyclized\+Atoms (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Mark the atoms which are cyclized. 

This sets the \char`\"{}cyclized\char`\"{} flag for the atoms which have formed cycles to \char`\"{}\+True\char`\"{} 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00842}{842}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l00843}00843     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00844}00844         std::vector<int> traced;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00845}00845         \textcolor{keywordtype}{int} stI=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00846}00846         \textcolor{keywordflow}{while}(bonds[stI].size()<=1)}
\DoxyCodeLine{\Hypertarget{classMolecule_l00847}00847         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00848}00848             stI++;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00849}00849             \textcolor{keywordflow}{if}(stI>=bonds.size()) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00850}00850         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l00851}00851         \textcolor{keywordflow}{if}(stI>=bonds.size()) \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{classMolecule_l00852}00852         std::vector<int> travpath;}
\DoxyCodeLine{\Hypertarget{classMolecule_l00853}00853         traverseMarkCyclicAtoms(stI,travpath);}
\DoxyCodeLine{\Hypertarget{classMolecule_l00854}00854     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_ac178106e85c4a667d2c7faa57765d0fb}\label{classMolecule_ac178106e85c4a667d2c7faa57765d0fb}} 
\index{Molecule@{Molecule}!miniRollback@{miniRollback}}
\index{miniRollback@{miniRollback}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{miniRollback()}{miniRollback()}}
{\footnotesize\ttfamily void Molecule\+::mini\+Rollback (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classForceField}{Force\+Field}} \&}]{ff }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

\begin{DoxyRefDesc}{Deprecated}
\item[\mbox{\hyperlink{deprecated__deprecated000044}{Deprecated}}]This method is not safe to use. \end{DoxyRefDesc}


\begin{DoxyRefDesc}{Deprecated}
\item[\mbox{\hyperlink{deprecated__deprecated000045}{Deprecated}}]Rollback partially (only remove those atom types which are unsatisfied). \end{DoxyRefDesc}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01033}{1033}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01034}01034   \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01035}01035     cout << atoms.size() << \textcolor{stringliteral}{"{} in the beginning\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01036}01036     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : oldatoms)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01037}01037         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01038}01038             cout << a-\/>toString() << \textcolor{stringliteral}{"{},"{}}; cout << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01039}01039         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01040}01040     std::vector<Atom*> newatoms;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01041}01041     std::vector<std::vector<int>> newbonds;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01042}01042     std::vector<std::pair<Atom*,std::vector<Atom*>>> bonddata;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01043}01043     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : atoms) \{bonddata.push\_back(make\_pair(a,\mbox{\hyperlink{classMolecule_aef77043ab98f1008a15a1e52d85b827e}{getBondedAtoms}}(a)));\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01044}01044     cout << \textcolor{stringliteral}{"{}Bond data loaded\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01045}01045     std::vector<Atom*> waste;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01046}01046     \textcolor{keywordtype}{bool} passed=\textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01047}01047     \textcolor{keywordflow}{while}(\textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{classMolecule_l01048}01048     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01049}01049       cout << \textcolor{stringliteral}{"{}Loop: "{}}<<atoms.size() << \textcolor{stringliteral}{"{} atoms\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01050}01050       newatoms=std::vector<Atom*>();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01051}01051       newbonds=std::vector<std::vector<int>>();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01052}01052       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01053}01053       \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01054}01054         \textcolor{keywordflow}{if}(contains(oldatoms,atoms[i]) || ff.\mbox{\hyperlink{classForceField_a365a885eb6f7bc1b154ac2e3c1a0e71e}{isSatisfied}}(atoms[i],\mbox{\hyperlink{classMolecule_aef77043ab98f1008a15a1e52d85b827e}{getBondedAtoms}}(atoms[i])))}
\DoxyCodeLine{\Hypertarget{classMolecule_l01055}01055         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01056}01056           newatoms.push\_back(atoms[i]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01057}01057           newbonds.push\_back(std::vector<int>());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01058}01058         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01059}01059         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01060}01060         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01061}01061           waste.push\_back(atoms[i]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01062}01062           cout << atoms[i]-\/>toString()<<\textcolor{stringliteral}{"{} connected to:\(\backslash\)t"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01063}01063           \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<bonds[i].size();j++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01064}01064                     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01065}01065                         cout <<atoms[bonds[i][j]]-\/>toString();cout<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01066}01066                     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01067}01067         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01068}01068       \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01069}01069       \textcolor{keywordflow}{if}(newatoms.size()==atoms.size()) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01070}01070       cout << \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)Loop: "{}}<<newatoms.size()<< \textcolor{stringliteral}{"{} atoms\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01071}01071       \textcolor{keywordtype}{int} K=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01072}01072       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01073}01073       \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01074}01074         \textcolor{keywordflow}{if}(!contains(newatoms,atoms[i])) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01075}01075         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j : bonds[i]) \{\textcolor{keywordflow}{if}(contains(newatoms,atoms[j])) newbonds[K].push\_back(j);\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01076}01076         K++;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01077}01077       \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01078}01078       atoms=newatoms;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01079}01079       bonds=newbonds;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01080}01080     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01081}01081     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : waste)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01082}01082     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01083}01083       \textcolor{comment}{//if(a) cout << "{}Deleting: "{}<< a-\/>toString()<<"{}\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01084}01084       \textcolor{keyword}{delete} a;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01085}01085     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01086}01086     cout << \textcolor{stringliteral}{"{}Atoms fixed \(\backslash\)tand\(\backslash\)t"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01087}01087     \textcolor{comment}{/*for(int i=0;i<atoms.size();i++) newbonds.push\_back(std::vector<int>());}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01088}01088 \textcolor{comment}{    for(int i=0;i<atoms.size();i++)}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01089}01089 \textcolor{comment}{    \{}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01090}01090 \textcolor{comment}{      for(int j=i+1;j<atoms.size();j++)}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01091}01091 \textcolor{comment}{      \{}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01092}01092 \textcolor{comment}{        if(contains(findByKey(bonddata,atoms[i]),atoms[j])) newbonds[i].push\_back(j);}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01093}01093 \textcolor{comment}{        if(contains(findByKey(bonddata,atoms[j]),atoms[i])) newbonds[j].push\_back(i);}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01094}01094 \textcolor{comment}{      \}}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01095}01095 \textcolor{comment}{    \}}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01096}01096 \textcolor{comment}{    bonds=newbonds;*/}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01097}01097     cout << \textcolor{stringliteral}{"{}Bonds assigned\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01098}01098     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01099}01099     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01100}01100       \textcolor{keywordflow}{if}(contains(oldatoms,atoms[i])) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01101}01101       \textcolor{keywordflow}{if}(!bonds[i].size())}
\DoxyCodeLine{\Hypertarget{classMolecule_l01102}01102       \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01103}01103         \textcolor{keyword}{delete} atoms[i];}
\DoxyCodeLine{\Hypertarget{classMolecule_l01104}01104         atoms.erase(atoms.begin()+i);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01105}01105         bonds.erase(bonds.begin()+i);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01106}01106         i-\/-\/;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01107}01107       \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01108}01108     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01109}01109     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++) atoms[i]-\/>setValency(atoms[i]-\/>getStandardValency()-\/bonds[i].size());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01110}01110     cout << \textcolor{stringliteral}{"{}Valencies set\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01111}01111     freeatoms=std::vector<Atom*>();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01112}01112     \mbox{\hyperlink{classMolecule_ab9512050a395e0ebb8fbba92f0a91222}{HC}}=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01113}01113         \textcolor{keywordflow}{if}(VARIEDCOUNT) HAC=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01114}01114     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : atoms)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01115}01115     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01116}01116       \textcolor{keywordflow}{if}(a-\/>canBond()) freeatoms.push\_back(a);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01117}01117       \textcolor{keywordflow}{if}(a-\/>isHydrogen()) \mbox{\hyperlink{classMolecule_ab9512050a395e0ebb8fbba92f0a91222}{HC}}++;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01118}01118             \textcolor{keywordflow}{if}(VARIEDCOUNT \&\& VCLIST-\/>\mbox{\hyperlink{classCategory_a3ffa41a593852318c167862171166f1b}{contains}}(a)) HAC++;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01119}01119     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01120}01120     cout << atoms.size() << \textcolor{stringliteral}{"{} atoms left\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01121}01121     \textcolor{comment}{//for(Atom* a : atoms) cout << a-\/>toString() << "{},"{}; cout << "{}\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01122}01122     \mbox{\hyperlink{classMolecule_acf710157d0a2da0d5d7bab8d658c39be}{trialmode}}=\textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01123}01123   \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a3457de95adc23d040a6545a8b783dd32}\label{classMolecule_a3457de95adc23d040a6545a8b783dd32}} 
\index{Molecule@{Molecule}!quickLocate@{quickLocate}}
\index{quickLocate@{quickLocate}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{quickLocate()}{quickLocate()}}
{\footnotesize\ttfamily std\+::vector$<$ int $>$ Molecule\+::quick\+Locate (\begin{DoxyParamCaption}\item[{int}]{latind,  }\item[{int}]{startatin,  }\item[{std\+::vector$<$ int $>$}]{passed }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Locate the closest path joining the atoms at the two indices without passing through the given list of atoms (Used to find path when cyclization occurs) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em latind} & Target atom index \\
\hline
\mbox{\texttt{ in}}  & {\em startatin} & Starting atom index \\
\hline
\mbox{\texttt{ in}}  & {\em passed} & vector of atoms which must not be in the path. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01576}{1576}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01577}01577   \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01578}01578     \textcolor{comment}{//std::vector<int> passed=passin;}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01579}01579     passed.push\_back(startatin);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01580}01580     \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keywordtype}{int}\& j : bonds[startatin])}
\DoxyCodeLine{\Hypertarget{classMolecule_l01581}01581     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01582}01582       \textcolor{keywordflow}{if}(j==latind) \textcolor{keywordflow}{return} passed;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01583}01583       \textcolor{keywordflow}{if}(contains(passed,j)) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01584}01584       \textcolor{keywordflow}{try} \{\textcolor{keywordflow}{return} \mbox{\hyperlink{classMolecule_a3457de95adc23d040a6545a8b783dd32}{quickLocate}}(latind,j,passed);\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01585}01585       \textcolor{keywordflow}{catch}(\mbox{\hyperlink{classNoPathPossibleException}{NoPathPossibleException}} ex) \{\textcolor{keywordflow}{continue};\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01586}01586     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01587}01587     \textcolor{keywordflow}{throw} \mbox{\hyperlink{classNoPathPossibleException}{NoPathPossibleException}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01588}01588   \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_ab0beb758c9101529938d5fdab3ed3f86}\label{classMolecule_ab0beb758c9101529938d5fdab3ed3f86}} 
\index{Molecule@{Molecule}!reduce@{reduce}}
\index{reduce@{reduce}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{reduce()}{reduce()}}
{\footnotesize\ttfamily bool Molecule\+::reduce (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classSystem}{System}} \&}]{s,  }\item[{int}]{trials = {\ttfamily 15},  }\item[{bool}]{forced = {\ttfamily false},  }\item[{int}]{devid = {\ttfamily 0} }\end{DoxyParamCaption})}



Complete all valencies by adding hydrogens. 

This functions adds hydrogen atoms to all the available valencies of each atom in the molecule. Geometric checks are mild and in the interest of time, exact position of hydrogen atoms are not calculated, which may lead to two overlapping hydrogen atoms from the same parent atom.~\newline
The overlaps can easily be addressed by a simple steepest descent optimization in any molecule viewer (such as Chimera)~\newline
The energy contribution of non-\/polar hydrogen atoms is very low. If you think certain hydrogen atoms have significant contribution, ensure that they are properly defined in the \textquotesingle{}definitions\textquotesingle{} file. See algorithm PDF for more details. 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l04575}{4575}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l04576}04576 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04577}04577     cout << \textcolor{stringliteral}{"{}Reduction begins: "{}}<<((forced)?\textcolor{stringliteral}{"{}forced"{}}:\textcolor{stringliteral}{"{}unforced"{}})<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04578}04578     \mbox{\hyperlink{classAtom}{Atom}} *ha=s.\mbox{\hyperlink{classSystem_a9e485ee26141788c9f971a47703bb4a0}{ff}}-\/>\mbox{\hyperlink{classForceField_a388e3f80e59286f915299e61341d078f}{getAtom}}(\textcolor{stringliteral}{"{}H"{}}),*nxt,*tmp,*aa;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04579}04579     \textcolor{keywordtype}{double} div,ebe,ehbe;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04580}04580     \textcolor{keywordtype}{int} h=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04581}04581     \mbox{\hyperlink{classMolecule}{Molecule}}* p = s.\mbox{\hyperlink{classSystem_ad9f7387804eeb148d60d439e9a8bd9b2}{getProteinMolecule}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l04582}04582     \textcolor{keywordtype}{int} sz=atoms.size(); \textcolor{keywordflow}{if}(sz<=2) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04583}04583     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} I=0;I<sz;I++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l04584}04584     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04585}04585         \textcolor{keywordflow}{while}(atoms[I] \&\& atoms[I]-\/>seek\_valency())}
\DoxyCodeLine{\Hypertarget{classMolecule_l04586}04586         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04587}04587             \textcolor{comment}{//cout << atoms[I]-\/>toString() << "{} to be reduced\(\backslash\)t"{};}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04588}04588             \textcolor{keywordtype}{double} blen=0.09;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04589}04589             \mbox{\hyperlink{classAtom}{Atom}}* ta=(forced)?s.\mbox{\hyperlink{classSystem_a9e485ee26141788c9f971a47703bb4a0}{ff}}-\/>\mbox{\hyperlink{classForceField_aab183018c1dce0c5c93e1dd36eccd57e}{selectRandomBondableAtomTerminal}}(atoms[I],ha):s.\mbox{\hyperlink{classSystem_a9e485ee26141788c9f971a47703bb4a0}{ff}}-\/>selectAtomByRule(atoms[I],this-\/>\mbox{\hyperlink{classMolecule_aef77043ab98f1008a15a1e52d85b827e}{getBondedAtoms}}(atoms[I]),ha);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04590}04590             \textcolor{keywordflow}{if}(!ta || !ta-\/>\mbox{\hyperlink{classAtom_a99ed78f1b94d694b0f3fac609fd92934}{isHydrogen}}())}
\DoxyCodeLine{\Hypertarget{classMolecule_l04591}04591             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04592}04592                 \textcolor{keywordflow}{if}(ta) \{cout << \textcolor{stringliteral}{"{}In reduce: No hydrogen atom to bond to: "{}}<<atoms[I]-\/>toString() << \textcolor{stringliteral}{"{}. Will switch to other terminals\(\backslash\)n"{}}; blen=s.\mbox{\hyperlink{classSystem_a9e485ee26141788c9f971a47703bb4a0}{ff}}-\/>\mbox{\hyperlink{classForceField_ab19cd0db1e679daf537e06ef3308f721}{getBondLength}}(atoms[I],ta,\textcolor{keyword}{true});\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04593}04593                 \textcolor{keywordflow}{else} \{ cout << \textcolor{stringliteral}{"{}In reduce: No terminal atom to bond to: "{}}<<atoms[I]-\/>toString() << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}; \textcolor{keywordflow}{break};\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04594}04594             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04595}04595             \mbox{\hyperlink{classAtom}{Atom}} *nha=\textcolor{keyword}{nullptr},*eca1=\textcolor{keyword}{nullptr},*eca2=\textcolor{keyword}{nullptr},*dia=\textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04596}04596             \textcolor{keywordtype}{int} nhai=-\/1,eca1i=-\/1,eca2i=-\/1,diai=-\/1;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04597}04597             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<bonds[I].size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l04598}04598             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04599}04599                 \textcolor{keywordflow}{if}(bonds[bonds[I][i]].size()<=1) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04600}04600                 nha=atoms[bonds[I][i]]; nhai=bonds[I][i]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04601}04601             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04602}04602             \textcolor{keywordflow}{if}(!nha) \textcolor{comment}{//If there is no "{}heavy"{} atom connected (rare), choose a random hydrogen atom. If even that is not present, reject reduction altogether for this atom (Lone atom reduction is not allowed)}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04603}04603             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04604}04604                 \textcolor{keywordflow}{if}(!bonds[I].size()) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04605}04605                 nha=atoms[bonds[I][0]];}
\DoxyCodeLine{\Hypertarget{classMolecule_l04606}04606                 nhai=bonds[I][0];}
\DoxyCodeLine{\Hypertarget{classMolecule_l04607}04607             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04608}04608             \textcolor{comment}{//cout << "{}Using: "{}<<nha-\/>toString()<<"{} as the first neighbour\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04609}04609             Eigen::Vector3d base=atoms[I]-\/>bondVectorTo(nha);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04610}04610             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<bonds[I].size();i++) \textcolor{comment}{//Find 2 more atoms which are bonded to reduction target}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04611}04611             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04612}04612                 \textcolor{keywordflow}{if}(bonds[I][i]==nhai) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04613}04613                 \textcolor{keywordflow}{if}(!eca1) \{eca1i=bonds[I][i]; eca1=atoms[eca1i];\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04614}04614                 \textcolor{keywordflow}{else} \{eca2i=bonds[I][i]; eca2=atoms[eca2i]; \textcolor{keywordflow}{break};\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04615}04615             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04616}04616             \textcolor{comment}{/*cout << "{}Looking for other neighbours: "{}<<(eca1!=nullptr)<<"{} and "{}<<(eca2!=nullptr);}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04617}04617 \textcolor{comment}{            if(eca1) cout <<"{}\(\backslash\)n"{}<< eca1-\/>toString() << "{}\(\backslash\)t"{};}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04618}04618 \textcolor{comment}{            if(eca2) cout << eca2-\/>toString();}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04619}04619 \textcolor{comment}{            cout << "{}\(\backslash\)n"{};*/}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04620}04620             Eigen::Vector3d ref; \textcolor{keywordtype}{double} dih=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04621}04621             \textcolor{keywordflow}{if}(bonds[nhai].size()<=1) ref=Eigen::Vector3d(0,0,1);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04622}04622             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04623}04623             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04624}04624                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<bonds[nhai].size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l04625}04625                 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04626}04626                     \textcolor{keywordflow}{if}(bonds[nhai][i]==I) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04627}04627                     diai=bonds[nhai][i];}
\DoxyCodeLine{\Hypertarget{classMolecule_l04628}04628                     dia=atoms[diai];}
\DoxyCodeLine{\Hypertarget{classMolecule_l04629}04629                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04630}04630                 \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04631}04631                 ref=nha-\/>\mbox{\hyperlink{classAtom_a40e4a43205a24f5e64ea0d27994a3efb}{bondVectorTo}}(dia);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04632}04632                 \textcolor{keywordflow}{if}(eca1 \&\& dia) \{dih=\mbox{\hyperlink{namespacechemtools_af1bacba692469862a68fec24a291334e}{chemtools::getDihedral}}(eca1,atoms[I],nha,dia); \} \textcolor{comment}{// cout << "{}Picked dih="{}<<dih<<"{} from calculation "{}<<eca1-\/>getPosition().transpose()<<"{}, "{}<<atoms[I]-\/>getPosition().transpose()<<"{}, "{}<<nha-\/>getPosition().transpose()<<"{} and "{}<<dia-\/>getPosition().transpose()<<"{}\(\backslash\)n"{};\}}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04633}04633             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04634}04634             \textcolor{keywordtype}{int} m=1;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04635}04635             \textcolor{keywordflow}{switch}(atoms[I]-\/>getStandardValency())}
\DoxyCodeLine{\Hypertarget{classMolecule_l04636}04636             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04637}04637                 \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{classMolecule_l04638}04638                     dih+=(2*PI)/3;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04639}04639                     m=3;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04640}04640                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04641}04641                 \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{classMolecule_l04642}04642                     dih+=PI;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04643}04643                     m=2;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04644}04644                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04645}04645                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{classMolecule_l04646}04646                     m=1;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04647}04647                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04648}04648             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04649}04649             \textcolor{comment}{//cout <<"{}Under dihedral data: "{}<<dih<<"{} with multiplicity "{}<<m<<"{}\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04650}04650             \textcolor{comment}{//cout <<"{}Under getArcPositions: "{}<<base.transpose()<<"{}\(\backslash\)t"{}<<ref.transpose()<<"{}:\(\backslash\)t"{}<<blen<<"{},"{}<<((atoms[I]-\/>getStandardValency()==4)?109.5:120)*(PI/180.0)<<"{},"{}<<ForceField::expandMultiplicity(dih,m)<<"{}\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04651}04651             std::vector<Eigen::Vector3d> tposes=\mbox{\hyperlink{namespacequickgeom_af60aae27d8f525f83c7088e81fcda69f}{quickgeom::getArcPositions}}(base,ref,blen,((atoms[I]-\/>getStandardValency()==4)?109.5:120)*(PI/180.0),\mbox{\hyperlink{classForceField_a0b53370d39b444980839b0b6181ee0cf}{ForceField::expandMultiplicity}}(dih,m),32,devid);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04652}04652             \textcolor{keywordtype}{bool} acc=\textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04653}04653             Eigen::Vector3d fpos(0,0,0);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04654}04654             \textcolor{keywordtype}{double} angs=0,nangs;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04655}04655             \textcolor{keywordflow}{for}(Eigen::Vector3d\& v : tposes)}
\DoxyCodeLine{\Hypertarget{classMolecule_l04656}04656             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04657}04657                 ta-\/>\mbox{\hyperlink{classAtom_a34fc2756d0f817a9ee6cf91c797d8bcc}{setPosition}}(atoms[I]-\/>getPosition()+v);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04658}04658                 acc=\textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04659}04659                 nangs=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04660}04660                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<bonds[I].size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l04661}04661                 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04662}04662                     \textcolor{keywordflow}{if}(atoms[bonds[I][i]]-\/>distanceFrom(ta)<RCUT/1.5) \{acc=\textcolor{keyword}{false}; \textcolor{keywordflow}{break};\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04663}04663                     nangs+=\mbox{\hyperlink{namespacechemtools_a330bbc0a28d98a7b8d22150d8e590050}{chemtools::getAngle}}(ta,atoms[I],atoms[bonds[I][i]]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04664}04664                     \textcolor{comment}{//cout << chemtools::getAngle(ta,atoms[I],atoms[bonds[I][i]]) <<"{} for angle: "{}<<ta-\/>toString()<<"{}*-\/"{}<<atoms[I]-\/>toString()<<"{}-\/"{}<<atoms[bonds[I][i]]-\/>toString()<<"{},\(\backslash\)t"{};}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04665}04665                 \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04666}04666                 \textcolor{comment}{//cout << "{} as nangs against "{}<<angs<<"{}\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04667}04667                 \textcolor{keywordflow}{if}(!acc || nangs<angs) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04668}04668                 angs=nangs;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04669}04669                 fpos=ta-\/>\mbox{\hyperlink{classAtom_a73b92d7b24611f250127856e3b52ed31}{getPosition}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l04670}04670             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04671}04671             \textcolor{keywordflow}{if}(!angs) \{cout << \textcolor{stringliteral}{"{}Failed to reduce: "{}}<<atoms[I]-\/>toString()<<\textcolor{stringliteral}{"{} with std. valency: "{}}+to\_string(atoms[I]-\/>getStandardValency())+\textcolor{stringliteral}{"{}\(\backslash\)n"{}}; \textcolor{keywordflow}{break};\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04672}04672             ta-\/>\mbox{\hyperlink{classAtom_a34fc2756d0f817a9ee6cf91c797d8bcc}{setPosition}}(fpos);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04673}04673             \mbox{\hyperlink{classMolecule_aebc4ac8f4a68e24dbb0720402798ca4e}{bondAtom}}(ta,atoms[I]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04674}04674             \textcolor{keywordflow}{if}(p)}
\DoxyCodeLine{\Hypertarget{classMolecule_l04675}04675             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04676}04676                 \textcolor{keyword}{const} \textcolor{keyword}{auto}\& ptr=((\mbox{\hyperlink{classProtein}{Protein}}*)p)-\/>calculateNonBondingEnergy(ta);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04677}04677                 ebe=get<0>(ptr);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04678}04678                 ehbe=get<1>(ptr);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04679}04679                 \mbox{\hyperlink{classMolecule_adebb2c740099c5db4f14137bb1609877}{myBE}}+=(ta-\/>\mbox{\hyperlink{classAtom_a6054acec965e008ad281764b7b4e5f5d}{setEnergyContribution}}(ebe));}
\DoxyCodeLine{\Hypertarget{classMolecule_l04680}04680                 \mbox{\hyperlink{classMolecule_a6647358091d946bb02dbcf3ce35b7d5e}{myHBE}}+=(ta-\/>\mbox{\hyperlink{classAtom_a6e6ad3000e35fb4f424f9e82ac414311}{setHotspotEnergyContribution}}(ehbe));}
\DoxyCodeLine{\Hypertarget{classMolecule_l04681}04681             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04682}04682             \textcolor{keywordflow}{if}(!QUIET) cout << \textcolor{stringliteral}{"{}Added a hydrogen atom. Left: "{}}<<atoms[I]-\/>seek\_valency()<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04683}04683             h++;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04684}04684         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04685}04685     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04686}04686     \textcolor{keywordflow}{if}(!QUIET) cout << h << \textcolor{stringliteral}{"{} hydrogen atoms added.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04687}04687     \textcolor{keywordflow}{if}(ha) \textcolor{keyword}{delete} ha;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04688}04688     cout << \textcolor{stringliteral}{"{}Reduction ends: "{}}<<((forced)?\textcolor{stringliteral}{"{}forced"{}}:\textcolor{stringliteral}{"{}unforced"{}})<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04689}04689     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : atoms)}
\DoxyCodeLine{\Hypertarget{classMolecule_l04690}04690     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04691}04691         \textcolor{keywordflow}{if}(a-\/>getPosition()[0]!=a-\/>getPosition()[0])}
\DoxyCodeLine{\Hypertarget{classMolecule_l04692}04692         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04693}04693             cout << \textcolor{stringliteral}{"{}Bad Hydrogen Atom Placement\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04694}04694             this-\/>\mbox{\hyperlink{classMolecule_a72616aa9d293190a9a0372a735f76966}{dumpMol}}(\textcolor{stringliteral}{"{}badred.pdb"{}},s.\mbox{\hyperlink{classSystem_a9e485ee26141788c9f971a47703bb4a0}{ff}});}
\DoxyCodeLine{\Hypertarget{classMolecule_l04695}04695             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classNoPositionAvailableException}{NoPositionAvailableException}}(); \textcolor{comment}{//Might remove this later on}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04696}04696         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04697}04697     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04698}04698     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04699}04699 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_af86a46bfed0f76534eb11a2016371f13}\label{classMolecule_af86a46bfed0f76534eb11a2016371f13}} 
\index{Molecule@{Molecule}!rollback@{rollback}}
\index{rollback@{rollback}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{rollback()}{rollback()}}
{\footnotesize\ttfamily void Molecule\+::rollback (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classSystem}{System}} \&}]{s }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Restore original molecule. All changes from the last call of \mbox{\hyperlink{classMolecule_ab89456b4f7e16d7cbf6025f0389f5d10}{start\+Trials()}} will be deleted. 

This method marks the end of \char`\"{}trial mode\char`\"{}. All changes are reverted back and trial mode is switched off.~\newline
See Also\+: \mbox{\hyperlink{classMolecule_a04b2de48ba4c22b9bef6ca8aec90c1f9}{commit()}} 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l04092}{4092}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l04093}04093 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04094}04094   \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : atoms)}
\DoxyCodeLine{\Hypertarget{classMolecule_l04095}04095     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04096}04096         \textcolor{keywordflow}{if}(!contains(oldatoms,a))}
\DoxyCodeLine{\Hypertarget{classMolecule_l04097}04097         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04098}04098             \textcolor{keywordflow}{if}(!QUIET) cout << \textcolor{stringliteral}{"{}Deleting: "{}}<<a-\/>toString()<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04099}04099             \textcolor{keyword}{delete} a;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04100}04100         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04101}04101     \} \textcolor{comment}{//Freeing memory}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04102}04102   atoms=oldatoms;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04103}04103   bonds=oldbonds;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04104}04104   freeatoms=oldfreeatoms;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04105}04105   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++) atoms[i]-\/>setValency(valencies[i]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04106}04106     \mbox{\hyperlink{classMolecule_adebb2c740099c5db4f14137bb1609877}{myBE}}=oldbe; \mbox{\hyperlink{classMolecule_a6647358091d946bb02dbcf3ce35b7d5e}{myHBE}}=oldhbe;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04107}04107     \mbox{\hyperlink{classMolecule_a6b1f799908a9d52d7194d07ac6bb28d3}{errBE}}=olderrbe; \mbox{\hyperlink{classMolecule_a32075500340345439d0d4912e26fb44f}{errHBE}}=olderrhbe;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04108}04108     \mbox{\hyperlink{classMolecule_ab9512050a395e0ebb8fbba92f0a91222}{HC}}=oldHC;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04109}04109     \textcolor{keywordflow}{if}(VARIEDCOUNT) HAC=oldHAC;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04110}04110     cycles=oldcycles;}
\DoxyCodeLine{\Hypertarget{classMolecule_l04111}04111     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : atoms)}
\DoxyCodeLine{\Hypertarget{classMolecule_l04112}04112     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04113}04113         \textcolor{keywordflow}{if}(!a-\/>isCyclized() || a-\/>isCycleStatic()) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04114}04114         \textcolor{keywordtype}{bool} fnd=\textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04115}04115         \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\& cyc : cycles) \{\textcolor{keywordflow}{if}(contains(cyc,a)) \{fnd=\textcolor{keyword}{true}; \textcolor{keywordflow}{break};\}\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04116}04116         \textcolor{keywordflow}{if}(!fnd) a-\/>setCyclized(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{classMolecule_l04117}04117     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04118}04118   \textcolor{comment}{/*double hse=0;}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04119}04119 \textcolor{comment}{  for(Molecule* m : s.getMolecules())}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04120}04120 \textcolor{comment}{  \{}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04121}04121 \textcolor{comment}{    if(m-\/>type!=1) continue; //If not protein, ignore}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04122}04122 \textcolor{comment}{    myBE=((Protein*)m)-\/>calculateNonBondingEnergy(this);}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04123}04123 \textcolor{comment}{    hse+=((Protein*)m)-\/>getHotspotBindingEnergy();}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04124}04124 \textcolor{comment}{  \}}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04125}04125 \textcolor{comment}{  myHBE=hse;*/}}
\DoxyCodeLine{\Hypertarget{classMolecule_l04126}04126   \mbox{\hyperlink{classMolecule_acf710157d0a2da0d5d7bab8d658c39be}{trialmode}}=\textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{classMolecule_l04127}04127 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_afa6fbeecd0df2fb5a8026895ab57bc60}\label{classMolecule_afa6fbeecd0df2fb5a8026895ab57bc60}} 
\index{Molecule@{Molecule}!rotateDihedralTo@{rotateDihedralTo}}
\index{rotateDihedralTo@{rotateDihedralTo}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{rotateDihedralTo()}{rotateDihedralTo()}}
{\footnotesize\ttfamily bool Molecule\+::rotate\+Dihedral\+To (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classAtom}{Atom}} $\ast$}]{a1,  }\item[{\mbox{\hyperlink{classAtom}{Atom}} $\ast$}]{a2,  }\item[{\mbox{\hyperlink{classAtom}{Atom}} $\ast$}]{a3,  }\item[{\mbox{\hyperlink{classAtom}{Atom}} $\ast$}]{a4,  }\item[{double}]{dih }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Rotate the dihedral to set it to a particular value. 

Provided that the dihedral you have chosen is a bridge bond, the dihedral is rotated (via the smaller side of the dihedral) to match the given value.~\newline
 The algorithm malfunctions if the chosen bond is part of a cycle (i.\+e. not free to rotate). See \mbox{\hyperlink{classMolecule_a586d332662ebab7d9c3cdf667d39a901}{Molecule\+::get\+All\+Bridge\+Heads()}} to find bridge-\/head atoms to use for finding freely rotable dihedrals. 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01840}{1840}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01841}01841     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01842}01842         \textcolor{keywordtype}{int} i1=-\/1,i2=-\/1,i3=-\/1,i4=-\/1;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01843}01843         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01844}01844         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01845}01845             \textcolor{keywordflow}{if}(atoms[i]==a1) i1=i;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01846}01846             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(atoms[i]==a2) i2=i;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01847}01847             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(atoms[i]==a3) i3=i;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01848}01848             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(atoms[i]==a4) i4=i;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01849}01849         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01850}01850         \textcolor{keywordflow}{if}(i1>=0 \&\& i2>=0 \&\& i3>=0 \&\& i4>=0) \textcolor{keywordflow}{return} \mbox{\hyperlink{classMolecule_afa6fbeecd0df2fb5a8026895ab57bc60}{rotateDihedralTo}}(i1,i2,i3,i4,dih);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01851}01851         \textcolor{keywordflow}{else} \{cout << \textcolor{stringliteral}{"{}In rotateDihedralTo(): Atom chosen is not in given Molecule\(\backslash\)n"{}}; cout << i1<<\textcolor{stringliteral}{"{},"{}}<<i2<<\textcolor{stringliteral}{"{},"{}}<<i3<<\textcolor{stringliteral}{"{},"{}}<<i4<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}}; \textcolor{keywordflow}{throw} \mbox{\hyperlink{classAtomNotInMoleculeException}{AtomNotInMoleculeException}}();\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01852}01852     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_adbbc84419964e42f958f78219a92b556}\label{classMolecule_adbbc84419964e42f958f78219a92b556}} 
\index{Molecule@{Molecule}!rotateMolecule@{rotateMolecule}}
\index{rotateMolecule@{rotateMolecule}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{rotateMolecule()}{rotateMolecule()}}
{\footnotesize\ttfamily void Molecule\+::rotate\+Molecule (\begin{DoxyParamCaption}\item[{const Eigen\+::\+Vector3d \&}]{n,  }\item[{Eigen\+::\+Vector3d}]{com = {\ttfamily Eigen\+:\+:Vector3d(0,0,0)} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Rotate the molecule about a given vector by a given angle (in radians). The angle is given by the norm of the vector. 

The rotation is by default around the COM. However, you can choose another center, which will remain fixed during rotation.~\newline
 If the COM (i.\+e. centre for the rotation) is chosen to be an atom\textquotesingle{}s position, that atom remains in the same position (useful for rotating around pivotal atoms). 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01825}{1825}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01826}01826     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01827}01827         \textcolor{keywordflow}{if}(com(0)==0 \&\& com(1)==0 \&\& com(2)==0) com=this-\/>\mbox{\hyperlink{classMolecule_af4ee33c60073cc39d50f316576275a69}{getCentreOfMass}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01828}01828         \textcolor{keyword}{auto} rmat=\mbox{\hyperlink{namespacequickgeom_a0c722fa92ca4d7948501f81c1de9f17f}{quickgeom::getRotationMatrix}}(n/n.norm(),n.norm());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01829}01829         \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : atoms)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01830}01830         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01831}01831             Eigen::Vector3d r=a-\/>getPosition()-\/com;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01832}01832             r=rmat*r;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01833}01833             a-\/>setPosition(com+r);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01834}01834         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01835}01835     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_adc8c0ae7c7ce4f851344d9b4b6479602}\label{classMolecule_adc8c0ae7c7ce4f851344d9b4b6479602}} 
\index{Molecule@{Molecule}!samplegrow@{samplegrow}}
\index{samplegrow@{samplegrow}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{samplegrow()}{samplegrow()}}
{\footnotesize\ttfamily void Molecule\+::samplegrow (\begin{DoxyParamCaption}\item[{ostream \&}]{logfile,  }\item[{const \mbox{\hyperlink{classSystem}{System}} \&}]{s,  }\item[{int}]{n,  }\item[{int}]{trials = {\ttfamily 15},  }\item[{int}]{nupper = {\ttfamily 90},  }\item[{int}]{levellim = {\ttfamily LEVELLIMIT},  }\item[{bool}]{restr = {\ttfamily false},  }\item[{bool}]{superseed = {\ttfamily false},  }\item[{bool}]{reseed = {\ttfamily false},  }\item[{bool}]{deseed = {\ttfamily false},  }\item[{\mbox{\hyperlink{classMolecule}{Molecule}} $\ast$\&}]{common\+\_\+newroot = {\ttfamily NULLMOL},  }\item[{int}]{common\+\_\+seedlength = {\ttfamily 0},  }\item[{int}]{devid = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



The internal growth function which guided the molecule growth. 

This function takes in all the necessary parameters to grow one complete molecule. It is this method which is called multiple times by other functions such as generate\+Ligands(), quick\+Prune(), etc. to complete one generation.~\newline
 It grows one molecule to the given receptor (which must be part of the \mbox{\hyperlink{classSystem}{System}}), and also stores the interaction energy of the molecule in it. ~\newline
 Also, it is this function which starts (and ends) the trial mode. Refer to the algorithm flowchart for complete details of the growth algorithm. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em logfile} & The output stream to write the log to \\
\hline
\mbox{\texttt{ in}}  & {\em s} & The \mbox{\hyperlink{classSystem}{System}} within which this generation is placed. This provides the temperature for growth, and must also constain this molecule and the receptor. \\
\hline
\mbox{\texttt{ in}}  & {\em n} & The The minimum size upto which to continue growth. ~\newline
For other parameters, refer Protein\+::generate\+Ligands(const Force\+Field\&,int,int,const std\+::string\&,std\+::vector$<$\+Molecule$\ast$$>$,double,double,int,int,int,double,bool,bool,bool,bool,\+Molecule$\ast$,bool,int) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01379}{1379}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01380}01380   \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01381}01381 \textcolor{preprocessor}{        \#ifdef REALTIME}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01382}01382             this-\/>\mbox{\hyperlink{classMolecule_a72616aa9d293190a9a0372a735f76966}{dumpMol}}(\textcolor{stringliteral}{"{}seed.pdb"{}},s.\mbox{\hyperlink{classSystem_a9e485ee26141788c9f971a47703bb4a0}{ff}});}
\DoxyCodeLine{\Hypertarget{classMolecule_l01383}01383 \textcolor{preprocessor}{        \#endif}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01384}01384     \textcolor{keywordtype}{int} t=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01385}01385     cout << \textcolor{stringliteral}{"{}samplegrow(rigid) begins\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01386}01386     logfile << \textcolor{stringliteral}{"{}samplegrow(rigid) begins\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01387}01387     \textcolor{keywordtype}{bool} acc=\textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01388}01388     \mbox{\hyperlink{classAtom}{Atom}}* gP=\textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01389}01389     \textcolor{keywordflow}{while}(\mbox{\hyperlink{classMolecule_a4c6228c3225bd9571ba276841caa7c90}{getEffectiveSize}}()<n)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01390}01390     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01391}01391       acc=\textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01392}01392       \mbox{\hyperlink{classMolecule_ab89456b4f7e16d7cbf6025f0389f5d10}{startTrials}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01393}01393         \textcolor{keywordflow}{if}(t>trials)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01394}01394             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01395}01395                 cout << \textcolor{stringliteral}{"{}Too many failures: \(\backslash\)n"{}}; logfile << \textcolor{stringliteral}{"{}Too many failures: \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01396}01396                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01397}01397             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01398}01398             \textcolor{keywordflow}{if}(superseed \&\& common\_newroot \&\& freeatoms.size() \&\& this-\/>getEffectiveSize()==common\_newroot-\/>\mbox{\hyperlink{classMolecule_a4c6228c3225bd9571ba276841caa7c90}{getEffectiveSize}}()) gP=this-\/>freeatoms[freeatoms.size()-\/1];}
\DoxyCodeLine{\Hypertarget{classMolecule_l01399}01399         \textcolor{keywordflow}{else} gP=\mbox{\hyperlink{classMolecule_a50d2a2068fcda1e9676eb5d8e3aac9f2}{getRandomBondableAtom}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01400}01400       \textcolor{keywordflow}{if}(!gP)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01401}01401             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01402}01402                 cout << \textcolor{stringliteral}{"{}Out of valencies\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01403}01403                 logfile << \textcolor{stringliteral}{"{}Ended: Out of valencies\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01404}01404                 \mbox{\hyperlink{classMolecule_a04b2de48ba4c22b9bef6ca8aec90c1f9}{commit}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01405}01405                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01406}01406             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01407}01407       cout << \textcolor{stringliteral}{"{}New begin: "{}}; \mbox{\hyperlink{classMolecule_a728fa63d31ed43876593086571e82cf6}{describeStructure}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01408}01408       \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMolecule_a2c2caa1e42988fec83ed9101383c2f19}{completeAttempt}}(logfile,s,gP,ATTEMPTTRIALS,nupper,0,levellim,restr,superseed,reseed,deseed,common\_newroot,common\_seedlength,devid))}
\DoxyCodeLine{\Hypertarget{classMolecule_l01409}01409             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01410}01410                 cout << \textcolor{stringliteral}{"{}Commiting: "{}}<<gP-\/>\mbox{\hyperlink{classAtom_a189def3b8bade8507d49cfd7de881178}{toString}}()<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01411}01411                 \mbox{\hyperlink{classMolecule_a04b2de48ba4c22b9bef6ca8aec90c1f9}{commit}}(); t=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01412}01412             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01413}01413       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01414}01414       \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01415}01415         cout << \textcolor{stringliteral}{"{}Rollback\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01416}01416         \textcolor{comment}{//this-\/>dumpMol("{}pre\_rolledback.pdb"{});}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01417}01417         \mbox{\hyperlink{classMolecule_af86a46bfed0f76534eb11a2016371f13}{rollback}}(s);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01418}01418 \textcolor{preprocessor}{                \#ifdef REALTIME}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01419}01419             this-\/>\mbox{\hyperlink{classMolecule_a72616aa9d293190a9a0372a735f76966}{dumpMol}}(\textcolor{stringliteral}{"{}rolledback.pdb"{}},s.\mbox{\hyperlink{classSystem_a9e485ee26141788c9f971a47703bb4a0}{ff}});}
\DoxyCodeLine{\Hypertarget{classMolecule_l01420}01420                     this-\/>\mbox{\hyperlink{classMolecule_a72616aa9d293190a9a0372a735f76966}{dumpMol}}(\textcolor{stringliteral}{"{}realtime.pdb"{}},s.\mbox{\hyperlink{classSystem_a9e485ee26141788c9f971a47703bb4a0}{ff}});}
\DoxyCodeLine{\Hypertarget{classMolecule_l01421}01421                     usleep(REALTIME*2);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01422}01422 \textcolor{preprocessor}{                \#endif}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01423}01423         t++;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01424}01424         cout << \textcolor{stringliteral}{"{}Rolled back: "{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01425}01425         logfile << \textcolor{stringliteral}{"{}Rolled back: "{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01426}01426         this-\/>\mbox{\hyperlink{classMolecule_a728fa63d31ed43876593086571e82cf6}{describeStructure}}(logfile);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01427}01427       \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01428}01428     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01429}01429         \textcolor{keywordflow}{if}(this-\/>\mbox{\hyperlink{classMolecule_a4c6228c3225bd9571ba276841caa7c90}{getEffectiveSize}}()<n) \textcolor{keywordflow}{return}; \textcolor{comment}{//Don't waste optimization time on "{}small"{} molecules which will be rejected mostly anyway.}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01430}01430     \textcolor{comment}{//this-\/>dumpMol("{}pre\_reduction.pdb"{});}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01431}01431         \textcolor{keywordflow}{if}(USE\_PHYSICS)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01432}01432         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01433}01433             physics::optimizeMolecule(\textcolor{keyword}{this},*s.\mbox{\hyperlink{classSystem_a9e485ee26141788c9f971a47703bb4a0}{ff}},250);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01434}01434             cout << \textcolor{stringliteral}{"{}Short Geomtery-\/optimized molecule!\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01435}01435         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01436}01436     \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01437}01437         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01438}01438             this-\/>\mbox{\hyperlink{classMolecule_ab0beb758c9101529938d5fdab3ed3f86}{reduce}}(s,trials,\textcolor{keyword}{true},devid);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01439}01439             \textcolor{keywordflow}{if}(FORCE\_CHARGES) this-\/>\mbox{\hyperlink{classMolecule_a6b91da44d6681118424a20a4a8ea2b24}{uniformChargeAdjustments}}(this-\/>\mbox{\hyperlink{classMolecule_a69594b093fbb60eabc373d6860f19a87}{getNetCharge}}(*s.\mbox{\hyperlink{classSystem_a9e485ee26141788c9f971a47703bb4a0}{ff}}));}
\DoxyCodeLine{\Hypertarget{classMolecule_l01440}01440         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01441}01441     \textcolor{keywordflow}{catch}(\mbox{\hyperlink{classAtomNotInMoleculeException}{AtomNotInMoleculeException}} ex) \{this-\/>\mbox{\hyperlink{classMolecule_a72616aa9d293190a9a0372a735f76966}{dumpMol}}(\textcolor{stringliteral}{"{}pre\_reduction.pdb"{}}); std::cout << \textcolor{stringliteral}{"{}Crashed with AtomNotInMoleculeException\(\backslash\)n"{}}; \textcolor{keywordflow}{throw} std::exception();\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01442}01442         \textcolor{keywordflow}{if}(USE\_PHYSICS)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01443}01443         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01444}01444         \textcolor{comment}{//physics::gradientDescentPhysics(this);}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01445}01445             physics::optimizeMolecule(\textcolor{keyword}{this},*s.\mbox{\hyperlink{classSystem_a9e485ee26141788c9f971a47703bb4a0}{ff}});}
\DoxyCodeLine{\Hypertarget{classMolecule_l01446}01446             cout << \textcolor{stringliteral}{"{}Well Geomtery-\/optimized molecule!\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01447}01447         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01448}01448   \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a28fd8a15cac9bf3f9df358af8ee07ff0}\label{classMolecule_a28fd8a15cac9bf3f9df358af8ee07ff0}} 
\index{Molecule@{Molecule}!samplegrowimpartial@{samplegrowimpartial}}
\index{samplegrowimpartial@{samplegrowimpartial}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{samplegrowimpartial()}{samplegrowimpartial()}}
{\footnotesize\ttfamily void Molecule\+::samplegrowimpartial (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classSystem}{System}} \&}]{s,  }\item[{int}]{n,  }\item[{int}]{trials = {\ttfamily 15} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

\begin{DoxyRefDesc}{Deprecated}
\item[\mbox{\hyperlink{deprecated__deprecated000046}{Deprecated}}]An old trial method for growth \end{DoxyRefDesc}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01187}{1187}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01188}01188     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01189}01189         \textcolor{keywordtype}{int} t=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01190}01190         \textcolor{keywordflow}{while}(\mbox{\hyperlink{classMolecule_a4c6228c3225bd9571ba276841caa7c90}{getEffectiveSize}}()<n)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01191}01191         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01192}01192             \textcolor{keywordflow}{if}(t>trials)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01193}01193             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01194}01194                 cout << \textcolor{stringliteral}{"{}Too many failures: \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01195}01195                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01196}01196             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01197}01197             \mbox{\hyperlink{classAtom}{Atom}}* gP=\mbox{\hyperlink{classMolecule_a50d2a2068fcda1e9676eb5d8e3aac9f2}{getRandomBondableAtom}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01198}01198             \textcolor{keyword}{auto} nbs=s.\mbox{\hyperlink{classSystem_a9e485ee26141788c9f971a47703bb4a0}{ff}}-\/>\mbox{\hyperlink{classForceField_a11ef1ec5670fc1755a3ad4618d63d734}{getAllowedBonds}}(gP);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01199}01199             \mbox{\hyperlink{classBondData}{BondData}} nb=randomSelect(nbs);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01200}01200             \mbox{\hyperlink{classAtom}{Atom}}* nat=nb.\mbox{\hyperlink{classBondData_a4a355fdee6e86a2d9906fc880f06082f}{getSecond}}(gP,*s.\mbox{\hyperlink{classSystem_a9e485ee26141788c9f971a47703bb4a0}{ff}});}
\DoxyCodeLine{\Hypertarget{classMolecule_l01201}01201             \textcolor{comment}{//std::vector<Eigen::Vector3d> alposes=}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01202}01202             \textcolor{comment}{//if(!alposes.size()) \{t++; continue;\}}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01203}01203             Eigen::Vector3d pos;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01204}01204       \textcolor{keywordflow}{try}\{pos=get<0>(\mbox{\hyperlink{namespacechemtools_ad2f246d4cc40979950344b2e6465fa73}{chemtools::getAllowedPositions}}(gP,\textcolor{keyword}{this},nat,s,15,5)); t=0;\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01205}01205       \textcolor{keywordflow}{catch}(\mbox{\hyperlink{classNoPositionAvailableException}{NoPositionAvailableException}} ex) \{t++; \textcolor{keywordflow}{continue};\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01206}01206             nat-\/>\mbox{\hyperlink{classAtom_a34fc2756d0f817a9ee6cf91c797d8bcc}{setPosition}}(pos);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01207}01207             \mbox{\hyperlink{classMolecule_aebc4ac8f4a68e24dbb0720402798ca4e}{bondAtom}}(nat,gP);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01208}01208             \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : atoms)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01209}01209             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01210}01210                 cout << a-\/>toString() << \textcolor{stringliteral}{"{}("{}}<<a-\/>seek\_valency()<<\textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01211}01211             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01212}01212             cout << \textcolor{stringliteral}{"{}\(\backslash\)t"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01213}01213             \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : freeatoms)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01214}01214             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01215}01215                 cout << a-\/>toString() << \textcolor{stringliteral}{"{}("{}}<<a-\/>seek\_valency()<<\textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01216}01216             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01217}01217             cout <<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01218}01218         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01219}01219   \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a6fb016cb3c6871904bd1e856e40f9fd1}\label{classMolecule_a6fb016cb3c6871904bd1e856e40f9fd1}} 
\index{Molecule@{Molecule}!samplegrowunrigid@{samplegrowunrigid}}
\index{samplegrowunrigid@{samplegrowunrigid}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{samplegrowunrigid()}{samplegrowunrigid()}}
{\footnotesize\ttfamily void Molecule\+::samplegrowunrigid (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classSystem}{System}} \&}]{s,  }\item[{int}]{n,  }\item[{int}]{trials = {\ttfamily 15} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

\begin{DoxyRefDesc}{Deprecated}
\item[\mbox{\hyperlink{deprecated__deprecated000048}{Deprecated}}]An old trial method for growth \end{DoxyRefDesc}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01237}{1237}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01238}01238   \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01239}01239     \textcolor{keywordtype}{int} t=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01240}01240     \mbox{\hyperlink{classMolecule_ab89456b4f7e16d7cbf6025f0389f5d10}{startTrials}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01241}01241     cout << \textcolor{stringliteral}{"{}Samplegrow begins\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01242}01242     \textcolor{keywordflow}{while}(\mbox{\hyperlink{classMolecule_a4c6228c3225bd9571ba276841caa7c90}{getEffectiveSize}}()<n)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01243}01243     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01244}01244         \textcolor{keywordflow}{if}(t>trials)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01245}01245             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01246}01246                 cout << \textcolor{stringliteral}{"{}Too many failures: \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01247}01247                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01248}01248             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01249}01249         \mbox{\hyperlink{classAtom}{Atom}}* gP=\mbox{\hyperlink{classMolecule_a50d2a2068fcda1e9676eb5d8e3aac9f2}{getRandomBondableAtom}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01250}01250       \textcolor{keywordflow}{if}(!gP)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01251}01251             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01252}01252                 cout << \textcolor{stringliteral}{"{}Out of valencies\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01253}01253                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01254}01254             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01255}01255       cout << gP-\/>\mbox{\hyperlink{classAtom_a189def3b8bade8507d49cfd7de881178}{toString}}()<<\textcolor{stringliteral}{"{}("{}}<<gP-\/>\mbox{\hyperlink{classAtom_ae2ac3a6ffdc90898d06d05eaf374960e}{seek\_valency}}()<<\textcolor{stringliteral}{"{}) chosen\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01256}01256         \mbox{\hyperlink{classAtom}{Atom}}* nat=s.\mbox{\hyperlink{classSystem_a9e485ee26141788c9f971a47703bb4a0}{ff}}-\/>selectAtomByRule(gP,\mbox{\hyperlink{classMolecule_aef77043ab98f1008a15a1e52d85b827e}{getBondedAtoms}}(gP));}
\DoxyCodeLine{\Hypertarget{classMolecule_l01257}01257         \textcolor{comment}{//if(!alposes.size()) \{t++; continue;\}}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01258}01258       \mbox{\hyperlink{classAtom}{Atom}}* nxt;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01259}01259       \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classMolecule_aaa3f24a1ea27312d39f72d8b4f277058}{attempt}}(s,gP,nat,nxt)) \{t++; \textcolor{keywordflow}{continue};\}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01260}01260       \mbox{\hyperlink{classMolecule_aebc4ac8f4a68e24dbb0720402798ca4e}{bondAtom}}(nat,gP);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01261}01261       \textcolor{keywordflow}{if}(nxt)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01262}01262       \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01263}01263         cout << nat-\/>\mbox{\hyperlink{classAtom_a189def3b8bade8507d49cfd7de881178}{toString}}()<< \textcolor{stringliteral}{"{}-\/"{}}<<nxt-\/>\mbox{\hyperlink{classAtom_a189def3b8bade8507d49cfd7de881178}{toString}}()<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01264}01264         \mbox{\hyperlink{classMolecule_a04b3beb3e333664d6421e9f0ee46dd73}{makeBond}}(nxt,nat);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01265}01265       \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01266}01266       t=0;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01267}01267         \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : atoms)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01268}01268             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01269}01269                 cout << a-\/>toString() << \textcolor{stringliteral}{"{}("{}}<<a-\/>seek\_valency()<<\textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01270}01270             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01271}01271         cout << \textcolor{stringliteral}{"{}\(\backslash\)t"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01272}01272         \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : freeatoms)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01273}01273             \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01274}01274                 cout << a-\/>toString() << \textcolor{stringliteral}{"{}("{}}<<a-\/>seek\_valency()<<\textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01275}01275             \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01276}01276         cout <<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01277}01277     \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01278}01278     ofstream prf; prf.open(\textcolor{stringliteral}{"{}prereduction.pdb"{}},ios::out);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01279}01279     \mbox{\hyperlink{classMolecule_a72616aa9d293190a9a0372a735f76966}{dumpMol}}(prf);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01280}01280     prf.close();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01281}01281     \mbox{\hyperlink{classMolecule_ab0beb758c9101529938d5fdab3ed3f86}{reduce}}(s);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01282}01282     ofstream rf; rf.open(\textcolor{stringliteral}{"{}postreduction.pdb"{}},ios::out);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01283}01283     \mbox{\hyperlink{classMolecule_a72616aa9d293190a9a0372a735f76966}{dumpMol}}(rf);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01284}01284     rf.close();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01285}01285     \mbox{\hyperlink{classMolecule_ac178106e85c4a667d2c7faa57765d0fb}{miniRollback}}(*s.\mbox{\hyperlink{classSystem_a9e485ee26141788c9f971a47703bb4a0}{ff}});}
\DoxyCodeLine{\Hypertarget{classMolecule_l01286}01286     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_aa3b73777e17fa7a34d15866fab326cfc}\label{classMolecule_aa3b73777e17fa7a34d15866fab326cfc}} 
\index{Molecule@{Molecule}!sealAll@{sealAll}}
\index{sealAll@{sealAll}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{sealAll()}{sealAll()}}
{\footnotesize\ttfamily void Molecule\+::seal\+All (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



\char`\"{}\+Caps\char`\"{} all the atoms of this molecule 

This method forcibly sets the free-\/valency count of each atom to 0, rejecting any remaining valencies. This process is referred to (here and later) as \char`\"{}capping\char`\"{}~\newline
It is useful when using a seed molecule which as a lot of free valecies, but the growth is to be targetted from a particular atom~\newline
See also\+: \mbox{\hyperlink{classAtom_a1d20924773ee1da9d94477d8917da147}{Atom\+::seal()}}, \mbox{\hyperlink{classMolecule_ab6c1f0207db1069de8e3a49a1881e880}{Molecule\+::free(\+Atom$\ast$,int)}} 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00958}{958}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l00959}00959     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l00960}00960         \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : freeatoms) a-\/>seal();}
\DoxyCodeLine{\Hypertarget{classMolecule_l00961}00961         freeatoms=std::vector<Atom*>();}
\DoxyCodeLine{\Hypertarget{classMolecule_l00962}00962     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a6b70c9d0397e77a4d7305b9dce395887}\label{classMolecule_a6b70c9d0397e77a4d7305b9dce395887}} 
\index{Molecule@{Molecule}!squareDistance@{squareDistance}}
\index{squareDistance@{squareDistance}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{squareDistance()}{squareDistance()}}
{\footnotesize\ttfamily static double Molecule\+::square\+Distance (\begin{DoxyParamCaption}\item[{std\+::vector$<$ double $>$}]{plane }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Get the sum of squares distances of each atom (including hydrogen atoms) of this molecule to a given plane. 

The plane is taken as input in form of a vector (a,b,c,d) which corresponds to the plane \char`\"{}$<$b$>$a$<$/b$>$x +$<$b$>$b$<$/b$>$y +$<$b$>$c$<$/b$>$z = $<$b$>$d$<$/b$>$\char`\"{}.~\newline
 It is a static function which requires the global variable, \char`\"{}\+Molecule$\ast$ currmol\char`\"{} to be set to point to the molecule for which this calculation is to be done. 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01807}{1807}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01808}01808   \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01809}01809     \textcolor{keywordtype}{double} d=0,n=plane[0]*plane[0]+plane[1]*plane[1]+plane[2]*plane[2];}
\DoxyCodeLine{\Hypertarget{classMolecule_l01810}01810     \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : currMol-\/>atoms) d+=sqr(plane[0]*a-\/>seek\_x()+plane[1]*a-\/>seek\_y()+plane[2]*a-\/>seek\_z()-\/plane[3]);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01811}01811     \textcolor{keywordflow}{return} d/n;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01812}01812   \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_ab89456b4f7e16d7cbf6025f0389f5d10}\label{classMolecule_ab89456b4f7e16d7cbf6025f0389f5d10}} 
\index{Molecule@{Molecule}!startTrials@{startTrials}}
\index{startTrials@{startTrials}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{startTrials()}{startTrials()}}
{\footnotesize\ttfamily void Molecule\+::start\+Trials (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Start trial mode. 

This method marks the beginning of trial mode. It backs-\/up the current state of the \mbox{\hyperlink{classMolecule}{Molecule}} object, and all modifications made from this point are subject to be lost (see \mbox{\hyperlink{classMolecule_af86a46bfed0f76534eb11a2016371f13}{rollback()}})~\newline
Trial mode is actively used during generation to allow recoiling when the growth reaches a stage from where it cannot proceed. (See algorithm PDF for more details)~\newline
You cannot use this method twice in a row. This method must be paired with either \mbox{\hyperlink{classMolecule_a04b2de48ba4c22b9bef6ca8aec90c1f9}{commit()}} or \mbox{\hyperlink{classMolecule_af86a46bfed0f76534eb11a2016371f13}{rollback()}}, and only after either of these is executed can this function be re-\/used. Not doing so may lead to an \mbox{\hyperlink{classAlreadyInTrialModeException}{Already\+In\+Trial\+Mode\+Exception}} being thrown 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01018}{1018}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01019}01019     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01020}01020         \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMolecule_acf710157d0a2da0d5d7bab8d658c39be}{trialmode}}) \textcolor{keywordflow}{throw} \mbox{\hyperlink{classAlreadyInTrialModeException}{AlreadyInTrialModeException}}();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01021}01021         oldatoms=atoms; oldbonds=bonds; oldfreeatoms=freeatoms; oldHC=\mbox{\hyperlink{classMolecule_ab9512050a395e0ebb8fbba92f0a91222}{HC}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01022}01022         \textcolor{keywordflow}{if}(VARIEDCOUNT) oldHAC=HAC;}
\DoxyCodeLine{\Hypertarget{classMolecule_l01023}01023         oldbe=\mbox{\hyperlink{classMolecule_adebb2c740099c5db4f14137bb1609877}{myBE}}; oldhbe=\mbox{\hyperlink{classMolecule_a6647358091d946bb02dbcf3ce35b7d5e}{myHBE}}; olderrbe=\mbox{\hyperlink{classMolecule_a6b1f799908a9d52d7194d07ac6bb28d3}{errBE}}; olderrhbe=\mbox{\hyperlink{classMolecule_a32075500340345439d0d4912e26fb44f}{errHBE}}; oldcycles=cycles; valencies=std::vector<int>(); \textcolor{keywordflow}{for}(\mbox{\hyperlink{classAtom}{Atom}}* a : oldatoms) valencies.push\_back(a-\/>seek\_valency());}
\DoxyCodeLine{\Hypertarget{classMolecule_l01024}01024         \mbox{\hyperlink{classMolecule_acf710157d0a2da0d5d7bab8d658c39be}{trialmode}}=\textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01025}01025     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMolecule_a6b91da44d6681118424a20a4a8ea2b24}\label{classMolecule_a6b91da44d6681118424a20a4a8ea2b24}} 
\index{Molecule@{Molecule}!uniformChargeAdjustments@{uniformChargeAdjustments}}
\index{uniformChargeAdjustments@{uniformChargeAdjustments}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{uniformChargeAdjustments()}{uniformChargeAdjustments()}}
{\footnotesize\ttfamily void Molecule\+::uniform\+Charge\+Adjustments (\begin{DoxyParamCaption}\item[{double}]{tchg = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Sets the net charge of the \mbox{\hyperlink{classMolecule}{Molecule}} by uniformly modifying the charges of all atoms (usually by a small quantity for large enough molecules) 

Some atom-\/types are not perfect in the charge values (especially when repuroposed in two different cases). In this cases there is a minor deviation from the usual charge (0 for neutral molecule), etc.~\newline
 This minor deviation can build up over multiple such atom-\/types placed over the molecule. This method corrects for it. 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l01539}{1539}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l01540}01540     \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01541}01541         \textcolor{keywordtype}{double} chg=0; \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++) chg+=atoms[i]-\/>seek\_charge();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01542}01542         \textcolor{keywordflow}{if}(!QUIET)}
\DoxyCodeLine{\Hypertarget{classMolecule_l01543}01543         \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l01544}01544             cout << \textcolor{stringliteral}{"{}Net charge on system: "{}}<<chg<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01545}01545             cout << \textcolor{stringliteral}{"{}Setting net charge on system to "{}}<<tchg<<\textcolor{stringliteral}{"{} by uniform charge modification\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{classMolecule_l01546}01546         \}}
\DoxyCodeLine{\Hypertarget{classMolecule_l01547}01547         chg=(tchg-\/chg)/atoms.size();}
\DoxyCodeLine{\Hypertarget{classMolecule_l01548}01548         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<atoms.size();i++) atoms[i]-\/>setCharge(atoms[i]-\/>seek\_charge()+chg);}
\DoxyCodeLine{\Hypertarget{classMolecule_l01549}01549     \}}

\end{DoxyCode}


\doxysubsection{Friends And Related Function Documentation}
\mbox{\Hypertarget{classMolecule_a13f21a69f0d90e36bffdc2236e75fff3}\label{classMolecule_a13f21a69f0d90e36bffdc2236e75fff3}} 
\index{Molecule@{Molecule}!merge@{merge}}
\index{merge@{merge}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{merge}{merge}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMolecule}{Molecule}} $\ast$ merge (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classMolecule}{Molecule}} $\ast$}]{m1,  }\item[{const \mbox{\hyperlink{classMolecule}{Molecule}} $\ast$}]{m2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [friend]}}

Still under development. Merge two molecules into a single one 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l04190}{4190}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{classMolecule_l04191}04191 \{}
\DoxyCodeLine{\Hypertarget{classMolecule_l04192}04192   \textcolor{keywordflow}{if}(!m1) \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{classMolecule_a7e7d290ae641518ad4c4d5303b519d0f}{Molecule}}(m2);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04193}04193   \textcolor{keywordflow}{if}(!m2) \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{classMolecule_a7e7d290ae641518ad4c4d5303b519d0f}{Molecule}}(m1);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04194}04194   \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{classMolecule_a7e7d290ae641518ad4c4d5303b519d0f}{Molecule}}(m1);}
\DoxyCodeLine{\Hypertarget{classMolecule_l04195}04195 \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classMolecule_a6b1f799908a9d52d7194d07ac6bb28d3}\label{classMolecule_a6b1f799908a9d52d7194d07ac6bb28d3}} 
\index{Molecule@{Molecule}!errBE@{errBE}}
\index{errBE@{errBE}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{errBE}{errBE}}
{\footnotesize\ttfamily double Molecule\+::err\+BE =0}

Stored binding energy error 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00506}{506}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.

\mbox{\Hypertarget{classMolecule_a32075500340345439d0d4912e26fb44f}\label{classMolecule_a32075500340345439d0d4912e26fb44f}} 
\index{Molecule@{Molecule}!errHBE@{errHBE}}
\index{errHBE@{errHBE}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{errHBE}{errHBE}}
{\footnotesize\ttfamily double Molecule\+::err\+HBE =0}

Stored binding energy error (specific to hotspot -\/ see \mbox{\hyperlink{classProtein}{Protein}}) 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00507}{507}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.

\mbox{\Hypertarget{classMolecule_ab9512050a395e0ebb8fbba92f0a91222}\label{classMolecule_ab9512050a395e0ebb8fbba92f0a91222}} 
\index{Molecule@{Molecule}!HC@{HC}}
\index{HC@{HC}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{HC}{HC}}
{\footnotesize\ttfamily int Molecule\+::\+HC =0}

Hydrogen atom count 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00487}{487}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.

\mbox{\Hypertarget{classMolecule_a87674f540b98a33b4921c4d57b3982fc}\label{classMolecule_a87674f540b98a33b4921c4d57b3982fc}} 
\index{Molecule@{Molecule}!ID@{ID}}
\index{ID@{ID}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{ID}{ID}}
{\footnotesize\ttfamily int Molecule\+::\+ID =-\/1}

\begin{DoxyRefDesc}{Deprecated}
\item[\mbox{\hyperlink{deprecated__deprecated000041}{Deprecated}}]Unique ID of this molecule \end{DoxyRefDesc}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00502}{502}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.

\mbox{\Hypertarget{classMolecule_adebb2c740099c5db4f14137bb1609877}\label{classMolecule_adebb2c740099c5db4f14137bb1609877}} 
\index{Molecule@{Molecule}!myBE@{myBE}}
\index{myBE@{myBE}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{myBE}{myBE}}
{\footnotesize\ttfamily double Molecule\+::my\+BE =0}

Stored binding energy value 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00504}{504}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.

\mbox{\Hypertarget{classMolecule_a6647358091d946bb02dbcf3ce35b7d5e}\label{classMolecule_a6647358091d946bb02dbcf3ce35b7d5e}} 
\index{Molecule@{Molecule}!myHBE@{myHBE}}
\index{myHBE@{myHBE}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{myHBE}{myHBE}}
{\footnotesize\ttfamily double Molecule\+::my\+HBE =0}

Stored binding energy value (specific to hotspot -\/ see \mbox{\hyperlink{classProtein}{Protein}}) 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00505}{505}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.

\mbox{\Hypertarget{classMolecule_abf3e45c79a7ae3fbb0fc174544debc1e}\label{classMolecule_abf3e45c79a7ae3fbb0fc174544debc1e}} 
\index{Molecule@{Molecule}!pE@{pE}}
\index{pE@{pE}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{pE}{pE}}
{\footnotesize\ttfamily double Molecule\+::pE =0}

\begin{DoxyRefDesc}{Deprecated}
\item[\mbox{\hyperlink{deprecated__deprecated000042}{Deprecated}}]Extra penalization (in same units as energy) \end{DoxyRefDesc}


Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00512}{512}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.

\mbox{\Hypertarget{classMolecule_acf710157d0a2da0d5d7bab8d658c39be}\label{classMolecule_acf710157d0a2da0d5d7bab8d658c39be}} 
\index{Molecule@{Molecule}!trialmode@{trialmode}}
\index{trialmode@{trialmode}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{trialmode}{trialmode}}
{\footnotesize\ttfamily bool Molecule\+::trialmode =false}

Is it in \char`\"{}trial mode\char`\"{} (See flowchart in algorithm document and \mbox{\hyperlink{classMolecule_ab89456b4f7e16d7cbf6025f0389f5d10}{start\+Trials()}}) 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00503}{503}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.

\mbox{\Hypertarget{classMolecule_a3e459e9ae52f281073d4821b9af72b60}\label{classMolecule_a3e459e9ae52f281073d4821b9af72b60}} 
\index{Molecule@{Molecule}!type@{type}}
\index{type@{type}!Molecule@{Molecule}}
\doxysubsubsection{\texorpdfstring{type}{type}}
{\footnotesize\ttfamily int Molecule\+::type =0}

Type identifier. 0 is blank (default). 1 is protein/macromolecule 

Definition at line \mbox{\hyperlink{Molecule_8hpp_source_l00501}{501}} of file \mbox{\hyperlink{Molecule_8hpp_source}{Molecule.\+hpp}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
graph/Molecule.\+hpp\end{DoxyCompactItemize}
